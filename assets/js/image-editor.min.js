function cnimage_editor(e){const t=null!=e&&null!=e.el&&document.querySelector(e.el),i=null==e||null==e.image_editor||e.image_editor,a=null!=e&&null!=e.browseFunct&&e.browseFunct,l=null!=e&&null!=e.displayImageFunct&&e.displayImageFunct,o=null!=e&&null!=e.editFunct&&e.editFunct,r=null!=e&&null!=e.deleteFunct&&e.deleteFunct,s=null!=e&&null!=e.saveFunct&&e.saveFunct,n=null!=e&&null!=e.resetFunct&&e.resetFunct,c=null!=e&&null!=e.closeFunct&&e.closeFunct,d=this,u=null!=e&&null!=e.width?e.width:300,m=null!=e&&null!=e.height?e.height:300,p=null!=e&&null!=e.cropbox_width?e.cropbox_width:300,g=null!=e&&null!=e.cropbox_height?e.cropbox_height:300,h=null!=e&&null!=e.cropboxsave_width?e.cropboxsave_width:200,v=null!=e&&null!=e.cropboxsave_height?e.cropboxsave_height:230,y=null!=e&&null!=e.cropbox_resize&&e.cropbox_resize.minwidth?e.cropbox_resize.minwidth:50,f=null!=e&&null!=e.cropbox_resize&&e.cropbox_resize.minheight?e.cropbox_resize.minheight:50,b=null!=e&&null!=e.cropbox_resize&&e.cropbox_resize.maxwidth?e.cropbox_resize.maxwidth:800,x=null!=e&&null!=e.cropbox_resize&&e.cropbox_resize.maxheight?e.cropbox_resize.maxheight:800;if(t)return this.init=function(){null==document.querySelector("#image-editor-modal")&&i&&this.initModalEditor(),t.style.width=u+"px",t.style.height=m+"px",t.classList.add("image-editor");let e="";var l=document.querySelectorAll(".image-editor").length-1;null==t.querySelector("input.filetype")&&null==t.querySelector("input.filename")&&null==t.querySelector("input.image-src")&&(e='<img src="'+t.getAttribute("data-default")+'">',t.innerHTML='<input type="hidden" name="image['+l+'][filetype]" class="filetype"><input type="hidden" name="image['+l+'][filename]" class="filename"><input type="hidden" name="image['+l+'][contents]" class="image_src"><input class="file-browse" type="file" accept="image/x-png,image/jpeg" style="display:none;"><div class="image-editor-tools"><a href="javascript:void(0);" class="image-editor-browse flex-center radius-5"><i class="fas fa-plus"></i></a><a href="javascript:void(0);" class="image-editor-edit flex-center radius-5"><i class="fas fa-magic"></i></a><a href="javascript:void(0);" class="image-editor-delete flex-center radius-5"><i class="far fa-trash-alt"></i></a></div><div class="image-editor-preview">'+e+"</div>"),t.querySelector(".image-editor-browse").style.display="flex",null!=t.getAttribute("data-default")&&i?(t.querySelector(".image-editor-edit").style.display="flex",t.querySelector(".image-editor-delete").style.display="flex"):(t.querySelector(".image-editor-edit").style.display="none",t.querySelector(".image-editor-delete").style.display="none"),""!=t.querySelector("input.filetype")&&""!=t.querySelector("input.filename").value&&""!=t.querySelector("input.image_src").value&&(t.querySelector(".image-editor-edit").style.display="flex",t.querySelector(".image-editor-delete").style.display="flex",document.querySelectorAll(".image_editor").forEach(function(e){e.classList.remove("active")}),t.classList.add("active"),this.displayImage(!1,t.querySelector("input.image_src").value)),t.querySelector(".image-editor-browse").addEventListener("click",function(e){e.preventDefault();let i=document.querySelector(".image-editor.active");null!=i&&i.classList.remove("active"),this.closest(".image-editor").classList.add("active"),t.querySelector("input.file-browse").click(),a&&window[a]()}),t.querySelector(".image-editor-edit").addEventListener("click",function(e){if(e.preventDefault(),null!=document.querySelector("#image-editor-modal")&&i){let e=document.querySelector(".image-editor.active");null!=e&&e.classList.remove("active"),this.closest(".image-editor").classList.add("active"),document.querySelector("#image-editor-modal").style.display="block",i?null!=this.closest(".image-editor").getAttribute("data-default")?d.displayImageModal(this.closest(".image-editor").getAttribute("data-default"),!0):d.displayImageModal(document.querySelector(".image-editor.active input.file-browse"),!1):alert("Editor not found!")}else alert("Editor not found!");o&&window[o](document.querySelector(".image-editor.active"))}),t.querySelector(".image-editor-delete").addEventListener("click",function(e){e.preventDefault();let t=document.querySelector(".image-editor.active");null!=t&&t.classList.remove("active"),this.closest(".image-editor").classList.add("active"),null!=this.closest(".image-editor").querySelector("canvas")&&this.closest(".image-editor").querySelector("canvas").remove(),null!=this.closest(".image-editor").querySelector("img")&&this.closest(".image-editor").querySelector("img").remove(),this.style.display="none",this.closest(".image-editor").querySelector(".image-editor-edit").style.display="none",this.closest(".image-editor").querySelector("input.file-browse").value="",this.closest(".image-editor").querySelector("input.image_src").value="",this.closest(".image-editor").querySelector("input.filename").value="",r&&window[r](document.querySelector(".image-editor.active"))}),t.querySelector("input.file-browse").addEventListener("change",function(){var e=this.value.lastIndexOf(".")+1,t=this.value.substr(e,this.value.length).toLowerCase();"jpg"==t||"jpeg"==t||"png"==t?d.ValidateSize(this)&&d.displayImage(this):alert("Only jpg/jpeg and png files are allowed!")})},this.cropCanvas=function(){null!=document.querySelector("#image-editor-modal #crop-box")&&Caman("#modal-canvas",function(){let e=document.querySelector("#image-editor-modal #crop-box").offsetWidth,t=document.querySelector("#image-editor-modal #crop-box").offsetHeight,i=document.querySelector("#image-editor-modal #crop-box").offsetTop,a=document.querySelector("#image-editor-modal #crop-box").offsetLeft;this.crop(e,t,a,i),this.render(function(){document.querySelector("#image-editor-modal canvas").setAttribute("id","modal-canvas"),document.querySelector("#image-editor-modal #crop-box").remove()})})},this.initModalEditor=function(){let e=document.createElement("div");e.setAttribute("id","image-editor-modal"),e.innerHTML='<div id="image-editor-body"><div id="image-editor-toolbox"> <ul class="p00 m00 list-style-none"> <li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-modal-save" class="display-block toolbox m5"> <i class="fas fa-check mr5"></i>Save </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-modal-close" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-times mr5"></i>Cancel </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-modal-reset" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-sync mr5"></i>Reset </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-magic mr5"></i>Adjust </a> <div class="toolbox-sub bg-white box-shadow"> <ul class="p00 m00"> <li class="filter-slider"> <label class="full-width display-block">Brightness <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="brightness"> </li><li class="filter-slider"> <label class="full-width display-block">Contrast <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="contrast"> </li><li class="filter-slider"> <label class="full-width display-block">Saturation <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="saturation"> </li><li class="filter-slider"> <label class="full-width display-block">Vibrance <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="vibrance"> </li><li class="filter-slider"> <label class="full-width display-block">Exposure <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="exposure"> </li><li class="filter-slider"> <label class="full-width display-block">Clip <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="clip"> </li><li class="filter-slider"> <label class="full-width display-block">Hue <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="hue"> </li><li class="filter-slider"> <label class="full-width display-block">Sepia <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="sepia"> </li><li class="filter-slider"> <label class="full-width display-block">Noise <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="noise"> </li><li class="filter-slider"> <label class="full-width display-block">Sharpen <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="sharpen"> </li><li class="filter-slider"> <label class="full-width display-block">StackBlur <span class="filter-range">0</span></label> <input type="range" min="-100" max="100" value="0" class="slider filter-range-input mb5" data-filter="stackBlur"> </li></ul> </div></li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" class="display-block toolbox m5 toolbox-dp-trigger"> <i class="fas fa-magic mr5"></i>Presets </a> <div class="toolbox-sub bg-white box-shadow"> <ul class="p00 m00" id="image-editor-presets"> <li> <a href="javascript:void(0);" data-preset="vintage">Vintage</a></li><li> <a href="javascript:void(0);" data-preset="lomo">Lomo</a></li><li> <a href="javascript:void(0);" data-preset="clarity">Clarity</a></li><li> <a href="javascript:void(0);" data-preset="sinCity">Sin City</a></li><li> <a href="javascript:void(0);" data-preset="sunrise">Sunrise</a></li><li> <a href="javascript:void(0);" data-preset="crossProcess">Cross Process</a></li><li> <a href="javascript:void(0);" data-preset="orangePeel">Orange Peel</a></li><li> <a href="javascript:void(0);" data-preset="love">Love</a></li><li> <a href="javascript:void(0);" data-preset="grungy">Grungy</a></li><li> <a href="javascript:void(0);" data-preset="jarques">Jarques</a></li><li> <a href="javascript:void(0);" data-preset="pinhole">Pinhole</a></li><li> <a href="javascript:void(0);" data-preset="oldBoot">Old Boot</a></li><li> <a href="javascript:void(0);" data-preset="glowingSun">Glowing Sun</a></li><li> <a href="javascript:void(0);" data-preset="hazyDays">Hazy Days</a></li><li> <a href="javascript:void(0);" data-preset="herMajesty">Her Majesty</a></li><li> <a href="javascript:void(0);" data-preset="nostalgia">Nostalgia</a></li><li> <a href="javascript:void(0);" data-preset="hemingway">Hemingway</a></li><li> <a href="javascript:void(0);" data-preset="concentrate">concentrate</a></li></ul> </div></li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" class="display-block toolbox m5"> <i class="fas fa-expand-arrows-alt mr5"></i>Resize </a> <div class="toolbox-sub bg-white box-shadow"><div class="col-xs-6 mb5 pl3 pr3"><label class="full-width display-block">Width:</label><input type="number" class="mb00" id="resize-width" name="resize_width"></div><div class="col-xs-6 mb5 pl3 pr3"><label class="full-width display-block">Height:</label><input type="number" class="mb00" id="resize-height" name="resize_height"></div><div class="col-xs-12 col-sm-12 mt8 pl3 pr3"><a href="javascript:void(0);" class="btn btn-block btn-sm btn-filled mb8" id="resize-save">Resize</a></div></div></li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-crop" class="display-block toolbox m5"> <i class="fas fa-crop-alt mr5"></i>Crop </a> </li><li class="list-style-none align-left display-table toolbox-li" style="display:none"> <a href="javascript:void(0);" id="image-editor-crop-now" class="bg-success display-block toolbox m5"> <i class="fas fa-check mr5"></i>Crop </a> </li><li class="list-style-none align-left display-table toolbox-li"> <a href="javascript:void(0);" id="image-editor-rotate" class="display-block toolbox m5"> <i class="fas fa-undo mr5"></i>Rotate </a> <div class="toolbox-sub bg-white box-shadow"> <ul class="p00 m00" id="image-editor-rotate"> <li> <a href="javascript:void(0);" data-rotate="cw">Clock wise</a></li><li> <a href="javascript:void(0);" data-rotate="ccw">Counter clock wise</a></li></ul></div></li></ul></div><div id="image-editor-canvas"><div id="canvas-holder" width=""></div></div></div>',document.querySelector("body").appendChild(e),document.querySelector("#image-editor-modal #image-editor-modal-close").addEventListener("click",function(e){e.preventDefault(),document.querySelector("#image-editor-modal").style.display="none",document.querySelector("#image-editor-modal canvas").style.display="none",document.querySelector("body").style.overflowY="auto",d.reset(),c&&window[c]()}),document.querySelector("#image-editor-modal #image-editor-modal-save").addEventListener("click",function(e){e.preventDefault();let t=document.querySelector("#image-editor-modal #canvas-holder canvas"),i=(t.width-h)/2,a=(t.height-v)/2;Caman("#modal-canvas",function(){this.crop(h,v,i,a),this.render(function(){var e=document.querySelector("#image-editor-modal canvas").offsetWidth,t=document.querySelector("#image-editor-modal canvas").offsetHeight;document.querySelector("#image-editor-modal").style.display="none",null!=document.querySelector(".image-editor.active canvas")&&document.querySelector(".image-editor.active canvas").remove(),null!=document.querySelector(".image-editor.active img")&&document.querySelector(".image-editor.active img").remove();var i=document.createElement("canvas");document.querySelector(".image-editor.active").appendChild(i),null!=document.querySelector(".image-editor.active img")&&document.querySelector(".image-editor.active .image-editor-preview").appendChild(i);var a=document.querySelector(".image-editor.active canvas").getContext("2d");a.canvas.width=e,a.canvas.height=t,a.drawImage(document.querySelector("#image-editor-modal canvas"),0,0),document.querySelector(".image-editor.active input.image_src").value=document.querySelector(".image-editor.active canvas").toDataURL()})}),s&&window[s](document.querySelector(".image-editor.active"))}),document.querySelector("#image-editor-modal #image-editor-crop").addEventListener("click",function(e){let t=document.createElement("div");t.setAttribute("id","crop-box"),t.style.width=p+"px",t.style.height=g+"px",t.innerHTML='<div class="resizer" style="position:absolute;top:-2px;left:-2px;border-top: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div><div class="resizer" style="position:absolute;top:-2px;right:-2px;border-top: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div><div class="resizer" style="position:absolute;bottom:-2px;left:-2px;border-bottom: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div><div class="resizer" style="position:absolute;bottom:-2px;right:-2px;border-bottom: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;"></div>',document.querySelector("#image-editor-modal #image-editor-canvas #canvas-holder").appendChild(t),d.dragCropBox(),d.resizeCropBox(),this.closest("li").style.display="none",document.querySelector("#image-editor-modal #image-editor-crop-now").closest("li").style.display="block"}),document.querySelector("#image-editor-modal #image-editor-crop-now").addEventListener("click",function(e){d.cropCanvas(),this.closest("li").style.display="none",document.querySelector("#image-editor-modal #image-editor-crop").closest("li").style.display="block"}),document.querySelectorAll(".filter-slider").forEach(function(e){e.querySelector(".filter-range").textContent=e.querySelector(".filter-range-input").value,e.querySelector(".filter-range-input").addEventListener("input",function(){this.closest(".filter-slider").querySelector(".filter-range").textContent=this.value,d.applyFilter(this.getAttribute("data-filter"),this.value)})}),document.querySelectorAll("#image-editor-modal #image-editor-presets li a").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),d.applyPreset(e.getAttribute("data-preset"))})}),document.querySelectorAll("#image-editor-modal #image-editor-rotate li a").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),d.applyRotate(e.getAttribute("data-rotate"))})}),document.querySelector("#image-editor-modal #image-editor-modal-reset").addEventListener("click",function(e){e.preventDefault(),d.reset(),n&&window[n](document.querySelector(".image-editor.active"))}),document.querySelector("#image-editor-modal #resize-save").addEventListener("click",function(e){e.preventDefault();let t=this.closest(".toolbox-sub").querySelector("#resize-width").value,i=this.closest(".toolbox-sub").querySelector("#resize-height").value;d.applyResize(t,i)}),document.querySelectorAll(".toolbox-li").forEach(function(e){e.querySelector("a").addEventListener("click",function(e){e.preventDefault(),null!=this.closest(".toolbox-li").querySelector(".toolbox-sub")&&d.isHidden(this.closest(".toolbox-li").querySelector(".toolbox-sub"))?(document.querySelectorAll(".toolbox-sub").forEach(function(e){e.style.display="none"}),this.closest(".toolbox-li").querySelector(".toolbox-sub").style.display="block"):document.querySelectorAll(".toolbox-sub").forEach(function(e){e.style.display="none"})})})},this.dragCropBox=function(){let e,t,i,a,l=document.querySelector("#image-editor-modal #crop-box"),o=document.querySelector("#image-editor-modal #image-editor-canvas #canvas-holder"),r=!1,s=0,n=0;function c(e){"touchstart"===e.type?(i=e.touches[0].clientX-s,a=e.touches[0].clientY-n):(i=e.clientX-s,a=e.clientY-n),e.target===l&&(r=!0)}function d(l){i=e,a=t,r=!1}function u(o){var c,d,u;r&&(o.preventDefault(),"touchmove"===o.type?(e=o.touches[0].clientX-i,t=o.touches[0].clientY-a):(e=o.clientX-i,t=o.clientY-a),s=e,n=t,c=e,d=t,(u=l).style.top=d+"px",u.style.left=c+"px")}o.addEventListener("touchstart",c,!1),o.addEventListener("touchend",d,!1),o.addEventListener("touchmove",u,!1),o.addEventListener("mousedown",c,!1),o.addEventListener("mouseup",d,!1),o.addEventListener("mousemove",u,!1)},this.checkIfMobile=function(){return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))},this.ValidateSize=function(e){if(!(e.files[0].size/1024/1024>2))return!0;alert("File size exceeds 2 MB")},this.resizeCropBox=function(){let e=document.querySelectorAll("#image-editor-modal #image-editor-canvas #crop-box .resizer"),t=document.querySelector("#image-editor-modal #image-editor-canvas #crop-box");var i,a,l,o;function r(e){d.checkIfMobile()?(i=e.touches[0].clientX,a=e.touches[0].clientY):(i=e.clientX,a=e.clientY),l=parseInt(document.defaultView.getComputedStyle(t).width,10),o=parseInt(document.defaultView.getComputedStyle(t).height,10),d.checkIfMobile()?(document.documentElement.addEventListener("touchmove",s,!1),document.documentElement.addEventListener("touchend",n,!1)):(document.documentElement.addEventListener("mousemove",s,!1),document.documentElement.addEventListener("mouseup",n,!1)),document.documentElement.addEventListener("touchmove",s,!1),document.documentElement.addEventListener("touchend",n,!1)}function s(e){d.checkIfMobile()?(l+e.touches[0].clientX-i<b&&l+e.touches[0].clientX-i>y&&(t.style.width=l+e.touches[0].clientX-i+"px"),o+e.touches[0].clientY-a<x&&o+e.touches[0].clientY-a>f&&(t.style.height=o+e.touches[0].clientY-a+"px")):(l+e.clientX-i<b&&l+e.clientX-i>y&&(t.style.width=l+e.clientX-i+"px"),o+e.clientY-a<x&&o+e.clientY-a>f&&(t.style.height=o+e.clientY-a+"px"))}function n(e){d.checkIfMobile()?(document.documentElement.removeEventListener("touchmove",s,!1),document.documentElement.removeEventListener("touchend",n,!1)):(document.documentElement.removeEventListener("mousemove",s,!1),document.documentElement.removeEventListener("mouseup",n,!1))}e.forEach(function(e){d.checkIfMobile()?e.addEventListener("touchstart",r,!1):e.addEventListener("mousedown",r,!1)})},this.displayImage=function(e,t){if(!(t=null!=t&&t)&&null==e.files&&null==!e.files[0])return!1;null!=document.querySelector(".image-editor.active canvas")&&document.querySelector(".image-editor.active canvas").remove(),null!=document.querySelector(".image-editor.active img")&&document.querySelector(".image-editor.active img").remove();let a=document.createElement("canvas");a.style.display="none",document.querySelector(".image-editor.active .image-editor-preview").appendChild(a);let o=document.querySelector(".image-editor.active canvas").getContext("2d"),r=new Image;r.crossOrigin="anonymous",r.onload=function(){if(o.canvas.width=this.width,o.canvas.height=this.height,o.drawImage(r,0,0),!t){let t=(this.width-h)/2,i=(this.height-v)/2;Caman(".image-editor.active canvas",function(){this.crop(h,v,t,i),this.render(function(){document.querySelector(".image-editor.active input.image_src").value=document.querySelector(".image-editor.active canvas").toDataURL(),document.querySelector(".image-editor.active input.filename").value=e.files[0].name,document.querySelector(".image-editor.active input.filetype").value=document.querySelector(".image-editor.active input.filename").value.split(".")[1]}),l&&window[l](document.querySelector(".image-editor.active"))})}null!=document.querySelector("#image-editor-modal")&&i?document.querySelector(".image-editor.active .image-editor-edit").style.display="flex":document.querySelector(".image-editor.active .image-editor-edit").style.display="none",document.querySelector(".image-editor.active .image-editor-delete").style.display="flex",a.style.display="block",document.querySelector(".image-editor.active").removeAttribute("data-default")},r.src=t||URL.createObjectURL(e.files[0])},this.displayImageModal=function(e,t){null!=document.querySelector("#image-editor-modal #image-editor-canvas canvas")&&document.querySelector("#image-editor-modal #image-editor-canvas canvas").remove();let i=document.createElement("canvas");i.setAttribute("id","modal-canvas"),document.querySelector("#image-editor-modal #image-editor-canvas #canvas-holder").appendChild(i),d.cloneImg(e,t);let a=document.querySelector("#image-editor-modal #image-editor-canvas canvas").getContext("2d"),l=new Image;l.crossOrigin="anonymous",t?(l.onload=d.drawImageScaled.bind(null,l,a),l.src=e):e.files&&e.files[0]&&(l.onload=d.drawImageScaled.bind(null,l,a),l.src=URL.createObjectURL(e.files[0]))},this.cloneImg=function(e,t){if(null!=document.querySelector("#clone-img")&&document.querySelector("#clone-img").remove(),t){var i=document.createElement("div");i.setAttribute("id","clone-img"),i.innerHTML='<img src="'+e+'">',document.querySelector("body").style.overflowY="hidden",document.querySelector("body").appendChild(i)}else{var a=new FileReader;a.onload=function(e){var t=document.createElement("div");t.setAttribute("id","clone-img"),t.innerHTML='<img src="'+e.target.result+'">',document.querySelector("body").style.overflowY="hidden",document.querySelector("body").appendChild(t)},a.readAsDataURL(e.files[0])}},this.drawImageScaled=function(e,t){t.canvas.width=document.querySelector("#clone-img img").offsetWidth,t.canvas.height=document.querySelector("#clone-img img").offsetHeight;var i=t.canvas,a=i.width/e.width,l=i.height/e.height,o=Math.min(a,l),r=(i.width-e.width*o)/2,s=(i.height-e.height*o)/2;t.clearRect(0,0,i.width,i.height),t.drawImage(e,0,0,e.width,e.height,r,s,e.width*o,e.height*o),document.querySelector("#image-editor-modal canvas").style.display="block"},this.reset=function(){null!=document.querySelector("#clone-img")&&document.querySelector("#clone-img").remove(),null!=document.querySelector("#image-editor-modal #crop-box")&&document.querySelector("#image-editor-modal #crop-box").remove(),document.querySelectorAll(".filter-range-input").forEach(function(e){e.value=0}),document.querySelector("#image-editor-modal #image-editor-crop-now").closest("li").style.display="none",document.querySelector("#image-editor-modal #image-editor-crop").closest("li").style.display="block",null!=document.querySelector(".image-editor.active").getAttribute("data-default")?d.displayImageModal(document.querySelector(".image-editor.active").getAttribute("data-default"),!0):d.displayImageModal(document.querySelector(".image-editor.active input.file-browse"),!1)},this.applyResize=function(e,t){Caman("#image-editor-modal canvas",function(){this.resize({width:e,height:t}),this.render()})},this.applyFilter=function(e,t){let i=e.replace("filter-","");Caman("#image-editor-modal canvas",function(){switch(this.revert(!1),i){case"brightness":this.brightness(t).render();break;case"contrast":this.contrast(t).render();break;case"contrast":this.saturation(t).render();break;case"vibrance":this.contrast(t).render();break;case"exposure":this.exposure(t).render();break;case"clip":case"clip":this.clip(t).render();break;case"hue":this.hue(t).render();break;case"sepia":this.sepia(t).render();break;case"noise":this.noise(t).render();break;case"sharpen":this.vintage(t).render();break;case"stackBlur":this.stackBlur(t).render()}})},this.applyPreset=function(e){Caman("#image-editor-modal canvas",function(){switch(this.revert(!1),e){case"vintage":this.vintage().render();break;case"lomo":this.lomo().render();break;case"clarity":this.clarity().render();break;case"sinCity":this.sinCity().render();break;case"sunrise":this.sunrise().render();break;case"crossProcess":this.crossProcess().render();break;case"orangePeel":this.orangePeel().render();break;case"love":this.love().render();break;case"grungy":this.grungy().render();break;case"jarques":this.jarques().render();break;case"pinhole":this.pinhole().render();break;case"oldBoot":this.oldBoot().render();break;case"glowingSun":this.glowingSun().render();break;case"hazyDays":this.hazyDays().render();break;case"herMajesty":this.herMajesty().render();break;case"nostalgia":this.nostalgia().render();break;case"hemingway":case"hemingway":this.hemingway().render()}})},this.applyRotate=function(e){Caman("#image-editor-modal canvas",function(){switch(e){case"cw":this.rotate(90).render();break;case"ccw":this.rotate(-90).render()}})},this.isHidden=function(e){let t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility},this.init();console.log("Bind an element e.g. new cnimage_editor( {  el : <element> } )")}