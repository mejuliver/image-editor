{"version":3,"sources":["src/index.js"],"names":["window","cnimage_editor","$options","$storage","localStorage","$editor","hasOwnProperty","document","querySelector","el","$ob","auto_browse","$on_created","on_created","$image_editor","image_editor","$on_browse","on_browse","$on_display","on_display","$on_edit","on_edit","$on_delete","on_delete","$on_save","on_save","$on_reset","on_reset","$on_close","on_close","$global","$editor_width","width","$editor_height","height","$cropbox_width","cropbox_width","$cropbox_height","cropbox_height","$cropbox_resize","cropbox_resize","$cropbox_resize_minwidth","minwidth","$cropbox_resize_minheight","minheight","$cropbox_resize_maxwidth","maxwidth","$cropbox_resize_maxheight","maxheight","$autocrop","autocrop","$cropboxsave_width","$cropboxsave_height","$imgcache","imgcache","console","log","setItem","_editordata","getAttribute","_editor","JSON","parse","push","$el","$auto_browse","setAttribute","stringify","init","initModalEditor","style","classList","add","$default_canvas","$id","querySelectorAll","length","innerHTML","display","value","forEach","remove","displayImage","hasAttribute","addEventListener","e","preventDefault","$active_editor","closest","click","displayImageModal","alert","_storage","getItem","_img","findIndex","i","index","splice","idxDot","lastIndexOf","extFile","substr","toLowerCase","ValidateSize","dataurl","filetype","filename","cropCanvas","Caman","el_width","offsetWidth","el_height","offsetHeight","el_top","offsetTop","el_left","offsetLeft","crop","render","createElement","appendChild","overflowY","reset","$ref","getActiveEditorOptions","c_w","c_h","destinationCanvas","destCtx","getContext","canvas","drawImage","toDataURL","dragCropBox","resizeCropBox","textContent","applyFilter","applyPreset","applyRotate","$w","$h","applyResize","dragItem","currentX","currentY","initialX","initialY","container","active","xOffset","yOffset","dragStart","type","touches","clientX","clientY","target","dragEnd","drag","setTranslate","xPos","yPos","top","left","checkIfMobile","test","navigator","userAgent","file","FileSize","files","size","_data","resizeHandle","startX","startY","startWidth","startHeight","p","initDrag","parseInt","defaultView","getComputedStyle","documentElement","doDrag","stopDrag","removeEventListener","$base64","$canvas","$ctx","$img","Image","crossOrigin","onload","$x","$y","name","split","src","URL","createObjectURL","$t","cloneImg","drawImageScaled","bind","contains","$reader","FileReader","result","readAsDataURL","img","ctx","hRatio","vRatio","ratio","Math","min","centerShift_x","centerShift_y","clearRect","resize","$v","$type","replace","revert","brightness","contrast","saturation","exposure","clip","hue","sepia","noise","vintage","stackBlur","lomo","clarity","sinCity","sunrise","crossProcess","orangePeel","love","grungy","jarques","pinhole","oldBoot","glowingSun","hazyDays","herMajesty","nostalgia","hemingway","rotate","redisplayImageModal","toBase64","t","isHidden","visibility"],"mappings":"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","file":"src.48720844.js","sourceRoot":"..","sourcesContent":["import './style.scss';\r\nwindow.cnimage_editor = function($options){\r\n\r\n\r\n\tlet $storage = window.localStorage;\r\n\r\n\tlet $editor = ( typeof $options == 'object' && $options.hasOwnProperty('el') ) ? document.querySelector($options.el) : false;\r\n\r\n\tlet $ob = ( typeof $options == 'object' && $options.hasOwnProperty('auto_browse')  ) ? $options.auto_browse : false;\r\n\r\n\tlet $on_created = ( typeof $options == 'object' && $options.hasOwnProperty('on_created')  ) ? $options.on_created : false;\r\n\r\n\tlet $image_editor = ( typeof $options == 'object' && $options.hasOwnProperty('image_editor') ) ? $options.image_editor : true;\r\n\r\n\tlet $on_browse = ( typeof $options == 'object' && $options.hasOwnProperty('on_browse') && typeof $options.on_browse == 'function' ) ? $options.on_browse : false;\r\n\r\n\tlet $on_display = ( typeof $options == 'object' && $options.hasOwnProperty('on_display') && typeof $options.on_display == 'function' ) ? $options.on_display : false;\r\n\r\n\tlet $on_edit = ( typeof $options == 'object' && $options.hasOwnProperty('on_edit') && typeof $options.on_edit == 'function' ) ? $options.on_edit : false;\r\n\r\n\tlet $on_delete = ( typeof $options == 'object' && $options.hasOwnProperty('on_delete') && typeof $options.on_delete == 'function' ) ? $options.on_delete : false;\r\n\r\n\tlet $on_save = ( typeof $options == 'object' && $options.hasOwnProperty('on_save') && typeof $options.on_save == 'function' ) ? $options.on_save : false;\r\n\r\n\tlet $on_reset = ( typeof $options == 'object' && $options.hasOwnProperty('on_reset') && typeof $options.on_reset == 'function' ) ? $options.on_reset : false;\r\n\r\n\tlet $on_close = ( typeof $options == 'object' && $options.hasOwnProperty('on_close') && typeof $options.on_close == 'function' ) ? $options.on_close : false;\r\n\r\n\tlet $global = this;\r\n\r\n\tlet $editor_width = ( typeof $options == 'object' && $options.hasOwnProperty('width') ) ? $options.width : 300;\r\n\r\n\tlet $editor_height = ( typeof $options == 'object' && $options.hasOwnProperty('height') ) ? $options.height : 300;\r\n\r\n\tlet $cropbox_width = ( typeof $options == 'object' && $options.hasOwnProperty('cropbox_width') ) ? $options.cropbox_width : 150;\r\n\tlet $cropbox_height = ( typeof $options == 'object' && $options.hasOwnProperty('cropbox_height') ) ? $options.cropbox_height : 150;\r\n\tlet $cropbox_resize = ( typeof $options == 'object' && $options.hasOwnProperty('cropbox_resize') ) ? $options.cropbox_resize : true;\r\n\t\r\n\tlet $cropbox_resize_minwidth = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('minwidth') ) ? $options.cropbox_resize.minwidth : 50;\r\n\tlet $cropbox_resize_minheight = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('minheight') ) ? $options.cropbox_resize.minheight : 50;\r\n\tlet $cropbox_resize_maxwidth = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('maxwidth') ) ? $options.cropbox_resize.maxwidth : 800;\r\n\tlet $cropbox_resize_maxheight = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('maxheight') ) ? $options.cropbox_resize.maxheight : 800;\r\n\r\n\tlet $autocrop = ( typeof $options == 'object' && typeof $options.autocrop == 'object' ) ? $options.autocrop : false;\r\n\r\n\tlet $cropboxsave_width = ( $autocrop && typeof $options.autocrop == 'object' && $options.autocrop.hasOwnProperty('width') ) ? $options.autocrop.width : 50;\r\n\tlet $cropboxsave_height = ( $autocrop && typeof $options.autocrop == 'object' && $options.autocrop.hasOwnProperty('height') ) ? $options.autocrop.height : 50;\r\n\r\n\tlet $imgcache = ( typeof $options == 'object' && $options.hasOwnProperty('imgcache') ) ? $options.imgcache : false;\r\n\r\n\tif( $imgcache && $storage == 'undefined' ){\r\n\t\tconsole.log('Web Storage is not supported! image caching mechanism disabled');\r\n\t\t$imgcache = false;\r\n\t}\r\n\r\n\tif( !$imgcache && $storage ){\r\n\t\t$storage.setItem('imgeditorcachedb',[]);\r\n\t}\r\n\r\n    let rotation = 0;\r\n\r\n    if( !$editor ){\r\n    \tconsole.log('Bind an element e.g. new cnimage_editor( {  el : <element> } )');\r\n    \treturn;\r\n    }\r\n\r\n    let _editordata = document.querySelector('body').getAttribute('data-imgeditor'),_editor = {};\r\n\r\n\tif( _editordata ){\r\n\t\t_editor = JSON.parse(_editordata);\r\n\t\t_editor.push({\r\n\t\t\t$el : $options.el,\r\n\t\t\t$editor : $editor,\r\n\t\t\t$image_editor : $image_editor,\r\n\t\t\t$auto_browse : $ob,\r\n\t\t\t$on_browse : $on_browse,\r\n\t\t\t$on_display : $on_display,\r\n\t\t\t$on_edit : $on_edit,\r\n\t\t\t$on_delete : $on_delete,\r\n\t\t\t$on_save : $on_save,\r\n\t\t\t$on_reset : $on_reset,\r\n\t\t\t$on_close : $on_close,\r\n\t\t\t$editor_width : $editor_width,\r\n\t\t\t$editor_height : $editor_height,\r\n\t\t\t$cropbox_width : $cropbox_width,\r\n\t\t\t$cropbox_height : $cropbox_height,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$cropbox_resize : $cropbox_resize,\r\n\t\t\t$cropbox_resize_minwidth : $cropbox_resize_minwidth,\r\n\t\t\t$cropbox_resize_minheight : $cropbox_resize_minheight,\r\n\t\t\t$cropbox_resize_maxwidth : $cropbox_resize_maxwidth,\r\n\t\t\t$cropbox_resize_maxheight : $cropbox_resize_maxheight,\r\n\t\t\t$autocrop : $autocrop,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$imgcache : $imgcache,\r\n\t\t\trawoptions : $options\r\n\t\t});\r\n\t}else{\r\n\t\t_editor = [{\r\n\t\t\t$el : $options.el,\r\n\t\t\t$editor : $editor,\r\n\t\t\t$image_editor : $image_editor,\r\n\t\t\t$auto_browse : $ob,\r\n\t\t\t$on_browse : $on_browse,\r\n\t\t\t$on_display : $on_display,\r\n\t\t\t$on_edit : $on_edit,\r\n\t\t\t$on_delete : $on_delete,\r\n\t\t\t$on_save : $on_save,\r\n\t\t\t$on_reset : $on_reset,\r\n\t\t\t$on_close : $on_close,\r\n\t\t\t$editor_width : $editor_width,\r\n\t\t\t$editor_height : $editor_height,\r\n\t\t\t$cropbox_width : $cropbox_width,\r\n\t\t\t$cropbox_height : $cropbox_height,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$cropbox_resize : $cropbox_resize,\r\n\t\t\t$cropbox_resize_minwidth : $cropbox_resize_minwidth,\r\n\t\t\t$cropbox_resize_minheight : $cropbox_resize_minheight,\r\n\t\t\t$cropbox_resize_maxwidth : $cropbox_resize_maxwidth,\r\n\t\t\t$cropbox_resize_maxheight : $cropbox_resize_maxheight,\r\n\t\t\t$autocrop : $autocrop,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$imgcache : $imgcache,\r\n\t\t\trawoptions : $options\r\n\t\t}];\r\n\t}\r\n\r\n\tdocument.querySelector('body').setAttribute('data-imgeditor',JSON.stringify(_editor) );\r\n\r\n\r\n\tthis.init = function(){\r\n\r\n\t\tif( document.querySelector('#image-editor-modal') == null && $image_editor ){\r\n\t\t\tthis.initModalEditor();\r\n\t\t}\r\n\r\n\t\t// add height and width to editor\t\t\r\n\t\t$editor.style.width = $editor_width+'px';\r\n\t\t$editor.style.height = $editor_height+'px';\r\n\r\n\t\t// -- end height and width editor\r\n\r\n\t\t$editor.classList.add('image-editor'); // classes for the editor\r\n\r\n\r\n\t\tlet $default_canvas = '';\r\n\r\n\t\tvar $id =  document.querySelectorAll('.image-editor').length -1;\r\n\r\n\t\t$editor.setAttribute('data-index',$id);\r\n\r\n\t\tif( $editor.querySelector('input.filetype') == null && $editor.querySelector('input.filename') == null && $editor.querySelector('input.image_src') == null ){\t\t\t\r\n\t\t\t// build editor structure\r\n\t\t\t$editor.innerHTML = '<input type=\"hidden\" name=\"image['+$id+'][filetype]\" class=\"filetype\"><input type=\"hidden\" name=\"image['+$id+'][filename]\" class=\"filename\"><input type=\"hidden\" name=\"image['+$id+'][contents]\" class=\"image_src\"><input class=\"file-browse\" type=\"file\" accept=\"image/x-png,image/jpeg,image/png\" style=\"display:none;\"><div class=\"image-editor-tools\"><a class=\"image-editor-browse flex-center radius-5\"><i class=\"fas fa-plus\"></i></a><a class=\"image-editor-edit flex-center radius-5\"><i class=\"fas fa-magic\"></i></a><a class=\"image-editor-delete flex-center radius-5\"><i class=\"far fa-trash-alt\"></i></a></div><div class=\"image-editor-preview\"></div>';\r\n\t\t\t// -- end editor structure\r\n\t\t}\r\n\r\n\t\t$editor.querySelector('.image-editor-browse').style.display = 'flex'; // show the browse button\r\n\r\n\t\tif( $editor.querySelector('input.filetype') != '' && $editor.querySelector('input.filename').value != '' && $editor.querySelector('input.image_src').value != '' ){\r\n\r\n\t\t\t$editor.querySelector('.image-editor-edit').style.display = 'flex';\r\n\t\t\t$editor.querySelector('.image-editor-delete').style.display = 'flex';\r\n\r\n\t\t\tdocument.querySelectorAll('.image-editor').forEach(function(el){\r\n\t\t\t\tel.classList.remove('active');\r\n\t\t\t});\r\n\t\t\t$editor.classList.add('active');\r\n\r\n\t\t\tthis.displayImage(false, $editor.querySelector('input.image_src').value );\r\n\r\n\t\t}else{\r\n\t\t\t$editor.querySelector('.image-editor-edit').style.display = 'none';\r\n\t\t\t$editor.querySelector('.image-editor-delete').style.display = 'none';\r\n\t\t}\r\n\r\n\t\tif( $editor.hasAttribute('data-default-img') ){\r\n\t\t\t$editor.querySelector('.image-editor-preview').innerHTML = '<img src=\"'+$editor.getAttribute('data-default-img')+'\">';\r\n\t\t\t$editor.querySelector('.image-editor-delete').style = 'block';\r\n\t\t}\r\n\r\n\t\t// browse button click event\r\n\r\n\t\t$editor.querySelector('.image-editor-browse').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\r\n\r\n\t\t\tif( $active_editor != null ){\r\n\t\t\t\t$active_editor.classList.remove('active');\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\tthis.closest('.image-editor').classList.add('active');\r\n\r\n\t\t\t$editor.querySelector('input.file-browse').click();\r\n\r\n\r\n\t\t});\r\n\r\n\t\t// -- end browse button click event\r\n\r\n\r\n\t\t// editor edit button click event\r\n\r\n\t\t$editor.querySelector('.image-editor-edit').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\t\t\tif( document.querySelector('#image-editor-modal') != null && $image_editor ){\r\n\r\n\t\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\r\n\r\n\t\t\t\tif( $active_editor != null ){\r\n\r\n\t\t\t\t\t$active_editor.classList.remove('active');\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tthis.closest('.image-editor').classList.add('active');\r\n\r\n\t\t\t\tdocument.querySelector('#image-editor-modal').style.display = 'block'; // show modal\r\n\t\t\t\tdocument.querySelector('#image-editor-modal').classList.add('active');\r\n\r\n\t\t\t\tif( $image_editor ){\r\n\r\n\t\t\t\t\t$global.displayImageModal(document.querySelector('.image-editor.active input.image_src').value,true);\r\n\r\n\t\t\t\t}else{\r\n\r\n\t\t\t\t\talert('Editor not found!');\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}else {\r\n\r\n\t\t\t\talert('Editor not found!');\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\t// run a custom delete function if theres one\r\n\r\n\t\t\tif( $on_edit ){\r\n\r\n\t\t\t\t$on_edit(document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t});\r\n\r\n\t\t// -- end edit button click event\r\n\r\n\t\t// when click image editor delete\r\n\r\n\t\t$editor.querySelector('.image-editor-delete').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t// run a custom delete function if theres one and only if return true\r\n\r\n\t\t\tif( $on_delete ){\r\n\r\n\t\t\t\tif( !$on_delete(document.querySelector('.image-editor.active')) ){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\r\n\r\n\r\n\t\t\tif( $active_editor != null ){\r\n\t\t\t\t$active_editor.classList.remove('active');\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.closest('.image-editor').classList.add('active');\r\n\r\n\r\n\r\n\t\t\tif( this.closest('.image-editor').querySelector('canvas') != null ){\r\n\r\n\t\t\t\tthis.closest('.image-editor').querySelector('canvas').remove();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif( this.closest('.image-editor').querySelector('img') != null ){\r\n\r\n\t\t\t\tthis.closest('.image-editor').querySelector('img').remove();\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\tthis.style.display = 'none';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('.image-editor-edit').style.display = 'none';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.file-browse').value = '';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.image_src').value = '';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.filename').value = '';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.filetype').value = '';\r\n\r\n\r\n\r\n\t\t\tif( $imgcache ){ // delete from web storage if option enabled\r\n\r\n\t\t\t\tvar _storage = $storage.getItem('imgeditorcachedb');\r\n\r\n\t\t\t\tif( _storage ){\r\n\t\t\t\t\t_storage = JSON.parse(_storage);\r\n\r\n\t\t\t\t\tvar _img = _storage.findIndex(function(i){\r\n\t\t\t\t\t\treturn i.index == $editor.getAttribute('data-index')\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif( _img != -1 ){\r\n\t\t\t\t\t\t_storage.splice(_img,1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// -- end image editor delete\r\n\r\n\r\n\r\n\t\t// editor file input change event\r\n\t\t$editor.querySelector('input.file-browse').addEventListener('change',function(){\r\n\r\n\t\t\tif( $on_browse ){\r\n\t\t\t\t$on_browse(this.value);\r\n\t\t\t}\r\n\r\n\t\t\tif( this.value == '' ){\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar idxDot = this.value.lastIndexOf(\".\") + 1;\r\n\r\n\t        var extFile = this.value.substr(idxDot, this.value.length).toLowerCase();\r\n\r\n\t        if (extFile==\"jpg\" || extFile==\"jpeg\" || extFile==\"png\"){\r\n\r\n\t        \tif( $global.ValidateSize(this) ){\r\n\r\n\t        \t\t$global.displayImage(this);\r\n\r\n\t        \t}\r\n\r\n\r\n\t        }else{\r\n\r\n\t            alert(\"Only jpg/jpeg and png files are allowed!\");\r\n\r\n\t        }   \r\n\t\t});\r\n\t\t// -- end editor input on change event\r\n\r\n\t\t// check if theres an img cache\r\n\t\tif( $imgcache && $storage.getItem('imgeditorcachedb') ){\r\n\r\n\t\t\tvar _storage = JSON.parse( $storage.getItem('imgeditorcachedb') );\r\n\r\n\t\t\t// find the item\r\n\t\t\tvar _img = _storage.findIndex(function(i){\r\n\t\t\t\treturn i.index == $editor.getAttribute('data-index');\r\n\t\t\t});\r\n\r\n\t\t\tdocument.querySelectorAll('.image-editor').forEach(function(el){\r\n\t\t\t\tel.classList.remove('active');\r\n\t\t\t});\r\n\r\n\t\t\t$editor.classList.add('active');\r\n\r\n\t\t\tif( _img != -1 ){\r\n\t\t\t\t$global.displayImage(false,_storage[_img].dataurl);\r\n\t\t\t\t$editor.querySelector('input.filetype').value = _storage[_img].filetype;\r\n\t\t\t\t$editor.querySelector('input.filename').value = _storage[_img].filename;\r\n\t\t\t\t$editor.querySelector('input.image_src').value = _storage[_img].dataurl;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( $on_created ){\r\n\t\t\t$on_created($editor);\r\n\t\t}\r\n\r\n\t\tif( $ob ){\r\n\t\t\t$editor.querySelector('.image-editor-browse').click();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.cropCanvas = function(){\r\n\t\tif( document.querySelector('#image-editor-modal #crop-box') != null ){\r\n\r\n\r\n\t\t\tCaman('#modal-canvas',function () {\r\n\r\n\t\t\t    // width, height, x, y\r\n\r\n\t\t\t    let el_width = document.querySelector('#image-editor-modal #crop-box').offsetWidth;\r\n\r\n\t\t\t    let el_height = document.querySelector('#image-editor-modal #crop-box').offsetHeight;\r\n\r\n\t\t\t    let el_top = document.querySelector('#image-editor-modal #crop-box').offsetTop;\r\n\r\n\t\t\t    let el_left = document.querySelector('#image-editor-modal #crop-box').offsetLeft;\r\n\r\n\t\t\t    this.crop(el_width,el_height,el_left,el_top);\r\n\r\n\t\t\t    this.render(function(){\r\n\r\n\t\t\t    \tdocument.querySelector('#image-editor-modal canvas').setAttribute('id','modal-canvas');\r\n\r\n\t\t\t\t    document.querySelector('#image-editor-modal #crop-box').remove();\r\n\r\n\t\t\t    });\r\n\r\n\r\n\r\n\t\t\t    \r\n\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.initModalEditor = function(){\r\n\r\n\t\tlet $el = document.createElement('div');\r\n\r\n\t\tlet $filters = '<div class=\"text-center\"></div>';\r\n\r\n\t\t$el.setAttribute('id','image-editor-modal');\r\n\r\n\t\t$el.innerHTML = '<div id=\"image-editor-body\"><div id=\"image-editor-toolbox\"> <ul class=\"p00 m00 list-style-none\"> <li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-modal-save\" class=\"display-block toolbox m5\"> <i class=\"fas fa-check mr5\"></i>Save </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-modal-close\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-times mr5\"></i>Cancel </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-modal-reset\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-sync mr5\"></i>Reset </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-magic mr5\"></i>Adjust </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\"> <li class=\"filter-slider\"> <label class=\"full-width display-block\">Brightness <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"brightness\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Contrast <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"contrast\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Saturation <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"saturation\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Vibrance <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"vibrance\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Exposure <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"exposure\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Clip <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"clip\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Hue <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"hue\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Sepia <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"sepia\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Noise <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"noise\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Sharpen <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"sharpen\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">StackBlur <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"stackBlur\"> </li></ul> </div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-magic mr5\"></i>Presets </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\" id=\"image-editor-presets\"> <li> <a data-preset=\"vintage\">Vintage</a></li><li> <a data-preset=\"lomo\">Lomo</a></li><li> <a data-preset=\"clarity\">Clarity</a></li><li> <a data-preset=\"sinCity\">Sin City</a></li><li> <a data-preset=\"sunrise\">Sunrise</a></li><li> <a data-preset=\"crossProcess\">Cross Process</a></li><li> <a data-preset=\"orangePeel\">Orange Peel</a></li><li> <a data-preset=\"love\">Love</a></li><li> <a data-preset=\"grungy\">Grungy</a></li><li> <a data-preset=\"jarques\">Jarques</a></li><li> <a data-preset=\"pinhole\">Pinhole</a></li><li> <a data-preset=\"oldBoot\">Old Boot</a></li><li> <a data-preset=\"glowingSun\">Glowing Sun</a></li><li> <a data-preset=\"hazyDays\">Hazy Days</a></li><li> <a data-preset=\"herMajesty\">Her Majesty</a></li><li> <a data-preset=\"nostalgia\">Nostalgia</a></li><li> <a data-preset=\"hemingway\">Hemingway</a></li><li> <a data-preset=\"concentrate\">concentrate</a></li></ul> </div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a class=\"display-block toolbox m5\"> <i class=\"fas fa-expand-arrows-alt mr5\"></i>Resize </a> <div class=\"toolbox-sub bg-white box-shadow\"><div class=\"col-xs-6 mb5 pl3 pr3\"><label class=\"full-width display-block\">Width:</label><input type=\"number\" class=\"mb00\" id=\"resize-width\" name=\"resize_width\"></div><div class=\"col-xs-6 mb5 pl3 pr3\"><label class=\"full-width display-block\">Height:</label><input type=\"number\" class=\"mb00\" id=\"resize-height\" name=\"resize_height\"></div><div class=\"col-xs-12 col-sm-12 mt8 pl3 pr3\"><a class=\"btn btn-block btn-sm btn-filled mb8\" id=\"resize-save\">Resize</a></div></div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-crop\" class=\"display-block toolbox m5\"> <i class=\"fas fa-crop-alt mr5\"></i>Crop </a> </li><li class=\"list-style-none align-left display-table toolbox-li\" style=\"display:none\"> <a id=\"image-editor-crop-now\" class=\"bg-success display-block toolbox m5\"> <i class=\"fas fa-check mr5\"></i>Crop </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-rotate\" class=\"display-block toolbox m5\"> <i class=\"fas fa-undo mr5\"></i>Rotate </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\" id=\"image-editor-rotate\"> <li> <a data-rotate=\"cw\">Clock wise</a></li><li> <a data-rotate=\"ccw\">Counter clock wise</a></li></ul></div></li></ul></div><div id=\"image-editor-canvas\"><div id=\"canvas-holder\" width=\"\"></div></div></div>';\r\n\r\n\r\n\r\n\t\tdocument.querySelector('body').appendChild($el);\r\n\r\n\r\n\r\n\t\t// bind a close modal editor event\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-close').addEventListener('click',function(e){\r\n\r\n\t\t\t\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal').style.display = 'none';\r\n\t\t\tdocument.querySelector('#image-editor-modal').classList.remove('active');\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal canvas').style.display = 'none';\r\n\r\n\t\t\tdocument.querySelector('body').style.overflowY = 'auto';\r\n\r\n\t\t\t$global.reset();\r\n\r\n\t\t\tif( $on_close ){\r\n\r\n\t\t\t\t$on_close(document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\t// -- end close modal editor\r\n\r\n\t\t// when click save button\r\n\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-save').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\r\n\t\t\tlet $ref = document.querySelector('#image-editor-modal #canvas-holder canvas');\r\n\r\n\r\n\r\n\t\t\tlet $x = ( $ref.width- $global.getActiveEditorOptions().$cropboxsave_width ) / 2;\r\n\r\n\t\t\tlet $y = ( $ref.height - $global.getActiveEditorOptions().$cropboxsave_height ) / 2;\r\n\r\n\r\n\r\n\t\t\tCaman('#modal-canvas',function () {\r\n\r\n\t\t\t    // width, height, x, y\r\n\r\n\t\t\t    this.render(function(){\r\n\r\n\t\t\t    \t\r\n\r\n\t\t\t    \tvar c_w = document.querySelector('#image-editor-modal canvas').offsetWidth;\r\n\r\n\t\t\t    \tvar c_h = document.querySelector('#image-editor-modal canvas').offsetHeight;\r\n\r\n\r\n\r\n\t\t\t    \tdocument.querySelector('#image-editor-modal').style.display = 'none';\r\n\t\t\t    \tdocument.querySelector('#image-editor-modal').classList.remove('active');\r\n\r\n\t\t\t    \tif( document.querySelector('.image-editor.active canvas') != null ){\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active canvas').remove();\r\n\r\n\t\t\t    \t}\r\n\r\n\t\t\t    \tif( document.querySelector('.image-editor.active img') != null ){\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active img').remove();\r\n\r\n\t\t\t    \t}\r\n\r\n\t\t\t    \tvar el = document.createElement('canvas');\r\n\r\n\t\t\t    \tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild(el);\r\n\r\n\t\t\t    \tif( document.querySelector('.image-editor.active img') != null ){\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild(el);\r\n\r\n\t\t\t    \t}\r\n\r\n\t\t\t    \tvar destinationCanvas = document.querySelector('.image-editor.active canvas');\r\n\r\n\t\t\t    \tvar destCtx = destinationCanvas.getContext('2d');\r\n\r\n\t\t\t    \tdestCtx.canvas.width = c_w;\r\n\r\n\t\t\t    \tdestCtx.canvas.height = c_h;\r\n\r\n\t\t\t    \tdestCtx.drawImage(document.querySelector('#image-editor-modal canvas'), 0, 0);\r\n\r\n\t\t\t    \t// get the data base url\r\n\r\n\t\t\t    \tdocument.querySelector('.image-editor.active input.image_src').value = document.querySelector('.image-editor.active canvas').toDataURL();\r\n\r\n\t\t\t    \tif( $imgcache ){ // delete from web storage if option enabled\r\n\r\n\t\t\t\t\t\tvar _storage = $storage.getItem('imgeditorcachedb');\r\n\r\n\t\t\t\t\t\tif( _storage ){\r\n\t\t\t\t\t\t\t_storage = JSON.parse(_storage);\r\n\r\n\t\t\t\t\t\t\tvar _img = _storage.findIndex(function(i){\r\n\t\t\t\t\t\t\t\treturn i.index == $editor.getAttribute('data-index')\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tif( _img != -1 ){\r\n\t\t\t\t\t\t\t\t_storage[_img].dataurl = document.querySelector('.image-editor.active input.image_src').value;\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t_storage.push({\r\n\t\t\t\t\t\t\t\t\tindex : document.querySelector('.image-editor.active').getAttribute('data-index'),\r\n\t\t\t\t\t\t\t\t\tdataurl : document.querySelector('.image-editor.active input.image_src').value,\r\n\t\t\t\t\t\t\t\t\tfiletype : document.querySelector('.image-editor.active input.filetype').value,\r\n\t\t\t\t\t\t\t\t\tfilename : document.querySelector('.image-editor.active input.filename').value\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\r\n\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\tvar _storage = [];\r\n\r\n\t\t\t\t\t\t\t_storage.push({\r\n\t\t\t\t\t\t\t\tindex : document.querySelector('.image-editor.active').getAttribute('data-index'),\r\n\t\t\t\t\t\t\t\tdataurl : document.querySelector('.image-editor.active input.image_src').value,\r\n\t\t\t\t\t\t\t\tfiletype : document.querySelector('.image-editor.active input.filetype').value,\r\n\t\t\t\t\t\t\t\tfilename : document.querySelector('.image-editor.active input.filename').value\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif( $on_save ){\r\n\t\t\t\t\t\t$on_save(document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t    });\r\n\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// set body to overflow auto\r\n\t\t\tdocument.querySelector('body').style.overflowY = 'auto';\r\n\r\n\t\t});\r\n\r\n\t\t// -- end click save button\r\n\r\n\t\t// on crop\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').addEventListener('click',function(e){\r\n\r\n\r\n\t\t\tlet $el = document.createElement('div');\r\n\r\n\t\t\t$el.setAttribute('id','crop-box');\r\n\r\n\r\n\r\n\t\t\t$el.style.width = $cropbox_width+'px';\r\n\r\n\t\t\t$el.style.height = $cropbox_height+'px';\r\n\r\n\r\n\r\n\t\t\t$el.innerHTML = '<div class=\"resizer\" style=\"position:absolute;top:-2px;left:-2px;border-top: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;top:-2px;right:-2px;border-top: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;bottom:-2px;left:-2px;border-bottom: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;bottom:-2px;right:-2px;border-bottom: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div>';\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($el);\r\n\r\n\r\n\r\n\t\t\t$global.dragCropBox();\r\n\r\n\t\t\t$global.resizeCropBox();\r\n\r\n\r\n\r\n\t\t\tthis.closest('li').style.display = 'none';\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').closest('li').style.display = 'block';\r\n\r\n\t\t\t\r\n\r\n\t\t});\r\n\r\n\t\t// -- end on crop\r\n\r\n\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').addEventListener('click',function(e){\r\n\r\n\t\t\t$global.cropCanvas();\r\n\r\n\r\n\r\n\t\t\tthis.closest('li').style.display = 'none';\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').closest('li').style.display = 'block';\r\n\r\n\t\t});\r\n\r\n\t\t// Update the current slider value (each time you drag the slider handle)\r\n\r\n\t\tdocument.querySelectorAll('.filter-slider').forEach(function($el){\r\n\r\n\t\t\t$el.querySelector('.filter-range').textContent = $el.querySelector('.filter-range-input').value;\r\n\r\n\r\n\r\n\t\t\t$el.querySelector('.filter-range-input').addEventListener('input',function(){\r\n\r\n\t\t\t\tthis.closest('.filter-slider').querySelector('.filter-range').textContent = this.value;\r\n\r\n\t\t\t\t$global.applyFilter(this.getAttribute('data-filter'),this.value);\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t// -- end update slider values\r\n\r\n\r\n\r\n\t\t// apply preset\r\n\r\n\t\tdocument.querySelectorAll('#image-editor-modal #image-editor-presets li a').forEach(function($el){\r\n\r\n\t\t\t$el.addEventListener('click',function(e){\r\n\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$global.applyPreset( $el.getAttribute('data-preset'));\r\n\r\n\t\t\t});\r\n\r\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t// -- end apply preset\r\n\r\n\r\n\r\n\t\t// when rotate\r\n\r\n\t\tdocument.querySelectorAll('#image-editor-modal #image-editor-rotate li a').forEach(function($el){\r\n\r\n\t\t\t$el.addEventListener('click',function(e){\r\n\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$global.applyRotate( $el.getAttribute('data-rotate'));\r\n\r\n\t\t\t});\r\n\r\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t\t\t\r\n\r\n\t\t});\r\n\r\n\t\t// -- end rotate\r\n\r\n\t\t// reset\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-reset').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\r\n\t\t\t$global.reset();\r\n\r\n\t\t\tif( $on_reset ){\r\n\r\n\t\t\t\t$on_reset(document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\t// -- end reset\r\n\r\n\r\n\r\n\t\t// resize\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #resize-save').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\r\n\t\t\tlet $w = this.closest('.toolbox-sub').querySelector('#resize-width').value;\r\n\r\n\t\t\tlet $h = this.closest('.toolbox-sub').querySelector('#resize-height').value;\r\n\r\n\t\t\t\r\n\r\n\t\t\t$global.applyResize($w,$h);\r\n\r\n\t\t});\r\n\r\n\t\t// -- end resize\r\n\r\n\t}\r\n\r\n\tthis.dragCropBox = function(){\r\n\r\n\t    let dragItem = document.querySelector(\"#image-editor-modal #crop-box\");\r\n\r\n\t    let container = document.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder');\r\n\r\n\r\n\r\n\t    let active = false;\r\n\r\n\t    let currentX;\r\n\r\n\t    let currentY;\r\n\r\n\t    let initialX;\r\n\r\n\t    let initialY;\r\n\r\n\t    let xOffset = 0;\r\n\r\n\t    let yOffset = 0;\r\n\r\n\r\n\r\n\t    container.addEventListener(\"touchstart\", dragStart, false);\r\n\r\n\t    container.addEventListener(\"touchend\", dragEnd, false);\r\n\r\n\t    container.addEventListener(\"touchmove\", drag, false);\r\n\r\n\r\n\r\n\t    container.addEventListener(\"mousedown\", dragStart, false);\r\n\r\n\t    container.addEventListener(\"mouseup\", dragEnd, false);\r\n\r\n\t    container.addEventListener(\"mousemove\", drag, false);\r\n\r\n\r\n\r\n\r\n\r\n\t    function dragStart(e) {\r\n\r\n\t      if (e.type === \"touchstart\") {\r\n\r\n\t        initialX = e.touches[0].clientX - xOffset;\r\n\r\n\t        initialY = e.touches[0].clientY - yOffset;\r\n\r\n\t      } else {\r\n\r\n\t        initialX = e.clientX - xOffset;\r\n\r\n\t        initialY = e.clientY - yOffset;\r\n\r\n\t      }\r\n\r\n\r\n\r\n\t      if (e.target === dragItem) {\r\n\r\n\t        active = true;\r\n\r\n\t      }\r\n\r\n\r\n\r\n\t    }\r\n\r\n\r\n\r\n\t    function dragEnd(e) {\r\n\r\n\t      initialX = currentX;\r\n\r\n\t      initialY = currentY;\r\n\r\n\r\n\r\n\t      active = false;\r\n\r\n\t    }\r\n\r\n\r\n\r\n\t    function drag(e) {\r\n\r\n\t      if (active) {\r\n\r\n\t      \r\n\r\n\t        e.preventDefault();\r\n\r\n\t      \r\n\r\n\t        if (e.type === \"touchmove\") {\r\n\r\n\t          currentX = e.touches[0].clientX - initialX;\r\n\r\n\t          currentY = e.touches[0].clientY - initialY;\r\n\r\n\t        } else {\r\n\r\n\t          currentX = e.clientX - initialX;\r\n\r\n\t          currentY = e.clientY - initialY;\r\n\r\n\t        }\r\n\r\n\r\n\r\n\t        xOffset = currentX;\r\n\r\n\t        yOffset = currentY;\r\n\r\n\r\n\r\n\t        setTranslate(currentX, currentY, dragItem);\r\n\r\n\t      }\r\n\r\n\t    }\r\n\r\n\r\n\r\n\t    function setTranslate(xPos, yPos, el) {\r\n\r\n\t      // el.style.transform = \"translate3d(\" + xPos + \"px, \" + yPos + \"px, 0)\";\r\n\r\n\t      el.style.top = yPos+'px';\r\n\r\n\t      el.style.left = xPos+'px';\r\n\r\n\t    }\r\n\r\n\t}\r\n\r\n\t// check if mobile, return false otherwise\r\n\r\n\tthis.checkIfMobile = function(){\r\n\r\n\t\t// device detection\r\n\r\n\t\tif(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) \r\n\r\n\t\t    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(navigator.userAgent.substr(0,4))) { \r\n\r\n\t\t    return true;\r\n\r\n\t\t}else{\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// -- end check if mobile\r\n\r\n\r\n\r\n\t// validate filesize\r\n\r\n\tthis.ValidateSize = function(file) {\r\n\r\n        var FileSize = file.files[0].size / 1024 / 1024; // in MB\r\n\r\n        if (FileSize > 2) {\r\n\r\n            alert('File size exceeds 2 MB');\r\n\r\n        } else {\r\n\r\n        \treturn true;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\t// -- end validate filesize\r\n\r\n\t// resize crop box event\r\n\tthis.getActiveEditorOptions = function(){\r\n\r\n\t\tlet _data = JSON.parse(document.querySelector('body').getAttribute('data-imgeditor') );\r\n\r\n\t\treturn _data[_data.findIndex(function(i){\r\n\t\t\treturn i.$el == '#'+document.querySelector('.image-editor.active').getAttribute('id');\r\n\t\t})];\r\n\t};\r\n\r\n\tthis.resizeCropBox = function() {\r\n\r\n\t\t\r\n\t \tlet resizeHandle = document.querySelectorAll('#image-editor-modal #image-editor-canvas #crop-box .resizer');\r\n\r\n\t\tlet p = document.querySelector('#image-editor-modal #image-editor-canvas #crop-box');\r\n\r\n\t\tresizeHandle.forEach(function(el){\r\n\r\n\t\t\tif( $global.checkIfMobile() ){\r\n\r\n\t\t\t\tel.addEventListener(\"touchstart\", initDrag, false);\r\n\r\n\t\t\t}else{\r\n\r\n\t\t\t\tel.addEventListener('mousedown', initDrag, false);\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\r\n\r\n\t\tvar startX, startY, startWidth, startHeight;\r\n\r\n\r\n\r\n\t\tfunction initDrag(e) {\r\n\t\t\t\r\n\t\t\tif( !$global.getActiveEditorOptions().$cropbox_resize ){\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t   \tif( $global.checkIfMobile() ){\r\n\r\n\t\t   \t\tstartX = e.touches[0].clientX;\r\n\r\n\t\t   \t\tstartY = e.touches[0].clientY;\r\n\r\n\t\t   \t}else{\r\n\r\n\t\t   \t\tstartX = e.clientX;\r\n\r\n\t\t   \t\tstartY = e.clientY;\r\n\r\n\t\t   \t}\r\n\r\n\t\t   startWidth = parseInt(document.defaultView.getComputedStyle(p).width, 10);\r\n\r\n\t\t   startHeight = parseInt(document.defaultView.getComputedStyle(p).height, 10);\r\n\r\n\r\n\r\n\t\t   if( $global.checkIfMobile() ){\r\n\r\n\t\t   \tdocument.documentElement.addEventListener(\"touchmove\",doDrag, false);\r\n\r\n\t   \t   document.documentElement.addEventListener(\"touchend\", stopDrag, false);\r\n\r\n\t\t   }else{\r\n\r\n\t\t   \tdocument.documentElement.addEventListener('mousemove', doDrag, false);\r\n\r\n\t\t   document.documentElement.addEventListener('mouseup', stopDrag, false);\r\n\r\n\t\t   }\r\n\r\n\t\t   \r\n\r\n\t\t   document.documentElement.addEventListener(\"touchmove\",doDrag, false);\r\n\r\n\t   \t   document.documentElement.addEventListener(\"touchend\", stopDrag, false);\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tfunction doDrag(e) {\r\n\r\n\t\t\tif( $global.checkIfMobile() ){\r\n\r\n\r\n\t\t\t\tif( ( (startWidth + e.touches[0].clientX - startX) < $global.getActiveEditorOptions().$cropbox_resize_maxwidth ) && ( (startWidth + e.touches[0].clientX - startX) > $global.getActiveEditorOptions().$cropbox_resize_minwidth) ){\r\n\r\n\t\t\t\t\tp.style.width = (startWidth + e.touches[0].clientX - startX) + 'px';\r\n\r\n\t\t\t   \t}\r\n\r\n\t\t\t   \tif( ( (startHeight + e.touches[0].clientY - startY) < $global.getActiveEditorOptions().$cropbox_resize_maxheight ) && ( (startHeight + e.touches[0].clientY - startY) > $global.getActiveEditorOptions().$cropbox_resize_minheight) ){\r\n\r\n\t\t\t\t   \tp.style.height = (startHeight + e.touches[0].clientY - startY) + 'px';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}else{\t\t\t\t\r\n\r\n\t\t\t\tif( ( (startWidth + e.clientX - startX) < $global.getActiveEditorOptions().$cropbox_resize_maxwidth ) && ( (startWidth + e.clientX - startX) > $global.getActiveEditorOptions().$cropbox_resize_minwidth) ){\r\n\r\n\t\t\t\t\tp.style.width = (startWidth + e.clientX - startX) + 'px';\r\n\r\n\t\t\t   \t}\r\n\r\n\t\t\t   \tif( ( (startHeight + e.clientY - startY) < $global.getActiveEditorOptions().$cropbox_resize_maxheight ) && ( (startHeight + e.clientY - startY) > $global.getActiveEditorOptions().$cropbox_resize_minheight) ){\r\n\r\n\t\t\t\t   \tp.style.height = (startHeight + e.clientY - startY) + 'px';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tfunction stopDrag(e) {\r\n\r\n\t\t\tif( $global.checkIfMobile() ){\r\n\r\n\t\t\t\tdocument.documentElement.removeEventListener(\"touchmove\", doDrag, false);\r\n\r\n\t\t   \t   \tdocument.documentElement.removeEventListener(\"touchend\", stopDrag, false);\r\n\r\n\t\t\t}else{\r\n\r\n\t\t\t\tdocument.documentElement.removeEventListener('mousemove', doDrag, false);\r\n\r\n\t\t\t   \tdocument.documentElement.removeEventListener('mouseup', stopDrag, false);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// when click browse, display image\r\n\r\n\tthis.displayImage = function($el,$base64){\r\n\r\n\t\tvar $base64 = ( $base64 != 'undefined' ) ? $base64 : false;\r\n\t\tif( !$base64){\r\n\t\t\tif ( $el.files == 'undefined' && !$el.files[0] == 'undefined' ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// always remove existing canvas\r\n\r\n\t\tif( document.querySelector('.image-editor.active canvas') != null ){\r\n\r\n\t\t\tdocument.querySelector('.image-editor.active canvas').remove();\r\n\r\n\t\t}\r\n\r\n\t\tif( document.querySelector('.image-editor.active img') != null ){\r\n\r\n\t\t\tdocument.querySelector('.image-editor.active img').remove();\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// append a default canvas\r\n\r\n\t\tlet $canvas = document.createElement('canvas');\r\n\r\n\t\t$canvas.style.display = 'none';\r\n\r\n\t\tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild($canvas);\r\n\r\n\t\t// -- end append default canvas\r\n\r\n\r\n\r\n    \tlet $ctx = document.querySelector('.image-editor.active canvas').getContext('2d');\r\n\r\n\t\tlet $img = new Image;\r\n\r\n\t\t$img.crossOrigin = 'anonymous';\r\n\r\n\r\n\r\n\r\n\t\t$img.onload = function() {\r\n\r\n\r\n\t\t\t$ctx.canvas.width = this.width;\r\n\r\n\t\t    $ctx.canvas.height = this.height;\r\n\r\n\t\t    $ctx.drawImage($img,0,0);\r\n\r\n\t\t    $editor.setAttribute('data-imgw',$img.width);\r\n\t\t    $editor.setAttribute('data-imgh',$img.height); \r\n\r\n\t\t\tif( !$base64){\r\n\r\n\t\t\t    let $x = ( this.width- $global.getActiveEditorOptions().$cropboxsave_width ) / 2;\r\n\t\t\t\tlet $y = ( this.height - $global.getActiveEditorOptions().$cropboxsave_height ) / 2;\r\n\r\n\t\t\t\tCaman(\".image-editor.active canvas\", function () {\r\n\r\n\t\t\t\t\t// width, height, x, y\r\n\t\t\t\t\tif( !$autocrop ){\r\n\t\t\t\t\t\tthis.crop($img.width, $img.height,0,0);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.crop($global.getActiveEditorOptions().$cropboxsave_width, $global.getActiveEditorOptions().$cropboxsave_height,$x,$y);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t    this.render(function(){\r\n\r\n\t\t\t\t    \t// get the data base url\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.image_src').value = document.querySelector('.image-editor.active canvas').toDataURL();\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.filename').value = $el.files[0].name;\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.filetype').value = document.querySelector('.image-editor.active input.filename').value.split('.')[1];\r\n\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    if( $on_display ){\r\n\t\t\t\t\t\t$on_display(document.querySelector('.image-editor.active'));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif( document.querySelector('#image-editor-modal') != null && $image_editor ){\r\n\r\n\t\t\t\tdocument.querySelector('.image-editor.active .image-editor-edit').style.display = 'flex';\r\n\r\n\t\t\t}else{\r\n\r\n\t\t\t\tdocument.querySelector('.image-editor.active .image-editor-edit').style.display = 'none';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdocument.querySelector('.image-editor.active .image-editor-delete').style.display = 'flex';\r\n\r\n\t\t\t$canvas.style.display = 'block';\r\n\r\n\r\n\t\t  }\r\n\r\n\t\t  \tif( !$base64){\r\n\t\t\t\t$img.src = URL.createObjectURL($el.files[0]);\r\n\t\t\t}else{\r\n\t\t\t\t$img.src = $base64;\r\n\t\t\t}\r\n\r\n\t}\r\n\r\n\t// -- end display image on modal editor\r\n\r\n\tthis.displayImageModal = function($el,$t){\t\t\r\n\r\n\t\t// always remove existing canvas\r\n\r\n\t\tif( document.querySelector('#image-editor-modal #image-editor-canvas canvas') != null ){\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas canvas').remove();\r\n\r\n\t\t}\r\n\r\n\t\t// append a default canvas\r\n\r\n\t\tlet $canvas = document.createElement('canvas');\r\n\r\n\t\t$canvas.setAttribute('id','modal-canvas');\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($canvas);\r\n\r\n\t\t// -- end append default canvas\r\n\r\n\r\n\r\n\t\t$global.cloneImg($el,$t);\r\n\r\n\r\n\r\n\t\tlet $ctx = document.querySelector('#image-editor-modal #image-editor-canvas canvas').getContext('2d');\r\n\r\n\t\tlet $img = new Image;\r\n\r\n\t\t$img.crossOrigin = 'anonymous';\r\n\r\n\r\n\r\n\t\tif( $t ){\r\n\r\n\t\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\r\n\r\n\t\t\t$img.src = document.querySelector('.image-editor.active input.image_src').value;\r\n\r\n\t\t}else{\r\n\r\n\t\t\tif ($el.files && $el.files[0]) {\r\n\r\n\r\n\r\n\t\t\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\r\n\r\n\t\t\t\t$img.src = URL.createObjectURL($el.files[0]);\r\n\r\n\r\n\r\n\t\t  \t}\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\r\n\r\n\t}\r\n\r\n\r\n\r\n\tthis.cloneImg = function($el,$t){\r\n\r\n\t\tif( document.querySelector('#clone-img') != null ){\r\n\r\n\t\t\tdocument.querySelector('#clone-img').remove();\r\n\r\n\t\t}\r\n\r\n\t\tif( $t ){\r\n\r\n\t\t\tvar el = document.createElement('div');\r\n\r\n\t\t\tel.setAttribute('id','clone-img');\r\n\r\n\t\t\tel.innerHTML = '<img src=\"'+$el+'\">';\r\n\r\n\t\t\tif( document.querySelector('#image-editor-modal').classList.contains('active')){\r\n\r\n\t\t\t\tdocument.querySelector('body').style.overflowY = 'hidden';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdocument.querySelector('body').appendChild(el);\r\n\r\n\r\n\r\n\t\t}else{\r\n\r\n\t\t\tvar $reader = new FileReader();\r\n\r\n\r\n\t\t\t$reader.onload = function(e){\r\n\r\n\t\t\t\tvar el = document.createElement('div');\r\n\r\n\t\t\t\tel.setAttribute('id','clone-img');\r\n\r\n\t\t\t\tel.innerHTML = '<img src=\"'+e.target.result+'\">';\r\n\r\n\t\t\t\tif( document.querySelector('#image-editor-modal').classList.contains('active')){\r\n\t\t\t\t\tdocument.querySelector('body').style.overflowY = 'hidden';\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdocument.querySelector('body').appendChild(el);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t$reader.readAsDataURL($el.files[0]);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\r\n\tthis.drawImageScaled = function(img, ctx) {\r\n\r\n\r\n\r\n\t\t   ctx.canvas.width = document.querySelector('#clone-img img').offsetWidth;\r\n\r\n\t\t   ctx.canvas.height = document.querySelector('#clone-img img').offsetHeight;\r\n\r\n\t\t   var canvas = ctx.canvas ;\r\n\r\n\t\t   var hRatio = canvas.width  / img.width;\r\n\r\n\t\t   var vRatio =  canvas.height / img.height;\r\n\r\n\t\t   var ratio  = Math.min ( hRatio, vRatio );\r\n\r\n\t\t   var centerShift_x = ( canvas.width - img.width*ratio ) / 2;\r\n\r\n\t\t   var centerShift_y = ( canvas.height - img.height*ratio ) / 2;  \r\n\r\n\t\t   ctx.clearRect(0,0,canvas.width, canvas.height);\r\n\r\n\t\t   ctx.drawImage(img, 0,0, img.width, img.height,centerShift_x,centerShift_y,img.width*ratio, img.height*ratio);\r\n\r\n\r\n\r\n\t\t   document.querySelector('#image-editor-modal canvas').style.display = 'block';\r\n\r\n\t}\r\n\r\n\r\n\r\n\t// reset editor\r\n\r\n\tthis.reset = function(){\r\n\r\n\r\n\r\n\t\tif( document.querySelector('#clone-img') != null ){\r\n\r\n\t\t\tdocument.querySelector('#clone-img').remove();\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tif( document.querySelector('#image-editor-modal #crop-box') != null ){\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #crop-box').remove();\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tdocument.querySelectorAll('.filter-range-input').forEach(function($el){\r\n\r\n\t\t\t$el.value = 0;\r\n\r\n\t\t});\r\n\r\n\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').closest('li').style.display = 'none';\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').closest('li').style.display = 'block';\r\n\r\n\t\t$global.displayImageModal(document.querySelector('.image-editor.active input.file-browse'),false);\r\n\r\n\r\n\t}\r\n\r\n\t// -- end reset editor\r\n\r\n\r\n\r\n\t// resize\r\n\r\n\tthis.applyResize = function($w,$h){\r\n\r\n\t\tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t\t  this.resize({\r\n\r\n\t\t    width: $w,\r\n\r\n\t\t    height: $h\r\n\r\n\t\t  });\r\n\r\n\r\n\r\n\t\t  this.render();\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t// -- end resize\r\n\r\n\r\n\r\n\t// filters\r\n\r\n\tthis.applyFilter = function($t,$v) {\r\n\r\n\t\tlet $type = $t.replace('filter-','');\r\n\r\n\t\tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t\t\tthis.revert(false);\r\n\r\n\t\t\tswitch($type){\r\n\r\n\t\t\t\tcase 'brightness':\r\n\r\n\t\t\t\t\tthis.brightness($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'contrast':\r\n\r\n\t\t\t\t\tthis.contrast($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'contrast':\r\n\r\n\t\t\t\t\tthis.saturation($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'vibrance':\r\n\r\n\t\t\t\t\tthis.contrast($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'exposure':\r\n\r\n\t\t\t\t\tthis.exposure($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'clip':\r\n\r\n\t\t\t\t\tthis.clip($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'clip':\r\n\r\n\t\t\t\t\tthis.clip($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hue':\r\n\r\n\t\t\t\t\tthis.hue($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sepia':\r\n\r\n\t\t\t\t\tthis.sepia($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'noise':\r\n\r\n\t\t\t\t\tthis.noise($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sharpen':\r\n\r\n\t\t\t\t\tthis.vintage($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'stackBlur':\r\n\r\n\t\t\t\t\tthis.stackBlur($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n    }\r\n\r\n    // -- end filters\r\n\r\n    // presets\r\n\r\n    this.applyPreset = function($t) {\t\r\n\r\n\t\tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t\t\tthis.revert(false);\r\n\r\n\t\t\tswitch($t){\r\n\r\n\t\t\t\tcase 'vintage':\r\n\r\n\t\t\t\t\tthis.vintage().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'lomo':\r\n\r\n\t\t\t\t\tthis.lomo().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'clarity':\r\n\r\n\t\t\t\t\tthis.clarity().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sinCity':\r\n\r\n\t\t\t\t\tthis.sinCity().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sunrise':\r\n\r\n\t\t\t\t\tthis.sunrise().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'crossProcess':\r\n\r\n\t\t\t\t\tthis.crossProcess().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'orangePeel':\r\n\r\n\t\t\t\t\tthis.orangePeel().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'love':\r\n\r\n\t\t\t\t\tthis.love().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'grungy':\r\n\r\n\t\t\t\t\tthis.grungy().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'jarques':\r\n\r\n\t\t\t\t\tthis.jarques().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'pinhole':\r\n\r\n\t\t\t\t\tthis.pinhole().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'oldBoot':\r\n\r\n\t\t\t\t\tthis.oldBoot().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'glowingSun':\r\n\r\n\t\t\t\t\tthis.glowingSun().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hazyDays':\r\n\r\n\t\t\t\t\tthis.hazyDays().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'herMajesty':\r\n\r\n\t\t\t\t\tthis.herMajesty().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'nostalgia':\r\n\r\n\t\t\t\t\tthis.nostalgia().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hemingway':\r\n\r\n\t\t\t\t\tthis.hemingway().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hemingway':\r\n\r\n\t\t\t\t\tthis.hemingway().render();\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n    }\r\n\r\n\r\n\r\n    // rotate func\r\n\r\n    this.applyRotate = function($t) {\r\n\r\n    \tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t    \tswitch($t){\r\n\r\n\t    \t\tcase 'cw':\r\n\r\n\t    \t\t\tthis.rotate(90).render();\r\n\r\n\t    \t\tbreak;\r\n\r\n\t    \t\tcase 'ccw':\r\n\r\n\t    \t\t\tthis.rotate(-90).render();\r\n\r\n\t    \t\tbreak;\r\n\r\n\t    \t}\r\n\r\n\t    \tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t    \t$global.redisplayImageModal(this.toBase64());\r\n\r\n\t    });\r\n\r\n\r\n    }\r\n\r\n    // -- end rotate func\r\n\r\n    // re render modal image\r\n    this.redisplayImageModal = function(t){\r\n    \tif( document.querySelector('#image-editor-modal #image-editor-canvas canvas') != null ){\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas canvas').remove();\r\n\t\t}\r\n\t\t// append a default canvas\r\n\r\n\t\tlet $canvas = document.createElement('canvas');\r\n\r\n\t\t$canvas.setAttribute('id','modal-canvas');\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($canvas);\r\n\r\n\t\t// -- end append default canvas\r\n\r\n\t\t$global.cloneImg(t,true);\r\n\r\n\r\n\t\tlet $ctx = document.querySelector('#image-editor-modal #image-editor-canvas canvas').getContext('2d');\r\n\r\n\t\tlet $img = new Image;\r\n\r\n\t\t$img.crossOrigin = 'anonymous';\r\n\r\n\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\r\n\t\t$img.src = t;\r\n    }\r\n\r\n\r\n\t// -- check if element is hidden, return true otherwise\r\n\r\n\tthis.isHidden = function(el) {\r\n\r\n\r\n\t    let style = window.getComputedStyle(el);\r\n\r\n\t    return ((style.display === 'none') || (style.visibility === 'hidden'));\r\n\r\n\t}\r\n\r\n\r\n\r\n\treturn this.init($options);\r\n}\r\n\r\n"]}