{"version":3,"sources":["src/index.js"],"names":["window","cnimage_editor","$options","$storage","localStorage","$editor","hasOwnProperty","document","querySelector","el","$ob","auto_browse","$image_editor","image_editor","$on_browse","on_browse","$on_display","on_display","$on_edit","on_edit","$on_delete","on_delete","$on_save","on_save","$on_reset","on_reset","$on_close","on_close","$global","$editor_width","width","$editor_height","height","$cropbox_width","cropbox_width","$cropbox_height","cropbox_height","$cropbox_resize","cropbox_resize","$cropbox_resize_minwidth","minwidth","$cropbox_resize_minheight","minheight","$cropbox_resize_maxwidth","maxwidth","$cropbox_resize_maxheight","maxheight","$autocrop","autocrop","$cropboxsave_width","$cropboxsave_height","$imgcache","imgcache","console","log","setItem","_editordata","getAttribute","_editor","JSON","parse","push","$el","$auto_browse","setAttribute","stringify","init","initModalEditor","style","classList","add","$default_canvas","$id","querySelectorAll","length","innerHTML","display","value","forEach","remove","displayImage","addEventListener","e","preventDefault","$active_editor","closest","click","displayImageModal","alert","_storage","getItem","_img","findIndex","i","index","splice","idxDot","lastIndexOf","extFile","substr","toLowerCase","ValidateSize","dataurl","filetype","filename","cropCanvas","Caman","el_width","offsetWidth","el_height","offsetHeight","el_top","offsetTop","el_left","offsetLeft","crop","render","createElement","appendChild","overflowY","reset","$ref","getActiveEditorOptions","c_w","c_h","destinationCanvas","destCtx","getContext","canvas","drawImage","toDataURL","dragCropBox","resizeCropBox","textContent","applyFilter","applyPreset","applyRotate","$w","$h","applyResize","dragItem","currentX","currentY","initialX","initialY","container","active","xOffset","yOffset","dragStart","type","touches","clientX","clientY","target","dragEnd","drag","setTranslate","xPos","yPos","top","left","checkIfMobile","test","navigator","userAgent","file","FileSize","files","size","_data","resizeHandle","startX","startY","startWidth","startHeight","p","initDrag","parseInt","defaultView","getComputedStyle","documentElement","doDrag","stopDrag","removeEventListener","$base64","$canvas","$ctx","$img","Image","crossOrigin","onload","$x","$y","name","split","src","URL","createObjectURL","$t","cloneImg","drawImageScaled","bind","contains","$reader","FileReader","result","readAsDataURL","img","ctx","hRatio","vRatio","ratio","Math","min","centerShift_x","centerShift_y","clearRect","resize","$v","$type","replace","revert","brightness","contrast","saturation","exposure","clip","hue","sepia","noise","vintage","stackBlur","lomo","clarity","sinCity","sunrise","crossProcess","orangePeel","love","grungy","jarques","pinhole","oldBoot","glowingSun","hazyDays","herMajesty","nostalgia","hemingway","rotate","redisplayImageModal","toBase64","t","isHidden","visibility"],"mappings":"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","file":"src.2c5a2542.js","sourceRoot":"..","sourcesContent":["import './style.scss';\nwindow.cnimage_editor = function($options){\n\n\n\tlet $storage = window.localStorage;\n\n\tlet $editor = ( typeof $options == 'object' && $options.hasOwnProperty('el') ) ? document.querySelector($options.el) : false;\n\n\tlet $ob = ( typeof $options == 'object' && $options.hasOwnProperty('auto_browse')  ) ? $options.auto_browse : false;\n\n\tlet $image_editor = ( typeof $options == 'object' && $options.hasOwnProperty('image_editor') ) ? $options.image_editor : true;\n\n\tlet $on_browse = ( typeof $options == 'object' && $options.hasOwnProperty('on_browse') && typeof $options.on_browse == 'function' ) ? $options.on_browse : false;\n\n\tlet $on_display = ( typeof $options == 'object' && $options.hasOwnProperty('on_display') && typeof $options.on_display == 'function' ) ? $options.on_display : false;\n\n\tlet $on_edit = ( typeof $options == 'object' && $options.hasOwnProperty('on_edit') && typeof $options.on_edit == 'function' ) ? $options.on_edit : false;\n\n\tlet $on_delete = ( typeof $options == 'object' && $options.hasOwnProperty('on_delete') && typeof $options.on_delete == 'function' ) ? $options.on_delete : false;\n\n\tlet $on_save = ( typeof $options == 'object' && $options.hasOwnProperty('on_save') && typeof $options.on_save == 'function' ) ? $options.on_save : false;\n\n\tlet $on_reset = ( typeof $options == 'object' && $options.hasOwnProperty('on_reset') && typeof $options.on_reset == 'function' ) ? $options.on_reset : false;\n\n\tlet $on_close = ( typeof $options == 'object' && $options.hasOwnProperty('on_close') && typeof $options.on_close == 'function' ) ? $options.on_close : false;\n\n\tlet $global = this;\n\n\tlet $editor_width = ( typeof $options == 'object' && $options.hasOwnProperty('width') ) ? $options.width : 300;\n\n\tlet $editor_height = ( typeof $options == 'object' && $options.hasOwnProperty('height') ) ? $options.height : 300;\n\n\tlet $cropbox_width = ( typeof $options == 'object' && $options.hasOwnProperty('cropbox_width') ) ? $options.cropbox_width : 150;\n\tlet $cropbox_height = ( typeof $options == 'object' && $options.hasOwnProperty('cropbox_height') ) ? $options.cropbox_height : 150;\n\tlet $cropbox_resize = ( typeof $options == 'object' && $options.hasOwnProperty('cropbox_resize') ) ? $options.cropbox_resize : true;\n\t\n\tlet $cropbox_resize_minwidth = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('minwidth') ) ? $options.cropbox_resize.minwidth : 50;\n\tlet $cropbox_resize_minheight = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('minheight') ) ? $options.cropbox_resize.minheight : 50;\n\tlet $cropbox_resize_maxwidth = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('maxwidth') ) ? $options.cropbox_resize.maxwidth : 800;\n\tlet $cropbox_resize_maxheight = ( typeof $options == 'object' && $cropbox_resize && $options.cropbox_resize.hasOwnProperty('maxheight') ) ? $options.cropbox_resize.maxheight : 800;\n\n\tlet $autocrop = ( typeof $options == 'object' && typeof $options.autocrop == 'object' ) ? $options.autocrop : false;\n\n\tlet $cropboxsave_width = ( $autocrop && typeof $options.autocrop == 'object' && $options.autocrop.hasOwnProperty('width') ) ? $options.autocrop.width : 50;\n\tlet $cropboxsave_height = ( $autocrop && typeof $options.autocrop == 'object' && $options.autocrop.hasOwnProperty('height') ) ? $options.autocrop.height : 50;\n\n\tlet $imgcache = ( typeof $options == 'object' && $options.hasOwnProperty('imgcache') ) ? $options.imgcache : false;\n\n\tif( $imgcache && $storage == 'undefined' ){\n\t\tconsole.log('Web Storage is not supported! image caching mechanism disabled');\n\t\t$imgcache = false;\n\t}\n\n\tif( !$imgcache && $storage ){\n\t\t$storage.setItem('imgeditorcachedb',[]);\n\t}\n\n    let rotation = 0;\n\n    if( !$editor ){\n    \tconsole.log('Bind an element e.g. new cnimage_editor( {  el : <element> } )');\n    \treturn;\n    }\n\n    let _editordata = document.querySelector('body').getAttribute('data-imgeditor'),_editor = {};\n\n\tif( _editordata ){\n\t\t_editor = JSON.parse(_editordata);\n\t\t_editor.push({\n\t\t\t$el : $options.el,\n\t\t\t$editor : $editor,\n\t\t\t$image_editor : $image_editor,\n\t\t\t$auto_browse : $ob,\n\t\t\t$on_browse : $on_browse,\n\t\t\t$on_display : $on_display,\n\t\t\t$on_edit : $on_edit,\n\t\t\t$on_delete : $on_delete,\n\t\t\t$on_save : $on_save,\n\t\t\t$on_reset : $on_reset,\n\t\t\t$on_close : $on_close,\n\t\t\t$editor_width : $editor_width,\n\t\t\t$editor_height : $editor_height,\n\t\t\t$cropbox_width : $cropbox_width,\n\t\t\t$cropbox_height : $cropbox_height,\n\t\t\t$cropboxsave_width : $cropboxsave_width,\n\t\t\t$cropboxsave_height : $cropboxsave_height,\n\t\t\t$cropbox_resize : $cropbox_resize,\n\t\t\t$cropbox_resize_minwidth : $cropbox_resize_minwidth,\n\t\t\t$cropbox_resize_minheight : $cropbox_resize_minheight,\n\t\t\t$cropbox_resize_maxwidth : $cropbox_resize_maxwidth,\n\t\t\t$cropbox_resize_maxheight : $cropbox_resize_maxheight,\n\t\t\t$autocrop : $autocrop,\n\t\t\t$cropboxsave_width : $cropboxsave_width,\n\t\t\t$cropboxsave_height : $cropboxsave_height,\n\t\t\t$imgcache : $imgcache,\n\t\t\trawoptions : $options\n\t\t});\n\t}else{\n\t\t_editor = [{\n\t\t\t$el : $options.el,\n\t\t\t$editor : $editor,\n\t\t\t$image_editor : $image_editor,\n\t\t\t$auto_browse : $ob,\n\t\t\t$on_browse : $on_browse,\n\t\t\t$on_display : $on_display,\n\t\t\t$on_edit : $on_edit,\n\t\t\t$on_delete : $on_delete,\n\t\t\t$on_save : $on_save,\n\t\t\t$on_reset : $on_reset,\n\t\t\t$on_close : $on_close,\n\t\t\t$editor_width : $editor_width,\n\t\t\t$editor_height : $editor_height,\n\t\t\t$cropbox_width : $cropbox_width,\n\t\t\t$cropbox_height : $cropbox_height,\n\t\t\t$cropboxsave_width : $cropboxsave_width,\n\t\t\t$cropboxsave_height : $cropboxsave_height,\n\t\t\t$cropbox_resize : $cropbox_resize,\n\t\t\t$cropbox_resize_minwidth : $cropbox_resize_minwidth,\n\t\t\t$cropbox_resize_minheight : $cropbox_resize_minheight,\n\t\t\t$cropbox_resize_maxwidth : $cropbox_resize_maxwidth,\n\t\t\t$cropbox_resize_maxheight : $cropbox_resize_maxheight,\n\t\t\t$autocrop : $autocrop,\n\t\t\t$cropboxsave_width : $cropboxsave_width,\n\t\t\t$cropboxsave_height : $cropboxsave_height,\n\t\t\t$imgcache : $imgcache,\n\t\t\trawoptions : $options\n\t\t}];\n\t}\n\n\tdocument.querySelector('body').setAttribute('data-imgeditor',JSON.stringify(_editor) );\n\n\n\tthis.init = function(){\n\n\t\tif( document.querySelector('#image-editor-modal') == null && $image_editor ){\n\t\t\tthis.initModalEditor();\n\t\t}\n\n\t\t// add height and width to editor\t\t\n\t\t$editor.style.width = $editor_width+'px';\n\t\t$editor.style.height = $editor_height+'px';\n\n\t\t// -- end height and width editor\n\n\t\t$editor.classList.add('image-editor'); // classes for the editor\n\n\n\t\tlet $default_canvas = '';\n\n\t\tvar $id =  document.querySelectorAll('.image-editor').length -1;\n\n\t\t$editor.setAttribute('data-index',$id);\n\n\t\tif( $editor.querySelector('input.filetype') == null && $editor.querySelector('input.filename') == null && $editor.querySelector('input.image-src') == null ){\t\t\t\n\t\t\t// build editor structure\n\t\t\t$editor.innerHTML = '<input type=\"hidden\" name=\"image['+$id+'][filetype]\" class=\"filetype\"><input type=\"hidden\" name=\"image['+$id+'][filename]\" class=\"filename\"><input type=\"hidden\" name=\"image['+$id+'][contents]\" class=\"image_src\"><input class=\"file-browse\" type=\"file\" accept=\"image/x-png,image/jpeg,image/png\" style=\"display:none;\"><div class=\"image-editor-tools\"><a class=\"image-editor-browse flex-center radius-5\"><i class=\"fas fa-plus\"></i></a><a class=\"image-editor-edit flex-center radius-5\"><i class=\"fas fa-magic\"></i></a><a class=\"image-editor-delete flex-center radius-5\"><i class=\"far fa-trash-alt\"></i></a></div><div class=\"image-editor-preview\"></div>';\n\t\t\t// -- end editor structure\n\t\t}\n\n\t\t$editor.querySelector('.image-editor-browse').style.display = 'flex'; // show the browse button\n\n\t\tif( $editor.querySelector('input.filetype') != '' && $editor.querySelector('input.filename').value != '' && $editor.querySelector('input.image_src').value != '' ){\n\n\t\t\t$editor.querySelector('.image-editor-edit').style.display = 'flex';\n\t\t\t$editor.querySelector('.image-editor-delete').style.display = 'flex';\n\n\t\t\tdocument.querySelectorAll('.image-editor').forEach(function(el){\n\t\t\t\tel.classList.remove('active');\n\t\t\t});\n\t\t\t$editor.classList.add('active');\n\n\t\t\tthis.displayImage(false, $editor.querySelector('input.image_src').value );\n\n\t\t}else{\n\t\t\t$editor.querySelector('.image-editor-edit').style.display = 'none';\n\t\t\t$editor.querySelector('.image-editor-delete').style.display = 'none';\n\t\t}\n\n\t\t// browse button click event\n\n\t\t$editor.querySelector('.image-editor-browse').addEventListener('click',function(e){\n\n\t\t\te.preventDefault();\n\n\n\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\n\n\t\t\tif( $active_editor != null ){\n\t\t\t\t$active_editor.classList.remove('active');\n\t\t\t}\n\n\n\n\t\t\tthis.closest('.image-editor').classList.add('active');\n\n\t\t\t$editor.querySelector('input.file-browse').click();\n\n\n\t\t});\n\n\t\t// -- end browse button click event\n\n\n\n\t\t// editor edit button click event\n\n\t\t$editor.querySelector('.image-editor-edit').addEventListener('click',function(e){\n\n\t\t\te.preventDefault();\n\n\n\t\t\tif( document.querySelector('#image-editor-modal') != null && $image_editor ){\n\n\t\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\n\n\t\t\t\tif( $active_editor != null ){\n\n\t\t\t\t\t$active_editor.classList.remove('active');\n\n\t\t\t\t}\n\n\n\t\t\t\tthis.closest('.image-editor').classList.add('active');\n\n\t\t\t\tdocument.querySelector('#image-editor-modal').style.display = 'block'; // show modal\n\t\t\t\tdocument.querySelector('#image-editor-modal').classList.add('active');\n\n\t\t\t\tif( $image_editor ){\n\n\t\t\t\t\t$global.displayImageModal(document.querySelector('.image-editor.active input.image_src').value,true);\n\n\t\t\t\t}else{\n\n\t\t\t\t\talert('Editor not found!');\n\n\t\t\t\t}\n\n\t\t\t}else {\n\n\t\t\t\talert('Editor not found!');\n\n\t\t\t}\n\n\n\n\t\t\t// run a custom delete function if theres one\n\n\t\t\tif( $on_edit ){\n\n\t\t\t\t$on_edit(document.querySelector('.image-editor.active'));\n\n\t\t\t}\n\n\n\n\t\t});\n\n\t\t// -- end edit button click event\n\n\t\t// when click image editor delete\n\n\t\t$editor.querySelector('.image-editor-delete').addEventListener('click',function(e){\n\n\t\t\te.preventDefault();\n\n\n\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\n\n\n\t\t\tif( $active_editor != null ){\n\t\t\t\t$active_editor.classList.remove('active');\n\n\t\t\t}\n\n\n\t\t\tthis.closest('.image-editor').classList.add('active');\n\n\n\n\t\t\tif( this.closest('.image-editor').querySelector('canvas') != null ){\n\n\t\t\t\tthis.closest('.image-editor').querySelector('canvas').remove();\n\n\t\t\t}\n\n\t\t\tif( this.closest('.image-editor').querySelector('img') != null ){\n\n\t\t\t\tthis.closest('.image-editor').querySelector('img').remove();\n\n\t\t\t}\n\n\n\n\t\t\tthis.style.display = 'none';\n\n\t\t\tthis.closest('.image-editor').querySelector('.image-editor-edit').style.display = 'none';\n\n\t\t\tthis.closest('.image-editor').querySelector('input.file-browse').value = '';\n\n\t\t\tthis.closest('.image-editor').querySelector('input.image_src').value = '';\n\n\t\t\tthis.closest('.image-editor').querySelector('input.filename').value = '';\n\n\t\t\tthis.closest('.image-editor').querySelector('input.filetype').value = '';\n\n\n\n\t\t\tif( $imgcache ){ // delete from web storage if option enabled\n\n\t\t\t\tvar _storage = $storage.getItem('imgeditorcachedb');\n\n\t\t\t\tif( _storage ){\n\t\t\t\t\t_storage = JSON.parse(_storage);\n\n\t\t\t\t\tvar _img = _storage.findIndex(function(i){\n\t\t\t\t\t\treturn i.index == $editor.getAttribute('data-index')\n\t\t\t\t\t});\n\n\t\t\t\t\tif( _img != -1 ){\n\t\t\t\t\t\t_storage.splice(_img,1);\n\t\t\t\t\t}\n\n\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// run a custom delete function if theres one\n\n\t\t\tif( $on_delete ){\n\n\t\t\t\t$on_delete(document.querySelector('.image-editor.active'));\n\n\t\t\t}\n\t\t});\n\n\t\t// -- end image editor delete\n\n\n\n\t\t// editor file input change event\n\t\t$editor.querySelector('input.file-browse').addEventListener('change',function(){\n\n\t\t\tif( $on_browse ){\n\t\t\t\t$on_browse(this.value);\n\t\t\t}\n\n\t\t\tif( this.value == '' ){\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\n\t\t\tvar idxDot = this.value.lastIndexOf(\".\") + 1;\n\n\t        var extFile = this.value.substr(idxDot, this.value.length).toLowerCase();\n\n\t        if (extFile==\"jpg\" || extFile==\"jpeg\" || extFile==\"png\"){\n\n\t        \tif( $global.ValidateSize(this) ){\n\n\t        \t\t$global.displayImage(this);\n\n\t        \t}\n\n\n\t        }else{\n\n\t            alert(\"Only jpg/jpeg and png files are allowed!\");\n\n\t        }   \n\t\t});\n\t\t// -- end editor input on change event\n\n\t\t// check if theres an img cache\n\t\tif( $imgcache && $storage.getItem('imgeditorcachedb') ){\n\n\t\t\tvar _storage = JSON.parse( $storage.getItem('imgeditorcachedb') );\n\n\t\t\t// find the item\n\t\t\tvar _img = _storage.findIndex(function(i){\n\t\t\t\treturn i.index == $editor.getAttribute('data-index');\n\t\t\t});\n\n\t\t\tdocument.querySelectorAll('.image-editor').forEach(function(el){\n\t\t\t\tel.classList.remove('active');\n\t\t\t});\n\n\t\t\t$editor.classList.add('active');\n\n\t\t\tif( _img != -1 ){\n\t\t\t\t$global.displayImage(false,_storage[_img].dataurl);\n\t\t\t\t$editor.querySelector('input.filetype').value = _storage[_img].filetype;\n\t\t\t\t$editor.querySelector('input.filename').value = _storage[_img].filename;\n\t\t\t\t$editor.querySelector('input.image_src').value = _storage[_img].dataurl;\n\t\t\t}\n\t\t}\n\n\t\tif( $ob ){\n\t\t\t$editor.querySelector('.image-editor-browse').click();\n\t\t}\n\n\t}\n\n\tthis.cropCanvas = function(){\n\t\tif( document.querySelector('#image-editor-modal #crop-box') != null ){\n\n\n\t\t\tCaman('#modal-canvas',function () {\n\n\t\t\t    // width, height, x, y\n\n\t\t\t    let el_width = document.querySelector('#image-editor-modal #crop-box').offsetWidth;\n\n\t\t\t    let el_height = document.querySelector('#image-editor-modal #crop-box').offsetHeight;\n\n\t\t\t    let el_top = document.querySelector('#image-editor-modal #crop-box').offsetTop;\n\n\t\t\t    let el_left = document.querySelector('#image-editor-modal #crop-box').offsetLeft;\n\n\t\t\t    this.crop(el_width,el_height,el_left,el_top);\n\n\t\t\t    this.render(function(){\n\n\t\t\t    \tdocument.querySelector('#image-editor-modal canvas').setAttribute('id','modal-canvas');\n\n\t\t\t\t    document.querySelector('#image-editor-modal #crop-box').remove();\n\n\t\t\t    });\n\n\n\n\t\t\t    \n\n\t\t\t});\n\n\t\t}\n\n\t}\n\n\tthis.initModalEditor = function(){\n\n\t\tlet $el = document.createElement('div');\n\n\t\tlet $filters = '<div class=\"text-center\"></div>';\n\n\t\t$el.setAttribute('id','image-editor-modal');\n\n\t\t$el.innerHTML = '<div id=\"image-editor-body\"><div id=\"image-editor-toolbox\"> <ul class=\"p00 m00 list-style-none\"> <li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-modal-save\" class=\"display-block toolbox m5\"> <i class=\"fas fa-check mr5\"></i>Save </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-modal-close\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-times mr5\"></i>Cancel </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-modal-reset\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-sync mr5\"></i>Reset </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-magic mr5\"></i>Adjust </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\"> <li class=\"filter-slider\"> <label class=\"full-width display-block\">Brightness <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"brightness\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Contrast <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"contrast\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Saturation <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"saturation\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Vibrance <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"vibrance\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Exposure <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"exposure\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Clip <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"clip\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Hue <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"hue\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Sepia <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"sepia\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Noise <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"noise\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Sharpen <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"sharpen\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">StackBlur <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"stackBlur\"> </li></ul> </div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-magic mr5\"></i>Presets </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\" id=\"image-editor-presets\"> <li> <a data-preset=\"vintage\">Vintage</a></li><li> <a data-preset=\"lomo\">Lomo</a></li><li> <a data-preset=\"clarity\">Clarity</a></li><li> <a data-preset=\"sinCity\">Sin City</a></li><li> <a data-preset=\"sunrise\">Sunrise</a></li><li> <a data-preset=\"crossProcess\">Cross Process</a></li><li> <a data-preset=\"orangePeel\">Orange Peel</a></li><li> <a data-preset=\"love\">Love</a></li><li> <a data-preset=\"grungy\">Grungy</a></li><li> <a data-preset=\"jarques\">Jarques</a></li><li> <a data-preset=\"pinhole\">Pinhole</a></li><li> <a data-preset=\"oldBoot\">Old Boot</a></li><li> <a data-preset=\"glowingSun\">Glowing Sun</a></li><li> <a data-preset=\"hazyDays\">Hazy Days</a></li><li> <a data-preset=\"herMajesty\">Her Majesty</a></li><li> <a data-preset=\"nostalgia\">Nostalgia</a></li><li> <a data-preset=\"hemingway\">Hemingway</a></li><li> <a data-preset=\"concentrate\">concentrate</a></li></ul> </div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a class=\"display-block toolbox m5\"> <i class=\"fas fa-expand-arrows-alt mr5\"></i>Resize </a> <div class=\"toolbox-sub bg-white box-shadow\"><div class=\"col-xs-6 mb5 pl3 pr3\"><label class=\"full-width display-block\">Width:</label><input type=\"number\" class=\"mb00\" id=\"resize-width\" name=\"resize_width\"></div><div class=\"col-xs-6 mb5 pl3 pr3\"><label class=\"full-width display-block\">Height:</label><input type=\"number\" class=\"mb00\" id=\"resize-height\" name=\"resize_height\"></div><div class=\"col-xs-12 col-sm-12 mt8 pl3 pr3\"><a class=\"btn btn-block btn-sm btn-filled mb8\" id=\"resize-save\">Resize</a></div></div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-crop\" class=\"display-block toolbox m5\"> <i class=\"fas fa-crop-alt mr5\"></i>Crop </a> </li><li class=\"list-style-none align-left display-table toolbox-li\" style=\"display:none\"> <a id=\"image-editor-crop-now\" class=\"bg-success display-block toolbox m5\"> <i class=\"fas fa-check mr5\"></i>Crop </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a id=\"image-editor-rotate\" class=\"display-block toolbox m5\"> <i class=\"fas fa-undo mr5\"></i>Rotate </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\" id=\"image-editor-rotate\"> <li> <a data-rotate=\"cw\">Clock wise</a></li><li> <a data-rotate=\"ccw\">Counter clock wise</a></li></ul></div></li></ul></div><div id=\"image-editor-canvas\"><div id=\"canvas-holder\" width=\"\"></div></div></div>';\n\n\n\n\t\tdocument.querySelector('body').appendChild($el);\n\n\n\n\t\t// bind a close modal editor event\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-close').addEventListener('click',function(e){\n\n\t\t\t\n\n\t\t\te.preventDefault();\n\n\t\t\tdocument.querySelector('#image-editor-modal').style.display = 'none';\n\t\t\tdocument.querySelector('#image-editor-modal').classList.remove('active');\n\n\t\t\tdocument.querySelector('#image-editor-modal canvas').style.display = 'none';\n\n\t\t\tdocument.querySelector('body').style.overflowY = 'auto';\n\n\t\t\t$global.reset();\n\n\t\t\tif( $on_close ){\n\n\t\t\t\t$on_close(document.querySelector('.image-editor.active'));\n\n\t\t\t}\n\n\t\t});\n\n\t\t// -- end close modal editor\n\n\t\t// when click save button\n\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-save').addEventListener('click',function(e){\n\n\t\t\te.preventDefault();\n\n\n\n\t\t\tlet $ref = document.querySelector('#image-editor-modal #canvas-holder canvas');\n\n\n\n\t\t\tlet $x = ( $ref.width- $global.getActiveEditorOptions().$cropboxsave_width ) / 2;\n\n\t\t\tlet $y = ( $ref.height - $global.getActiveEditorOptions().$cropboxsave_height ) / 2;\n\n\n\n\t\t\tCaman('#modal-canvas',function () {\n\n\t\t\t    // width, height, x, y\n\n\t\t\t    this.render(function(){\n\n\t\t\t    \t\n\n\t\t\t    \tvar c_w = document.querySelector('#image-editor-modal canvas').offsetWidth;\n\n\t\t\t    \tvar c_h = document.querySelector('#image-editor-modal canvas').offsetHeight;\n\n\n\n\t\t\t    \tdocument.querySelector('#image-editor-modal').style.display = 'none';\n\t\t\t    \tdocument.querySelector('#image-editor-modal').classList.remove('active');\n\n\t\t\t    \tif( document.querySelector('.image-editor.active canvas') != null ){\n\n\t\t\t    \t\tdocument.querySelector('.image-editor.active canvas').remove();\n\n\t\t\t    \t}\n\n\t\t\t    \tif( document.querySelector('.image-editor.active img') != null ){\n\n\t\t\t    \t\tdocument.querySelector('.image-editor.active img').remove();\n\n\t\t\t    \t}\n\n\t\t\t    \tvar el = document.createElement('canvas');\n\n\t\t\t    \tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild(el);\n\n\t\t\t    \tif( document.querySelector('.image-editor.active img') != null ){\n\n\t\t\t    \t\tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild(el);\n\n\t\t\t    \t}\n\n\t\t\t    \tvar destinationCanvas = document.querySelector('.image-editor.active canvas');\n\n\t\t\t    \tvar destCtx = destinationCanvas.getContext('2d');\n\n\t\t\t    \tdestCtx.canvas.width = c_w;\n\n\t\t\t    \tdestCtx.canvas.height = c_h;\n\n\t\t\t    \tdestCtx.drawImage(document.querySelector('#image-editor-modal canvas'), 0, 0);\n\n\t\t\t    \t// get the data base url\n\n\t\t\t    \tdocument.querySelector('.image-editor.active input.image_src').value = document.querySelector('.image-editor.active canvas').toDataURL();\n\n\t\t\t    \tif( $imgcache ){ // delete from web storage if option enabled\n\n\t\t\t\t\t\tvar _storage = $storage.getItem('imgeditorcachedb');\n\n\t\t\t\t\t\tif( _storage ){\n\t\t\t\t\t\t\t_storage = JSON.parse(_storage);\n\n\t\t\t\t\t\t\tvar _img = _storage.findIndex(function(i){\n\t\t\t\t\t\t\t\treturn i.index == $editor.getAttribute('data-index')\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tif( _img != -1 ){\n\t\t\t\t\t\t\t\t_storage[_img].dataurl = document.querySelector('.image-editor.active input.image_src').value;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t_storage.push({\n\t\t\t\t\t\t\t\t\tindex : document.querySelector('.image-editor.active').getAttribute('data-index'),\n\t\t\t\t\t\t\t\t\tdataurl : document.querySelector('.image-editor.active input.image_src').value,\n\t\t\t\t\t\t\t\t\tfiletype : document.querySelector('.image-editor.active input.filetype').value,\n\t\t\t\t\t\t\t\t\tfilename : document.querySelector('.image-editor.active input.filename').value\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\n\t\t\t\t\t\t}else{\n\n\t\t\t\t\t\t\tvar _storage = [];\n\n\t\t\t\t\t\t\t_storage.push({\n\t\t\t\t\t\t\t\tindex : document.querySelector('.image-editor.active').getAttribute('data-index'),\n\t\t\t\t\t\t\t\tdataurl : document.querySelector('.image-editor.active input.image_src').value,\n\t\t\t\t\t\t\t\tfiletype : document.querySelector('.image-editor.active input.filetype').value,\n\t\t\t\t\t\t\t\tfilename : document.querySelector('.image-editor.active input.filename').value\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t    });\n\n\t\t\t});\n\t\t\t\n\t\t\t// set body to overflow auto\n\t\t\tdocument.querySelector('body').style.overflowY = 'auto';\n\n\t\t\tif( $on_save ){\n\n\t\t\t\t$on_save(document.querySelector('.image-editor.active'));\n\n\t\t\t}\n\n\n\n\t\t});\n\n\t\t// -- end click save button\n\n\t\t// on crop\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').addEventListener('click',function(e){\n\n\n\t\t\tlet $el = document.createElement('div');\n\n\t\t\t$el.setAttribute('id','crop-box');\n\n\n\n\t\t\t$el.style.width = $cropbox_width+'px';\n\n\t\t\t$el.style.height = $cropbox_height+'px';\n\n\n\n\t\t\t$el.innerHTML = '<div class=\"resizer\" style=\"position:absolute;top:-2px;left:-2px;border-top: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;top:-2px;right:-2px;border-top: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;bottom:-2px;left:-2px;border-bottom: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;bottom:-2px;right:-2px;border-bottom: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div>';\n\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($el);\n\n\n\n\t\t\t$global.dragCropBox();\n\n\t\t\t$global.resizeCropBox();\n\n\n\n\t\t\tthis.closest('li').style.display = 'none';\n\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').closest('li').style.display = 'block';\n\n\t\t\t\n\n\t\t});\n\n\t\t// -- end on crop\n\n\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').addEventListener('click',function(e){\n\n\t\t\t$global.cropCanvas();\n\n\n\n\t\t\tthis.closest('li').style.display = 'none';\n\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').closest('li').style.display = 'block';\n\n\t\t});\n\n\t\t// Update the current slider value (each time you drag the slider handle)\n\n\t\tdocument.querySelectorAll('.filter-slider').forEach(function($el){\n\n\t\t\t$el.querySelector('.filter-range').textContent = $el.querySelector('.filter-range-input').value;\n\n\n\n\t\t\t$el.querySelector('.filter-range-input').addEventListener('input',function(){\n\n\t\t\t\tthis.closest('.filter-slider').querySelector('.filter-range').textContent = this.value;\n\n\t\t\t\t$global.applyFilter(this.getAttribute('data-filter'),this.value);\n\n\t\t\t});\n\n\t\t});\n\n\t\t// -- end update slider values\n\n\n\n\t\t// apply preset\n\n\t\tdocument.querySelectorAll('#image-editor-modal #image-editor-presets li a').forEach(function($el){\n\n\t\t\t$el.addEventListener('click',function(e){\n\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$global.applyPreset( $el.getAttribute('data-preset'));\n\n\t\t\t});\n\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\n\t\t\t\tel.style.display = 'none';\n\t\t\t});\n\n\t\t});\n\n\t\t// -- end apply preset\n\n\n\n\t\t// when rotate\n\n\t\tdocument.querySelectorAll('#image-editor-modal #image-editor-rotate li a').forEach(function($el){\n\n\t\t\t$el.addEventListener('click',function(e){\n\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$global.applyRotate( $el.getAttribute('data-rotate'));\n\n\t\t\t});\n\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\n\t\t\t\tel.style.display = 'none';\n\t\t\t});\n\n\t\t\t\n\n\t\t});\n\n\t\t// -- end rotate\n\n\t\t// reset\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-reset').addEventListener('click',function(e){\n\n\t\t\te.preventDefault();\n\n\n\n\t\t\t$global.reset();\n\n\t\t\tif( $on_reset ){\n\n\t\t\t\t$on_reset(document.querySelector('.image-editor.active'));\n\n\t\t\t}\n\n\t\t});\n\n\t\t// -- end reset\n\n\n\n\t\t// resize\n\n\t\tdocument.querySelector('#image-editor-modal #resize-save').addEventListener('click',function(e){\n\n\t\t\te.preventDefault();\n\n\n\n\t\t\tlet $w = this.closest('.toolbox-sub').querySelector('#resize-width').value;\n\n\t\t\tlet $h = this.closest('.toolbox-sub').querySelector('#resize-height').value;\n\n\t\t\t\n\n\t\t\t$global.applyResize($w,$h);\n\n\t\t});\n\n\t\t// -- end resize\n\n\t}\n\n\tthis.dragCropBox = function(){\n\n\t    let dragItem = document.querySelector(\"#image-editor-modal #crop-box\");\n\n\t    let container = document.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder');\n\n\n\n\t    let active = false;\n\n\t    let currentX;\n\n\t    let currentY;\n\n\t    let initialX;\n\n\t    let initialY;\n\n\t    let xOffset = 0;\n\n\t    let yOffset = 0;\n\n\n\n\t    container.addEventListener(\"touchstart\", dragStart, false);\n\n\t    container.addEventListener(\"touchend\", dragEnd, false);\n\n\t    container.addEventListener(\"touchmove\", drag, false);\n\n\n\n\t    container.addEventListener(\"mousedown\", dragStart, false);\n\n\t    container.addEventListener(\"mouseup\", dragEnd, false);\n\n\t    container.addEventListener(\"mousemove\", drag, false);\n\n\n\n\n\n\t    function dragStart(e) {\n\n\t      if (e.type === \"touchstart\") {\n\n\t        initialX = e.touches[0].clientX - xOffset;\n\n\t        initialY = e.touches[0].clientY - yOffset;\n\n\t      } else {\n\n\t        initialX = e.clientX - xOffset;\n\n\t        initialY = e.clientY - yOffset;\n\n\t      }\n\n\n\n\t      if (e.target === dragItem) {\n\n\t        active = true;\n\n\t      }\n\n\n\n\t    }\n\n\n\n\t    function dragEnd(e) {\n\n\t      initialX = currentX;\n\n\t      initialY = currentY;\n\n\n\n\t      active = false;\n\n\t    }\n\n\n\n\t    function drag(e) {\n\n\t      if (active) {\n\n\t      \n\n\t        e.preventDefault();\n\n\t      \n\n\t        if (e.type === \"touchmove\") {\n\n\t          currentX = e.touches[0].clientX - initialX;\n\n\t          currentY = e.touches[0].clientY - initialY;\n\n\t        } else {\n\n\t          currentX = e.clientX - initialX;\n\n\t          currentY = e.clientY - initialY;\n\n\t        }\n\n\n\n\t        xOffset = currentX;\n\n\t        yOffset = currentY;\n\n\n\n\t        setTranslate(currentX, currentY, dragItem);\n\n\t      }\n\n\t    }\n\n\n\n\t    function setTranslate(xPos, yPos, el) {\n\n\t      // el.style.transform = \"translate3d(\" + xPos + \"px, \" + yPos + \"px, 0)\";\n\n\t      el.style.top = yPos+'px';\n\n\t      el.style.left = xPos+'px';\n\n\t    }\n\n\t}\n\n\t// check if mobile, return false otherwise\n\n\tthis.checkIfMobile = function(){\n\n\t\t// device detection\n\n\t\tif(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) \n\n\t\t    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(navigator.userAgent.substr(0,4))) { \n\n\t\t    return true;\n\n\t\t}else{\n\n\t\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\t// -- end check if mobile\n\n\n\n\t// validate filesize\n\n\tthis.ValidateSize = function(file) {\n\n        var FileSize = file.files[0].size / 1024 / 1024; // in MB\n\n        if (FileSize > 2) {\n\n            alert('File size exceeds 2 MB');\n\n        } else {\n\n        \treturn true;\n\n        }\n\n    }\n\n\t// -- end validate filesize\n\n\t// resize crop box event\n\tthis.getActiveEditorOptions = function(){\n\n\t\tlet _data = JSON.parse(document.querySelector('body').getAttribute('data-imgeditor') );\n\n\t\treturn _data[_data.findIndex(function(i){\n\t\t\treturn i.$el == '#'+document.querySelector('.image-editor.active').getAttribute('id');\n\t\t})];\n\t};\n\n\tthis.resizeCropBox = function() {\n\n\t\t\n\t \tlet resizeHandle = document.querySelectorAll('#image-editor-modal #image-editor-canvas #crop-box .resizer');\n\n\t\tlet p = document.querySelector('#image-editor-modal #image-editor-canvas #crop-box');\n\n\t\tresizeHandle.forEach(function(el){\n\n\t\t\tif( $global.checkIfMobile() ){\n\n\t\t\t\tel.addEventListener(\"touchstart\", initDrag, false);\n\n\t\t\t}else{\n\n\t\t\t\tel.addEventListener('mousedown', initDrag, false);\n\n\t\t\t}\n\n\t\t});\n\n\n\n\t\tvar startX, startY, startWidth, startHeight;\n\n\n\n\t\tfunction initDrag(e) {\n\t\t\t\n\t\t\tif( !$global.getActiveEditorOptions().$cropbox_resize ){\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t   \tif( $global.checkIfMobile() ){\n\n\t\t   \t\tstartX = e.touches[0].clientX;\n\n\t\t   \t\tstartY = e.touches[0].clientY;\n\n\t\t   \t}else{\n\n\t\t   \t\tstartX = e.clientX;\n\n\t\t   \t\tstartY = e.clientY;\n\n\t\t   \t}\n\n\t\t   startWidth = parseInt(document.defaultView.getComputedStyle(p).width, 10);\n\n\t\t   startHeight = parseInt(document.defaultView.getComputedStyle(p).height, 10);\n\n\n\n\t\t   if( $global.checkIfMobile() ){\n\n\t\t   \tdocument.documentElement.addEventListener(\"touchmove\",doDrag, false);\n\n\t   \t   document.documentElement.addEventListener(\"touchend\", stopDrag, false);\n\n\t\t   }else{\n\n\t\t   \tdocument.documentElement.addEventListener('mousemove', doDrag, false);\n\n\t\t   document.documentElement.addEventListener('mouseup', stopDrag, false);\n\n\t\t   }\n\n\t\t   \n\n\t\t   document.documentElement.addEventListener(\"touchmove\",doDrag, false);\n\n\t   \t   document.documentElement.addEventListener(\"touchend\", stopDrag, false);\n\n\t\t}\n\n\n\n\t\tfunction doDrag(e) {\n\n\t\t\tif( $global.checkIfMobile() ){\n\n\n\t\t\t\tif( ( (startWidth + e.touches[0].clientX - startX) < $global.getActiveEditorOptions().$cropbox_resize_maxwidth ) && ( (startWidth + e.touches[0].clientX - startX) > $global.getActiveEditorOptions().$cropbox_resize_minwidth) ){\n\n\t\t\t\t\tp.style.width = (startWidth + e.touches[0].clientX - startX) + 'px';\n\n\t\t\t   \t}\n\n\t\t\t   \tif( ( (startHeight + e.touches[0].clientY - startY) < $global.getActiveEditorOptions().$cropbox_resize_maxheight ) && ( (startHeight + e.touches[0].clientY - startY) > $global.getActiveEditorOptions().$cropbox_resize_minheight) ){\n\n\t\t\t\t   \tp.style.height = (startHeight + e.touches[0].clientY - startY) + 'px';\n\n\t\t\t\t}\n\n\t\t\t}else{\t\t\t\t\n\n\t\t\t\tif( ( (startWidth + e.clientX - startX) < $global.getActiveEditorOptions().$cropbox_resize_maxwidth ) && ( (startWidth + e.clientX - startX) > $global.getActiveEditorOptions().$cropbox_resize_minwidth) ){\n\n\t\t\t\t\tp.style.width = (startWidth + e.clientX - startX) + 'px';\n\n\t\t\t   \t}\n\n\t\t\t   \tif( ( (startHeight + e.clientY - startY) < $global.getActiveEditorOptions().$cropbox_resize_maxheight ) && ( (startHeight + e.clientY - startY) > $global.getActiveEditorOptions().$cropbox_resize_minheight) ){\n\n\t\t\t\t   \tp.style.height = (startHeight + e.clientY - startY) + 'px';\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\n\n\t\tfunction stopDrag(e) {\n\n\t\t\tif( $global.checkIfMobile() ){\n\n\t\t\t\tdocument.documentElement.removeEventListener(\"touchmove\", doDrag, false);\n\n\t\t   \t   \tdocument.documentElement.removeEventListener(\"touchend\", stopDrag, false);\n\n\t\t\t}else{\n\n\t\t\t\tdocument.documentElement.removeEventListener('mousemove', doDrag, false);\n\n\t\t\t   \tdocument.documentElement.removeEventListener('mouseup', stopDrag, false);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\n\t// when click browse, display image\n\n\tthis.displayImage = function($el,$base64){\n\n\t\tvar $base64 = ( $base64 != 'undefined' ) ? $base64 : false;\n\t\tif( !$base64){\n\t\t\tif ( $el.files == 'undefined' && !$el.files[0] == 'undefined' ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\n\n\t\t// always remove existing canvas\n\n\t\tif( document.querySelector('.image-editor.active canvas') != null ){\n\n\t\t\tdocument.querySelector('.image-editor.active canvas').remove();\n\n\t\t}\n\n\t\tif( document.querySelector('.image-editor.active img') != null ){\n\n\t\t\tdocument.querySelector('.image-editor.active img').remove();\n\n\t\t}\n\n\n\n\t\t// append a default canvas\n\n\t\tlet $canvas = document.createElement('canvas');\n\n\t\t$canvas.style.display = 'none';\n\n\t\tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild($canvas);\n\n\t\t// -- end append default canvas\n\n\n\n    \tlet $ctx = document.querySelector('.image-editor.active canvas').getContext('2d');\n\n\t\tlet $img = new Image;\n\n\t\t$img.crossOrigin = 'anonymous';\n\n\n\n\n\t\t$img.onload = function() {\n\n\n\t\t\t$ctx.canvas.width = this.width;\n\n\t\t    $ctx.canvas.height = this.height;\n\n\t\t    $ctx.drawImage($img,0,0);\n\n\t\t    $editor.setAttribute('data-imgw',$img.width);\n\t\t    $editor.setAttribute('data-imgh',$img.height); \n\n\t\t\tif( !$base64){\n\n\t\t\t    let $x = ( this.width- $global.getActiveEditorOptions().$cropboxsave_width ) / 2;\n\t\t\t\tlet $y = ( this.height - $global.getActiveEditorOptions().$cropboxsave_height ) / 2;\n\n\t\t\t\tCaman(\".image-editor.active canvas\", function () {\n\n\t\t\t\t\t// width, height, x, y\n\t\t\t\t\tif( !$autocrop ){\n\t\t\t\t\t\tthis.crop($img.width, $img.height,0,0);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.crop($global.getActiveEditorOptions().$cropboxsave_width, $global.getActiveEditorOptions().$cropboxsave_height,$x,$y);\n\t\t\t\t\t}\n\n\t\t\t\t    this.render(function(){\n\n\t\t\t\t    \t// get the data base url\n\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.image_src').value = document.querySelector('.image-editor.active canvas').toDataURL();\n\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.filename').value = $el.files[0].name;\n\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.filetype').value = document.querySelector('.image-editor.active input.filename').value.split('.')[1];\n\n\t\t\t\t    });\n\n\t\t\t\t    if( $on_display ){\n\t\t\t\t\t\t$on_display(document.querySelector('.image-editor.active'));\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif( document.querySelector('#image-editor-modal') != null && $image_editor ){\n\n\t\t\t\tdocument.querySelector('.image-editor.active .image-editor-edit').style.display = 'flex';\n\n\t\t\t}else{\n\n\t\t\t\tdocument.querySelector('.image-editor.active .image-editor-edit').style.display = 'none';\n\n\t\t\t}\n\n\t\t\tdocument.querySelector('.image-editor.active .image-editor-delete').style.display = 'flex';\n\n\t\t\t$canvas.style.display = 'block';\n\n\n\t\t  }\n\n\t\t  \tif( !$base64){\n\t\t\t\t$img.src = URL.createObjectURL($el.files[0]);\n\t\t\t}else{\n\t\t\t\t$img.src = $base64;\n\t\t\t}\n\n\t}\n\n\t// -- end display image on modal editor\n\n\tthis.displayImageModal = function($el,$t){\t\t\n\n\t\t// always remove existing canvas\n\n\t\tif( document.querySelector('#image-editor-modal #image-editor-canvas canvas') != null ){\n\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas canvas').remove();\n\n\t\t}\n\n\t\t// append a default canvas\n\n\t\tlet $canvas = document.createElement('canvas');\n\n\t\t$canvas.setAttribute('id','modal-canvas');\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($canvas);\n\n\t\t// -- end append default canvas\n\n\n\n\t\t$global.cloneImg($el,$t);\n\n\n\n\t\tlet $ctx = document.querySelector('#image-editor-modal #image-editor-canvas canvas').getContext('2d');\n\n\t\tlet $img = new Image;\n\n\t\t$img.crossOrigin = 'anonymous';\n\n\n\n\t\tif( $t ){\n\n\t\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\n\n\t\t\t$img.src = document.querySelector('.image-editor.active input.image_src').value;\n\n\t\t}else{\n\n\t\t\tif ($el.files && $el.files[0]) {\n\n\n\n\t\t\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\n\n\t\t\t\t$img.src = URL.createObjectURL($el.files[0]);\n\n\n\n\t\t  \t}\n\n\t\t}\n\n\n\n\t\n\n\t}\n\n\n\n\tthis.cloneImg = function($el,$t){\n\n\t\tif( document.querySelector('#clone-img') != null ){\n\n\t\t\tdocument.querySelector('#clone-img').remove();\n\n\t\t}\n\n\t\tif( $t ){\n\n\t\t\tvar el = document.createElement('div');\n\n\t\t\tel.setAttribute('id','clone-img');\n\n\t\t\tel.innerHTML = '<img src=\"'+$el+'\">';\n\n\t\t\tif( document.querySelector('#image-editor-modal').classList.contains('active')){\n\n\t\t\t\tdocument.querySelector('body').style.overflowY = 'hidden';\n\n\t\t\t}\n\n\t\t\tdocument.querySelector('body').appendChild(el);\n\n\n\n\t\t}else{\n\n\t\t\tvar $reader = new FileReader();\n\n\n\t\t\t$reader.onload = function(e){\n\n\t\t\t\tvar el = document.createElement('div');\n\n\t\t\t\tel.setAttribute('id','clone-img');\n\n\t\t\t\tel.innerHTML = '<img src=\"'+e.target.result+'\">';\n\n\t\t\t\tif( document.querySelector('#image-editor-modal').classList.contains('active')){\n\t\t\t\t\tdocument.querySelector('body').style.overflowY = 'hidden';\n\t\t\t\t}\n\n\t\t\t\tdocument.querySelector('body').appendChild(el);\n\n\t\t\t}\n\n\t\t\t$reader.readAsDataURL($el.files[0]);\n\n\t\t}\n\n\t}\n\n\n\n\tthis.drawImageScaled = function(img, ctx) {\n\n\n\n\t\t   ctx.canvas.width = document.querySelector('#clone-img img').offsetWidth;\n\n\t\t   ctx.canvas.height = document.querySelector('#clone-img img').offsetHeight;\n\n\t\t   var canvas = ctx.canvas ;\n\n\t\t   var hRatio = canvas.width  / img.width;\n\n\t\t   var vRatio =  canvas.height / img.height;\n\n\t\t   var ratio  = Math.min ( hRatio, vRatio );\n\n\t\t   var centerShift_x = ( canvas.width - img.width*ratio ) / 2;\n\n\t\t   var centerShift_y = ( canvas.height - img.height*ratio ) / 2;  \n\n\t\t   ctx.clearRect(0,0,canvas.width, canvas.height);\n\n\t\t   ctx.drawImage(img, 0,0, img.width, img.height,centerShift_x,centerShift_y,img.width*ratio, img.height*ratio);\n\n\n\n\t\t   document.querySelector('#image-editor-modal canvas').style.display = 'block';\n\n\t}\n\n\n\n\t// reset editor\n\n\tthis.reset = function(){\n\n\n\n\t\tif( document.querySelector('#clone-img') != null ){\n\n\t\t\tdocument.querySelector('#clone-img').remove();\n\n\t\t}\n\n\n\n\t\tif( document.querySelector('#image-editor-modal #crop-box') != null ){\n\n\t\t\tdocument.querySelector('#image-editor-modal #crop-box').remove();\n\n\t\t}\n\n\n\n\t\tdocument.querySelectorAll('.filter-range-input').forEach(function($el){\n\n\t\t\t$el.value = 0;\n\n\t\t});\n\n\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').closest('li').style.display = 'none';\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').closest('li').style.display = 'block';\n\n\t\t$global.displayImageModal(document.querySelector('.image-editor.active input.file-browse'),false);\n\n\n\t}\n\n\t// -- end reset editor\n\n\n\n\t// resize\n\n\tthis.applyResize = function($w,$h){\n\n\t\tCaman(\"#image-editor-modal canvas\", function () {\n\n\t\t  this.resize({\n\n\t\t    width: $w,\n\n\t\t    height: $h\n\n\t\t  });\n\n\n\n\t\t  this.render();\n\n\t\t});\n\n\t}\n\n\t// -- end resize\n\n\n\n\t// filters\n\n\tthis.applyFilter = function($t,$v) {\n\n\t\tlet $type = $t.replace('filter-','');\n\n\t\tCaman(\"#image-editor-modal canvas\", function () {\n\n\t\t\tthis.revert(false);\n\n\t\t\tswitch($type){\n\n\t\t\t\tcase 'brightness':\n\n\t\t\t\t\tthis.brightness($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'contrast':\n\n\t\t\t\t\tthis.contrast($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'contrast':\n\n\t\t\t\t\tthis.saturation($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'vibrance':\n\n\t\t\t\t\tthis.contrast($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'exposure':\n\n\t\t\t\t\tthis.exposure($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'clip':\n\n\t\t\t\t\tthis.clip($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'clip':\n\n\t\t\t\t\tthis.clip($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'hue':\n\n\t\t\t\t\tthis.hue($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'sepia':\n\n\t\t\t\t\tthis.sepia($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'noise':\n\n\t\t\t\t\tthis.noise($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'sharpen':\n\n\t\t\t\t\tthis.vintage($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'stackBlur':\n\n\t\t\t\t\tthis.stackBlur($v).render();\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t});\n\n    }\n\n    // -- end filters\n\n    // presets\n\n    this.applyPreset = function($t) {\t\n\n\t\tCaman(\"#image-editor-modal canvas\", function () {\n\n\t\t\tthis.revert(false);\n\n\t\t\tswitch($t){\n\n\t\t\t\tcase 'vintage':\n\n\t\t\t\t\tthis.vintage().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'lomo':\n\n\t\t\t\t\tthis.lomo().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'clarity':\n\n\t\t\t\t\tthis.clarity().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'sinCity':\n\n\t\t\t\t\tthis.sinCity().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'sunrise':\n\n\t\t\t\t\tthis.sunrise().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'crossProcess':\n\n\t\t\t\t\tthis.crossProcess().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'orangePeel':\n\n\t\t\t\t\tthis.orangePeel().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'love':\n\n\t\t\t\t\tthis.love().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'grungy':\n\n\t\t\t\t\tthis.grungy().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'jarques':\n\n\t\t\t\t\tthis.jarques().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'pinhole':\n\n\t\t\t\t\tthis.pinhole().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'oldBoot':\n\n\t\t\t\t\tthis.oldBoot().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'glowingSun':\n\n\t\t\t\t\tthis.glowingSun().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'hazyDays':\n\n\t\t\t\t\tthis.hazyDays().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'herMajesty':\n\n\t\t\t\t\tthis.herMajesty().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'nostalgia':\n\n\t\t\t\t\tthis.nostalgia().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'hemingway':\n\n\t\t\t\t\tthis.hemingway().render();\n\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'hemingway':\n\n\t\t\t\t\tthis.hemingway().render();\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\n\t\t\t\tel.style.display = 'none';\n\t\t\t});\n\n\t\t});\n\n    }\n\n\n\n    // rotate func\n\n    this.applyRotate = function($t) {\n\n    \tCaman(\"#image-editor-modal canvas\", function () {\n\n\t    \tswitch($t){\n\n\t    \t\tcase 'cw':\n\n\t    \t\t\tthis.rotate(90).render();\n\n\t    \t\tbreak;\n\n\t    \t\tcase 'ccw':\n\n\t    \t\t\tthis.rotate(-90).render();\n\n\t    \t\tbreak;\n\n\t    \t}\n\n\t    \tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\n\t\t\t\tel.style.display = 'none';\n\t\t\t});\n\n\t    \t$global.redisplayImageModal(this.toBase64());\n\n\t    });\n\n\n    }\n\n    // -- end rotate func\n\n    // re render modal image\n    this.redisplayImageModal = function(t){\n    \tif( document.querySelector('#image-editor-modal #image-editor-canvas canvas') != null ){\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas canvas').remove();\n\t\t}\n\t\t// append a default canvas\n\n\t\tlet $canvas = document.createElement('canvas');\n\n\t\t$canvas.setAttribute('id','modal-canvas');\n\n\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($canvas);\n\n\t\t// -- end append default canvas\n\n\t\t$global.cloneImg(t,true);\n\n\n\t\tlet $ctx = document.querySelector('#image-editor-modal #image-editor-canvas canvas').getContext('2d');\n\n\t\tlet $img = new Image;\n\n\t\t$img.crossOrigin = 'anonymous';\n\n\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\n\t\t$img.src = t;\n    }\n\n\n\t// -- check if element is hidden, return true otherwise\n\n\tthis.isHidden = function(el) {\n\n\n\t    let style = window.getComputedStyle(el);\n\n\t    return ((style.display === 'none') || (style.visibility === 'hidden'));\n\n\t}\n\n\n\n\treturn this.init($options);\n}\n\n"]}