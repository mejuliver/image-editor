{"version":3,"sources":["src/index.js"],"names":["window","cnimage_editor","$options","$storage","localStorage","$editor","el","document","querySelector","$image_editor","image_editor","$browseFunct","browseFunct","$displayImageFunct","displayImageFunct","$editFunct","editFunct","$deleteFunct","deleteFunct","$saveFunct","saveFunct","$resetFunct","resetFunct","$closeFunct","closeFunct","$global","$editor_width","width","$editor_height","height","$cropbox_width","cropbox_width","$cropbox_height","cropbox_height","$cropbox_resize","cropbox_resize","$cropbox_resize_minwidth","minwidth","$cropbox_resize_minheight","minheight","$cropbox_resize_maxwidth","maxwidth","$cropbox_resize_maxheight","maxheight","$autocrop","autocrop","$cropboxsave_width","$cropboxsave_height","$imgcache","imgcache","console","log","setItem","_editordata","getAttribute","_editor","JSON","parse","push","$el","setAttribute","stringify","init","initModalEditor","style","classList","add","$default_canvas","$id","querySelectorAll","length","innerHTML","display","value","forEach","remove","displayImage","addEventListener","e","preventDefault","$active_editor","closest","click","displayImageModal","alert","_storage","getItem","_img","findIndex","i","index","splice","idxDot","lastIndexOf","extFile","substr","toLowerCase","ValidateSize","dataurl","filetype","filename","cropCanvas","Caman","el_width","offsetWidth","el_height","offsetHeight","el_top","offsetTop","el_left","offsetLeft","crop","render","createElement","appendChild","overflowY","reset","$ref","getActiveEditorOptions","c_w","c_h","destinationCanvas","destCtx","getContext","canvas","drawImage","toDataURL","dragCropBox","resizeCropBox","textContent","applyFilter","applyPreset","applyRotate","$w","$h","applyResize","dragItem","currentX","currentY","initialX","initialY","container","active","xOffset","yOffset","dragStart","type","touches","clientX","clientY","target","dragEnd","drag","setTranslate","xPos","yPos","top","left","checkIfMobile","test","navigator","userAgent","file","FileSize","files","size","_data","resizeHandle","startX","startY","startWidth","startHeight","p","initDrag","parseInt","defaultView","getComputedStyle","documentElement","doDrag","stopDrag","removeEventListener","$base64","$canvas","$ctx","$img","Image","crossOrigin","onload","$x","$y","name","split","src","URL","createObjectURL","$t","cloneImg","drawImageScaled","bind","$reader","FileReader","result","readAsDataURL","img","ctx","hRatio","vRatio","ratio","Math","min","centerShift_x","centerShift_y","clearRect","resize","$v","$type","replace","revert","brightness","contrast","saturation","exposure","clip","hue","sepia","noise","vintage","stackBlur","lomo","clarity","sinCity","sunrise","crossProcess","orangePeel","love","grungy","jarques","pinhole","oldBoot","glowingSun","hazyDays","herMajesty","nostalgia","hemingway","rotate","redisplayImageModal","toBase64","t","isHidden","visibility"],"mappings":";;;AACA,aAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,KAAA,EAAA,OAAA,eAAA,EAAA,EAAA,CAAA,MAAA,EAAA,YAAA,EAAA,cAAA,EAAA,UAAA,IAAA,EAAA,GAAA,EAAA,EAAA,SAAA,EAAA,GAAA,OAAA,EAAA,mBAAA,QAAA,iBAAA,OAAA,SAAA,SAAA,GAAA,cAAA,GAAA,SAAA,GAAA,OAAA,GAAA,mBAAA,QAAA,EAAA,cAAA,QAAA,IAAA,OAAA,UAAA,gBAAA,IAAA,GAAA,SAAA,EAAA,GAAA,MAAA,IAAA,MAAA,IAAA,EAAA,kBADA,QAAA,gBACAA,OAAOC,eAAiB,SAASC,GAG1BC,IAAAA,EAAWH,OAAOI,aAElBC,OAA+B,IAAZH,QAAiD,IAAfA,EAASI,IAAsBC,SAASC,cAAcN,EAASI,IAEpHG,OAAqC,IAAZP,QAA2D,IAAzBA,EAASQ,cAAgCR,EAASQ,aAE7GC,OAAoC,IAAZT,QAA0D,IAAxBA,EAASU,aAA+BV,EAASU,YAE3GC,OAA0C,IAAZX,QAAgE,IAA9BA,EAASY,mBAAqCZ,EAASY,kBAEvHC,OAAkC,IAAZb,QAAwD,IAAtBA,EAASc,WAA6Bd,EAASc,UAEvGC,OAAoC,IAAZf,QAA0D,IAAxBA,EAASgB,aAA+BhB,EAASgB,YAE3GC,OAAkC,IAAZjB,QAAwD,IAAtBA,EAASkB,WAA6BlB,EAASkB,UAEvGC,OAAmC,IAAZnB,QAAyD,IAAvBA,EAASoB,YAA8BpB,EAASoB,WAEzGC,OAAmC,IAAZrB,QAAyD,IAAvBA,EAASsB,YAA8BtB,EAASsB,WAEzGC,EAAU,KAEVC,OAAqC,IAAZxB,QAAoD,IAAlBA,EAASyB,MAAyBzB,EAASyB,MAAQ,IAE9GC,OAAsC,IAAZ1B,QAAqD,IAAnBA,EAAS2B,OAA0B3B,EAAS2B,OAAS,IAEjHC,OAAsC,IAAZ5B,QAA4D,IAA1BA,EAAS6B,cAAiC7B,EAAS6B,cAAgB,IAC/HC,OAAuC,IAAZ9B,QAA6D,IAA3BA,EAAS+B,eAAkC/B,EAAS+B,eAAiB,IAElIC,OAAuC,IAAZhC,QAA6D,IAA3BA,EAASiC,gBAAkCjC,EAASiC,eAEjHC,OAAgD,IAAZlC,GAA2BgC,GAAqD,UAAlC,EAAOhC,EAASiC,sBAAyE,IAApCjC,EAASiC,eAAeE,SAA4BnC,EAASiC,eAAeE,SAAW,GAC9NC,OAAiD,IAAZpC,GAA2BgC,GAAqD,UAAlC,EAAOhC,EAASiC,sBAA0E,IAArCjC,EAASiC,eAAeI,UAA6BrC,EAASiC,eAAeI,UAAY,GACjOC,OAAgD,IAAZtC,GAA2BgC,GAAqD,UAAlC,EAAOhC,EAASiC,sBAAyE,IAApCjC,EAASiC,eAAeM,SAA4BvC,EAASiC,eAAeM,SAAW,IAC9NC,OAAiD,IAAZxC,GAA2BgC,GAAqD,UAAlC,EAAOhC,EAASiC,sBAA0E,IAArCjC,EAASiC,eAAeQ,UAA6BzC,EAASiC,eAAeQ,UAAY,IAEjOC,OAAiC,IAAZ1C,GAAuD,UAA5B,EAAOA,EAAS2C,WAAyB3C,EAAS2C,SAElGC,EAAuBF,GAAyC,UAA5B,EAAO1C,EAAS2C,gBAA0D,IAA3B3C,EAAS2C,SAASlB,MAAyBzB,EAAS2C,SAASlB,MAAQ,GACxJoB,EAAwBH,GAAyC,UAA5B,EAAO1C,EAAS2C,gBAA2D,IAA5B3C,EAAS2C,SAAShB,OAA0B3B,EAAS2C,SAAShB,OAAS,GAE3JmB,OAAiC,IAAZ9C,QAAuD,IAArBA,EAAS+C,UAA4B/C,EAAS+C,SAEvGD,GAAyB,aAAZ7C,IAChB+C,QAAQC,IAAI,kEACA,EAAA,aAAZH,GAAY,IAGRA,GAAa7C,GACjBA,EAASiD,QAAQ,mBAAmB,IAK9B,GAAC/C,EAAD,CAKAgD,IAGU,EA6BZ,EAhCEA,EAAc9C,SAASC,cAAc,QAAQ8C,aAAa,kBAChEC,EAAU,GAEPF,GAAAA,GACHE,EAAUC,KAAKC,MAAMJ,IACbK,MAsBcZ,EAtBtB,EAAA,CACCa,IAAMzD,EAASI,GACfG,cAAgBA,EAChBE,aAAeA,EACfE,mBAAqBA,EACrBE,WAAaA,EACbE,aAAeA,EACfE,WAAaA,EACbE,YAAcA,EACdE,YAAcA,EACdG,cAAgBA,EAChBE,eAAiBA,EACjBE,eAAiBA,EACjBE,gBAAkBA,EAClBc,mBAAqBA,EACrBC,oBAAsBA,EACtBb,gBAAkBA,EAClBE,yBAA2BA,EAC3BE,0BAA4BA,EAC5BE,yBAA2BA,EAC3BE,0BAA4BA,EAC5BE,UAAYA,GACSE,qBAAAA,GACCC,EAAAA,EAAAA,sBAAAA,GACVC,EAAAA,EAAAA,YAAAA,GACC9C,EAAAA,EAAAA,aAAAA,GAzBd,SA4BAqD,EAAU,EAAA,EAAA,CACTI,IAAMzD,EAASI,GACfD,QAAUA,EACVI,cAAgBA,EAChBE,aAAeA,EACfE,mBAAqBA,EACrBE,WAAaA,EACbE,aAAeA,EACfE,WAAaA,EACbE,YAAcA,EACdE,YAAcA,EACdG,cAAgBA,EAChBE,eAAiBA,EACjBE,eAAiBA,EACjBE,gBAAkBA,EAClBc,mBAAqBA,EACrBC,oBAAsBA,EACtBb,gBAAkBA,EAClBE,yBAA2BA,EAC3BE,0BAA4BA,EAC5BE,yBAA2BA,EAC3BE,0BAA4BA,EAC5BE,UAAYA,GACSE,EAAAA,EAAAA,qBAAAA,GACCC,EAAAA,EAAAA,sBAAAA,GACVC,EAAAA,EAAAA,YAAAA,GACC9C,EAAAA,EAAAA,aAAAA,GA1Bd,IAomDM,OAtkDPK,SAASC,cAAc,QAAQoD,aAAa,iBAAiBJ,KAAKK,UAAUN,IAGvEO,KAAAA,KAAO,WAE0C,MAAjDvD,SAASC,cAAc,wBAAkCC,GACvDsD,KAAAA,kBAIN1D,EAAQ2D,MAAMrC,MAAQD,EAAc,KACpCrB,EAAQ2D,MAAMnC,OAASD,EAAe,KAItCvB,EAAQ4D,UAAUC,IAAI,gBAGlBC,IAEAC,EAAO7D,SAAS8D,iBAAiB,iBAAiBC,OAAQ,EAoO1DtB,GAlOJ3C,EAAQuD,aAAa,aAAaQ,GAEa,MAA3C/D,EAAQG,cAAc,mBAAwE,MAA3CH,EAAQG,cAAc,mBAAyE,MAA5CH,EAAQG,cAAc,qBAE/HH,EAAQkE,UAAY,oCAAoCH,EAAI,kEAAkEA,EAAI,kEAAkEA,EAAI,siBAIzM/D,EAAQG,cAAc,wBAAwBwD,MAAMQ,QAAU,OAEf,IAA3CnE,EAAQG,cAAc,mBAA4E,IAAjDH,EAAQG,cAAc,kBAAkBiE,OAAiE,IAAlDpE,EAAQG,cAAc,mBAAmBiE,OAEpJpE,EAAQG,cAAc,sBAAsBwD,MAAMQ,QAAU,OAC5DnE,EAAQG,cAAc,wBAAwBwD,MAAMQ,QAAU,OAE9DjE,SAAS8D,iBAAiB,iBAAiBK,QAAQ,SAASpE,GAC3DA,EAAG2D,UAAUU,OAAO,YAErBtE,EAAQ4D,UAAUC,IAAI,UAEjBU,KAAAA,cAAa,EAAOvE,EAAQG,cAAc,mBAAmBiE,SAGlEpE,EAAQG,cAAc,sBAAsBwD,MAAMQ,QAAU,OAC5DnE,EAAQG,cAAc,wBAAwBwD,MAAMQ,QAAU,QAK/DnE,EAAQG,cAAc,wBAAwBqE,iBAAiB,QAAQ,SAASC,GAE/EA,EAAEC,iBAGEC,IAAAA,EAAiBzE,SAASC,cAAc,wBAEtB,MAAlBwE,GACHA,EAAef,UAAUU,OAAO,UAK5BM,KAAAA,QAAQ,iBAAiBhB,UAAUC,IAAI,UAE5C7D,EAAQG,cAAc,qBAAqB0E,QAIvCvE,GACHX,OAAOW,OAYTN,EAAQG,cAAc,sBAAsBqE,iBAAiB,QAAQ,SAASC,GAKzEvE,GAHJuE,EAAEC,iBAGmD,MAAjDxE,SAASC,cAAc,wBAAkCC,EAAe,CAEvEuE,IAAAA,EAAiBzE,SAASC,cAAc,wBAEtB,MAAlBwE,GAEHA,EAAef,UAAUU,OAAO,UAK5BM,KAAAA,QAAQ,iBAAiBhB,UAAUC,IAAI,UAE5C3D,SAASC,cAAc,uBAAuBwD,MAAMQ,QAAU,QAE1D/D,EAEHgB,EAAQ0D,kBAAkB5E,SAASC,cAAc,wCAAwCiE,OAAM,GAI/FW,MAAM,0BAMPA,MAAM,qBAQHrE,GAEHf,OAAOe,GAAYR,SAASC,cAAc,2BAc5CH,EAAQG,cAAc,wBAAwBqE,iBAAiB,QAAQ,SAASC,GAE/EA,EAAEC,iBAGEC,IAAAA,EAAiBzE,SAASC,cAAc,wBAyCxCwC,GAtCkB,MAAlBgC,GACHA,EAAef,UAAUU,OAAO,UAK5BM,KAAAA,QAAQ,iBAAiBhB,UAAUC,IAAI,UAIiB,MAAzD,KAAKe,QAAQ,iBAAiBzE,cAAc,WAE1CyE,KAAAA,QAAQ,iBAAiBzE,cAAc,UAAUmE,SAIG,MAAtD,KAAKM,QAAQ,iBAAiBzE,cAAc,QAE1CyE,KAAAA,QAAQ,iBAAiBzE,cAAc,OAAOmE,SAM/CX,KAAAA,MAAMQ,QAAU,OAEhBS,KAAAA,QAAQ,iBAAiBzE,cAAc,sBAAsBwD,MAAMQ,QAAU,OAE7ES,KAAAA,QAAQ,iBAAiBzE,cAAc,qBAAqBiE,MAAQ,GAEpEQ,KAAAA,QAAQ,iBAAiBzE,cAAc,mBAAmBiE,MAAQ,GAElEQ,KAAAA,QAAQ,iBAAiBzE,cAAc,kBAAkBiE,MAAQ,GAEjEQ,KAAAA,QAAQ,iBAAiBzE,cAAc,kBAAkBiE,MAAQ,GAIlEzB,EAAW,CAEVqC,IAAAA,EAAWlF,EAASmF,QAAQ,oBAE5BD,GAAAA,EAAU,CAGTE,IAAAA,GAFJF,EAAW7B,KAAKC,MAAM4B,IAEFG,UAAU,SAASC,GAC/BA,OAAAA,EAAEC,OAASrF,EAAQiD,aAAa,iBAG3B,GAATiC,GACHF,EAASM,OAAOJ,EAAK,GAGtBpF,EAASiD,QAAQ,mBAAmBI,KAAKK,UAAUwB,KAMjDpE,GAEHjB,OAAOiB,GAAcV,SAASC,cAAc,2BAc9CH,EAAQG,cAAc,qBAAqBqE,iBAAiB,SAAS,WAGhEe,IAAAA,EAAS,KAAKnB,MAAMoB,YAAY,KAAO,EAEjCC,EAAU,KAAKrB,MAAMsB,OAAOH,EAAQ,KAAKnB,MAAMH,QAAQ0B,cAE9C,OAATF,GAA2B,QAATA,GAA4B,OAATA,EAEpCrE,EAAQwE,aAAa,OAExBxE,EAAQmD,aAAa,MAOnBQ,MAAM,8CAQbpC,GAAa7C,EAASmF,QAAQ,oBAAqB,CAElDD,IAAAA,EAAW7B,KAAKC,MAAOtD,EAASmF,QAAQ,qBAGxCC,EAAOF,EAASG,UAAU,SAASC,GAC/BA,OAAAA,EAAEC,OAASrF,EAAQiD,aAAa,gBAGxC/C,SAAS8D,iBAAiB,iBAAiBK,QAAQ,SAASpE,GAC3DA,EAAG2D,UAAUU,OAAO,YAGrBtE,EAAQ4D,UAAUC,IAAI,WAET,GAATqB,IACH9D,EAAQmD,cAAa,EAAMS,EAASE,GAAMW,SAC1C7F,EAAQG,cAAc,kBAAkBiE,MAAQY,EAASE,GAAMY,SAC/D9F,EAAQG,cAAc,kBAAkBiE,MAAQY,EAASE,GAAMa,SAC/D/F,EAAQG,cAAc,mBAAmBiE,MAAQY,EAASE,GAAMW,WAM9DG,KAAAA,WAAa,WAC8C,MAA3D9F,SAASC,cAAc,kCAG1B8F,MAAM,gBAAgB,WAIdC,IAAAA,EAAWhG,SAASC,cAAc,iCAAiCgG,YAEnEC,EAAYlG,SAASC,cAAc,iCAAiCkG,aAEpEC,EAASpG,SAASC,cAAc,iCAAiCoG,UAEjEC,EAAUtG,SAASC,cAAc,iCAAiCsG,WAEjEC,KAAAA,KAAKR,EAASE,EAAUI,EAAQF,GAEhCK,KAAAA,OAAO,WAEXzG,SAASC,cAAc,8BAA8BoD,aAAa,KAAK,gBAEvErD,SAASC,cAAc,iCAAiCmE,cAc1DZ,KAAAA,gBAAkB,WAElBJ,IAAAA,EAAMpD,SAAS0G,cAAc,OAIjCtD,EAAIC,aAAa,KAAK,sBAEtBD,EAAIY,UAAY,s1NAIhBhE,SAASC,cAAc,QAAQ0G,YAAYvD,GAM3CpD,SAASC,cAAc,iDAAiDqE,iBAAiB,QAAQ,SAASC,GAIzGA,EAAEC,iBAEFxE,SAASC,cAAc,uBAAuBwD,MAAMQ,QAAU,OAE9DjE,SAASC,cAAc,8BAA8BwD,MAAMQ,QAAU,OAErEjE,SAASC,cAAc,QAAQwD,MAAMmD,UAAY,OAEjD1F,EAAQ2F,QAEJ7F,GAEHvB,OAAOuB,OAWThB,SAASC,cAAc,gDAAgDqE,iBAAiB,QAAQ,SAASC,GAExGA,EAAEC,iBAIEsC,IAAAA,EAAO9G,SAASC,cAAc,6CAIvB6G,EAAK1F,MAAOF,EAAQ6F,yBAAyBxE,mBAE7CuE,EAAKxF,OAASJ,EAAQ6F,yBAAyBvE,oBAI1DuD,MAAM,gBAAgB,WAIbU,KAAAA,OAAO,WAIPO,IAAAA,EAAMhH,SAASC,cAAc,8BAA8BgG,YAE3DgB,EAAMjH,SAASC,cAAc,8BAA8BkG,aAI/DnG,SAASC,cAAc,uBAAuBwD,MAAMQ,QAAU,OAED,MAAzDjE,SAASC,cAAc,gCAE1BD,SAASC,cAAc,+BAA+BmE,SAIG,MAAtDpE,SAASC,cAAc,6BAE1BD,SAASC,cAAc,4BAA4BmE,SAIhDrE,IAAAA,EAAKC,SAAS0G,cAAc,UAEhC1G,SAASC,cAAc,wBAAwB0G,YAAY5G,GAED,MAAtDC,SAASC,cAAc,6BAE1BD,SAASC,cAAc,8CAA8C0G,YAAY5G,GAI9EmH,IAEAC,EAFoBnH,SAASC,cAAc,+BAEfmH,WAAW,MAYvC3E,GAVJ0E,EAAQE,OAAOjG,MAAQ4F,EAEvBG,EAAQE,OAAO/F,OAAS2F,EAExBE,EAAQG,UAAUtH,SAASC,cAAc,8BAA+B,EAAG,GAI3ED,SAASC,cAAc,wCAAwCiE,MAAQlE,SAASC,cAAc,+BAA+BsH,YAEzH9E,EAIFqC,GAFAA,EAAWlF,EAASmF,QAAQ,oBAElB,CAGTC,IAAAA,GAFJF,EAAW7B,KAAKC,MAAM4B,IAEFG,UAAU,SAASC,GAC/BA,OAAAA,EAAEC,OAASrF,EAAQiD,aAAa,iBAG3B,GAATiC,EACHF,EAASE,GAAMW,QAAU3F,SAASC,cAAc,wCAAwCiE,MAExFY,EAAS3B,KAAK,CACbgC,MAAQnF,SAASC,cAAc,wBAAwB8C,aAAa,cACpE4C,QAAU3F,SAASC,cAAc,wCAAwCiE,MACzE0B,SAAW5F,SAASC,cAAc,uCAAuCiE,MACzE2B,SAAW7F,SAASC,cAAc,uCAAuCiE,QAI3EtE,EAASiD,QAAQ,mBAAmBI,KAAKK,UAAUwB,QAC/C,CAEAA,IAAAA,GAAAA,EAAW,IAEN3B,KAAK,CACbgC,MAAQnF,SAASC,cAAc,wBAAwB8C,aAAa,cACpE4C,QAAU3F,SAASC,cAAc,wCAAwCiE,MACzE0B,SAAW5F,SAASC,cAAc,uCAAuCiE,MACzE2B,SAAW7F,SAASC,cAAc,uCAAuCiE,QAI1EtE,EAASiD,QAAQ,mBAAmBI,KAAKK,UAAUwB,SASvD9E,SAASC,cAAc,QAAQwD,MAAMmD,UAAY,OAE7ChG,GAEHnB,OAAOmB,GAAYZ,SAASC,cAAc,2BAY5CD,SAASC,cAAc,0CAA0CqE,iBAAiB,QAAQ,SAASC,GAG9FnB,IAAAA,EAAMpD,SAAS0G,cAAc,OAEjCtD,EAAIC,aAAa,KAAK,YAItBD,EAAIK,MAAMrC,MAAQG,EAAe,KAEjC6B,EAAIK,MAAMnC,OAASG,EAAgB,KAInC2B,EAAIY,UAAY,mrBAEhBhE,SAASC,cAAc,2DAA2D0G,YAAYvD,GAI9FlC,EAAQsG,cAERtG,EAAQuG,gBAIH/C,KAAAA,QAAQ,MAAMjB,MAAMQ,QAAU,OAEnCjE,SAASC,cAAc,8CAA8CyE,QAAQ,MAAMjB,MAAMQ,QAAU,UAUpGjE,SAASC,cAAc,8CAA8CqE,iBAAiB,QAAQ,SAASC,GAEtGrD,EAAQ4E,aAIHpB,KAAAA,QAAQ,MAAMjB,MAAMQ,QAAU,OAEnCjE,SAASC,cAAc,0CAA0CyE,QAAQ,MAAMjB,MAAMQ,QAAU,UAMhGjE,SAAS8D,iBAAiB,kBAAkBK,QAAQ,SAASf,GAE5DA,EAAInD,cAAc,iBAAiByH,YAActE,EAAInD,cAAc,uBAAuBiE,MAI1Fd,EAAInD,cAAc,uBAAuBqE,iBAAiB,QAAQ,WAE5DI,KAAAA,QAAQ,kBAAkBzE,cAAc,iBAAiByH,YAAc,KAAKxD,MAEjFhD,EAAQyG,YAAY,KAAK5E,aAAa,eAAe,KAAKmB,WAY5DlE,SAAS8D,iBAAiB,kDAAkDK,QAAQ,SAASf,GAE5FA,EAAIkB,iBAAiB,QAAQ,SAASC,GAErCA,EAAEC,iBAEFtD,EAAQ0G,YAAaxE,EAAIL,aAAa,kBAIvC/C,SAAS8D,iBAAiB,gBAAgBK,QAAQ,SAASpE,GAC1DA,EAAG0D,MAAMQ,QAAU,WAWrBjE,SAAS8D,iBAAiB,iDAAiDK,QAAQ,SAASf,GAE3FA,EAAIkB,iBAAiB,QAAQ,SAASC,GAErCA,EAAEC,iBAEFtD,EAAQ2G,YAAazE,EAAIL,aAAa,kBAIvC/C,SAAS8D,iBAAiB,gBAAgBK,QAAQ,SAASpE,GAC1DA,EAAG0D,MAAMQ,QAAU,WAWrBjE,SAASC,cAAc,iDAAiDqE,iBAAiB,QAAQ,SAASC,GAEzGA,EAAEC,iBAIFtD,EAAQ2F,QAEJ/F,GAEHrB,OAAOqB,GAAad,SAASC,cAAc,2BAY7CD,SAASC,cAAc,oCAAoCqE,iBAAiB,QAAQ,SAASC,GAE5FA,EAAEC,iBAIEsD,IAAAA,EAAK,KAAKpD,QAAQ,gBAAgBzE,cAAc,iBAAiBiE,MAEjE6D,EAAK,KAAKrD,QAAQ,gBAAgBzE,cAAc,kBAAkBiE,MAItEhD,EAAQ8G,YAAYF,EAAGC,MAQpBP,KAAAA,YAAc,WAEXS,IAQAC,EAEAC,EAEAC,EAEAC,EAdAJ,EAAWjI,SAASC,cAAc,iCAElCqI,EAAYtI,SAASC,cAAc,2DAInCsI,GAAS,EAUTC,EAAU,EAEVC,EAAU,EAsBLC,SAAAA,EAAUnE,GAEF,eAAXA,EAAEoE,MAEJP,EAAW7D,EAAEqE,QAAQ,GAAGC,QAAUL,EAElCH,EAAW9D,EAAEqE,QAAQ,GAAGE,QAAUL,IAIlCL,EAAW7D,EAAEsE,QAAUL,EAEvBH,EAAW9D,EAAEuE,QAAUL,GAMrBlE,EAAEwE,SAAWd,IAEfM,GAAS,GAUJS,SAAAA,EAAQzE,GAEf6D,EAAWF,EAEXG,EAAWF,EAIXI,GAAS,EAMFU,SAAAA,EAAK1E,GAwCL2E,IAAaC,EAAMC,EAAMrJ,EAtC5BwI,IAIFhE,EAAEC,iBAIa,cAAXD,EAAEoE,MAEJT,EAAW3D,EAAEqE,QAAQ,GAAGC,QAAUT,EAElCD,EAAW5D,EAAEqE,QAAQ,GAAGE,QAAUT,IAIlCH,EAAW3D,EAAEsE,QAAUT,EAEvBD,EAAW5D,EAAEuE,QAAUT,GAMzBG,EAAUN,EAEVO,EAAUN,EAYQgB,EARLjB,EAQWkB,EARDjB,GAQOpI,EARGkI,GAYhCxE,MAAM4F,IAAMD,EAAK,KAEpBrJ,EAAG0D,MAAM6F,KAAOH,EAAK,MA5GvBb,EAAUhE,iBAAiB,aAAcoE,GAAW,GAEpDJ,EAAUhE,iBAAiB,WAAY0E,GAAS,GAEhDV,EAAUhE,iBAAiB,YAAa2E,GAAM,GAI9CX,EAAUhE,iBAAiB,YAAaoE,GAAW,GAEnDJ,EAAUhE,iBAAiB,UAAW0E,GAAS,GAE/CV,EAAUhE,iBAAiB,YAAa2E,GAAM,IAwG7CM,KAAAA,cAAgB,WAIjB,SAAA,qUAAqUC,KAAKC,UAAUC,aAEhV,0kDAA0kDF,KAAKC,UAAUC,UAAUlE,OAAO,EAAE,MAkB/mDE,KAAAA,aAAe,SAASiE,GAIlBC,KAFWD,EAAKE,MAAM,GAAGC,KAAO,KAAO,KAE5B,GAMP,OAAA,EAJJjF,MAAM,2BAaZkC,KAAAA,uBAAyB,WAEzBgD,IAAAA,EAAQ9G,KAAKC,MAAMlD,SAASC,cAAc,QAAQ8C,aAAa,mBAE5DgH,OAAAA,EAAMA,EAAM9E,UAAU,SAASC,GAC9BA,OAAAA,EAAE9B,KAAO,IAAIpD,SAASC,cAAc,wBAAwB8C,aAAa,UAI7E0E,KAAAA,cAAgB,WAGfuC,IAoBDC,EAAQC,EAAQC,EAAYC,EApB3BJ,EAAehK,SAAS8D,iBAAiB,+DAE1CuG,EAAIrK,SAASC,cAAc,sDAsBtBqK,SAAAA,EAAS/F,GAEZrD,EAAQ6F,yBAAyBpF,kBAM/BT,EAAQqI,iBAEXU,EAAS1F,EAAEqE,QAAQ,GAAGC,QAEtBqB,EAAS3F,EAAEqE,QAAQ,GAAGE,UAItBmB,EAAS1F,EAAEsE,QAEXqB,EAAS3F,EAAEuE,SAIbqB,EAAaI,SAASvK,SAASwK,YAAYC,iBAAiBJ,GAAGjJ,MAAO,IAEtEgJ,EAAcG,SAASvK,SAASwK,YAAYC,iBAAiBJ,GAAG/I,OAAQ,IAIpEJ,EAAQqI,iBAEXvJ,SAAS0K,gBAAgBpG,iBAAiB,YAAYqG,GAAQ,GAE5D3K,SAAS0K,gBAAgBpG,iBAAiB,WAAYsG,GAAU,KAIlE5K,SAAS0K,gBAAgBpG,iBAAiB,YAAaqG,GAAQ,GAEhE3K,SAAS0K,gBAAgBpG,iBAAiB,UAAWsG,GAAU,IAM/D5K,SAAS0K,gBAAgBpG,iBAAiB,YAAYqG,GAAQ,GAE3D3K,SAAS0K,gBAAgBpG,iBAAiB,WAAYsG,GAAU,IAM7DD,SAAAA,EAAOpG,GAEXrD,EAAQqI,iBAGJY,EAAa5F,EAAEqE,QAAQ,GAAGC,QAAUoB,EAAU/I,EAAQ6F,yBAAyB9E,0BAAiCkI,EAAa5F,EAAEqE,QAAQ,GAAGC,QAAUoB,EAAU/I,EAAQ6F,yBAAyBlF,2BAErMwI,EAAE5G,MAAMrC,MAAS+I,EAAa5F,EAAEqE,QAAQ,GAAGC,QAAUoB,EAAU,MAItDG,EAAc7F,EAAEqE,QAAQ,GAAGE,QAAUoB,EAAUhJ,EAAQ6F,yBAAyB5E,2BAAkCiI,EAAc7F,EAAEqE,QAAQ,GAAGE,QAAUoB,EAAUhJ,EAAQ6F,yBAAyBhF,4BAExMsI,EAAE5G,MAAMnC,OAAU8I,EAAc7F,EAAEqE,QAAQ,GAAGE,QAAUoB,EAAU,QAM9DC,EAAa5F,EAAEsE,QAAUoB,EAAU/I,EAAQ6F,yBAAyB9E,0BAAiCkI,EAAa5F,EAAEsE,QAAUoB,EAAU/I,EAAQ6F,yBAAyBlF,2BAE/KwI,EAAE5G,MAAMrC,MAAS+I,EAAa5F,EAAEsE,QAAUoB,EAAU,MAI3CG,EAAc7F,EAAEuE,QAAUoB,EAAUhJ,EAAQ6F,yBAAyB5E,2BAAkCiI,EAAc7F,EAAEuE,QAAUoB,EAAUhJ,EAAQ6F,yBAAyBhF,4BAElLsI,EAAE5G,MAAMnC,OAAU8I,EAAc7F,EAAEuE,QAAUoB,EAAU,OAUnDU,SAAAA,EAASrG,GAEbrD,EAAQqI,iBAEXvJ,SAAS0K,gBAAgBG,oBAAoB,YAAaF,GAAQ,GAE5D3K,SAAS0K,gBAAgBG,oBAAoB,WAAYD,GAAU,KAIzE5K,SAAS0K,gBAAgBG,oBAAoB,YAAaF,GAAQ,GAE/D3K,SAAS0K,gBAAgBG,oBAAoB,UAAWD,GAAU,IAzHvEZ,EAAa7F,QAAQ,SAASpE,GAEzBmB,EAAQqI,gBAEXxJ,EAAGuE,iBAAiB,aAAcgG,GAAU,GAI5CvK,EAAGuE,iBAAiB,YAAagG,GAAU,MA4HzCjG,KAAAA,aAAe,SAASjB,EAAI0H,GAG5B,KADAA,EAAuB,aAAXA,GAA2BA,IAExB,aAAb1H,EAAIyG,OAAyC,cAAhBzG,EAAIyG,MAAM,GACpC,OAAA,EAQoD,MAAzD7J,SAASC,cAAc,gCAE1BD,SAASC,cAAc,+BAA+BmE,SAIG,MAAtDpE,SAASC,cAAc,6BAE1BD,SAASC,cAAc,4BAA4BmE,SAQhD2G,IAAAA,EAAU/K,SAAS0G,cAAc,UAErCqE,EAAQtH,MAAMQ,QAAU,OAExBjE,SAASC,cAAc,8CAA8C0G,YAAYoE,GAM1EC,IAAAA,EAAOhL,SAASC,cAAc,+BAA+BmH,WAAW,MAE3E6D,EAAO,IAAIC,MAEfD,EAAKE,YAAc,YAKnBF,EAAKG,OAAS,WAYT,GATJJ,EAAK3D,OAAOjG,MAAQ,KAAKA,MAEtB4J,EAAK3D,OAAO/F,OAAS,KAAKA,OAE1B0J,EAAK1D,UAAU2D,EAAK,EAAE,GAEtBnL,EAAQuD,aAAa,YAAY4H,EAAK7J,OACtCtB,EAAQuD,aAAa,YAAY4H,EAAK3J,SAEpCwJ,EAAQ,CAELO,IAAAA,GAAO,KAAKjK,MAAOF,EAAQ6F,yBAAyBxE,oBAAuB,EAC9E+I,GAAO,KAAKhK,OAASJ,EAAQ6F,yBAAyBvE,qBAAwB,EAElFuD,MAAM,8BAA+B,WAG/B1D,EAGCmE,KAAAA,KAAKtF,EAAQ6F,yBAAyBxE,mBAAoBrB,EAAQ6F,yBAAyBvE,oBAAoB6I,EAAGC,GAFlH9E,KAAAA,KAAKyE,EAAK7J,MAAO6J,EAAK3J,OAAO,EAAE,GAK7BmF,KAAAA,OAAO,WAIXzG,SAASC,cAAc,wCAAwCiE,MAAQlE,SAASC,cAAc,+BAA+BsH,YAE7HvH,SAASC,cAAc,uCAAuCiE,MAAQd,EAAIyG,MAAM,GAAG0B,KAEnFvL,SAASC,cAAc,uCAAuCiE,MAAQlE,SAASC,cAAc,uCAAuCiE,MAAMsH,MAAM,KAAK,KAIlJlL,GACNb,OAAOa,GAAoBN,SAASC,cAAc,2BAMA,MAAjDD,SAASC,cAAc,wBAAkCC,EAE5DF,SAASC,cAAc,2CAA2CwD,MAAMQ,QAAU,OAIlFjE,SAASC,cAAc,2CAA2CwD,MAAMQ,QAAU,OAInFjE,SAASC,cAAc,6CAA6CwD,MAAMQ,QAAU,OAEpF8G,EAAQtH,MAAMQ,QAAU,SAQvBgH,EAAKQ,IAHCX,GACKY,IAAIC,gBAAgBvI,EAAIyG,MAAM,KASvCjF,KAAAA,kBAAoB,SAASxB,EAAIwI,GAI4C,MAA7E5L,SAASC,cAAc,oDAE1BD,SAASC,cAAc,mDAAmDmE,SAMvE2G,IAAAA,EAAU/K,SAAS0G,cAAc,UAErCqE,EAAQ1H,aAAa,KAAK,gBAE1BrD,SAASC,cAAc,2DAA2D0G,YAAYoE,GAM9F7J,EAAQ2K,SAASzI,EAAIwI,GAIjBZ,IAAAA,EAAOhL,SAASC,cAAc,mDAAmDmH,WAAW,MAE5F6D,EAAO,IAAIC,MAEfD,EAAKE,YAAc,YAIfS,GAEHX,EAAKG,OAASlK,EAAQ4K,gBAAgBC,KAAK,KAAMd,EAAMD,GAEvDC,EAAKQ,IAAMzL,SAASC,cAAc,wCAAwCiE,OAItEd,EAAIyG,OAASzG,EAAIyG,MAAM,KAI1BoB,EAAKG,OAASlK,EAAQ4K,gBAAgBC,KAAK,KAAMd,EAAMD,GAEvDC,EAAKQ,IAAMC,IAAIC,gBAAgBvI,EAAIyG,MAAM,MAgBvCgC,KAAAA,SAAW,SAASzI,EAAIwI,GAQxBA,GANwC,MAAxC5L,SAASC,cAAc,eAE1BD,SAASC,cAAc,cAAcmE,SAIlCwH,EAAI,CAEH7L,IAAAA,EAAKC,SAAS0G,cAAc,OAEhC3G,EAAGsD,aAAa,KAAK,aAErBtD,EAAGiE,UAAY,aAAaZ,EAAI,KAEhCpD,SAASC,cAAc,QAAQwD,MAAMmD,UAAY,SAEjD5G,SAASC,cAAc,QAAQ0G,YAAY5G,OAIvC,CAEAiM,IAAAA,EAAU,IAAIC,WAGlBD,EAAQZ,OAAS,SAAS7G,GAErBxE,IAAAA,EAAKC,SAAS0G,cAAc,OAEhC3G,EAAGsD,aAAa,KAAK,aAErBtD,EAAGiE,UAAY,aAAaO,EAAEwE,OAAOmD,OAAO,KAE5ClM,SAASC,cAAc,QAAQwD,MAAMmD,UAAY,SAEjD5G,SAASC,cAAc,QAAQ0G,YAAY5G,IAI5CiM,EAAQG,cAAc/I,EAAIyG,MAAM,MAQ7BiC,KAAAA,gBAAkB,SAASM,EAAKC,GAIjCA,EAAIhF,OAAOjG,MAAQpB,SAASC,cAAc,kBAAkBgG,YAE5DoG,EAAIhF,OAAO/F,OAAStB,SAASC,cAAc,kBAAkBkG,aAEzDkB,IAAAA,EAASgF,EAAIhF,OAEbiF,EAASjF,EAAOjG,MAASgL,EAAIhL,MAE7BmL,EAAUlF,EAAO/F,OAAS8K,EAAI9K,OAE9BkL,EAASC,KAAKC,IAAMJ,EAAQC,GAE5BI,GAAkBtF,EAAOjG,MAAQgL,EAAIhL,MAAMoL,GAAU,EAErDI,GAAkBvF,EAAO/F,OAAS8K,EAAI9K,OAAOkL,GAAU,EAE3DH,EAAIQ,UAAU,EAAE,EAAExF,EAAOjG,MAAOiG,EAAO/F,QAEvC+K,EAAI/E,UAAU8E,EAAK,EAAE,EAAGA,EAAIhL,MAAOgL,EAAI9K,OAAOqL,EAAcC,EAAcR,EAAIhL,MAAMoL,EAAOJ,EAAI9K,OAAOkL,GAItGxM,SAASC,cAAc,8BAA8BwD,MAAMQ,QAAU,SAQpE4C,KAAAA,MAAQ,WAIgC,MAAxC7G,SAASC,cAAc,eAE1BD,SAASC,cAAc,cAAcmE,SAMyB,MAA3DpE,SAASC,cAAc,kCAE1BD,SAASC,cAAc,iCAAiCmE,SAMzDpE,SAAS8D,iBAAiB,uBAAuBK,QAAQ,SAASf,GAEjEA,EAAIc,MAAQ,IAMblE,SAASC,cAAc,8CAA8CyE,QAAQ,MAAMjB,MAAMQ,QAAU,OAEnGjE,SAASC,cAAc,0CAA0CyE,QAAQ,MAAMjB,MAAMQ,QAAU,QAE/F/C,EAAQ0D,kBAAkB5E,SAASC,cAAc,2CAA0C,IAWvF+H,KAAAA,YAAc,SAASF,EAAGC,GAE9BhC,MAAM,6BAA8B,WAE7B+G,KAAAA,OAAO,CAEV1L,MAAO0G,EAEPxG,OAAQyG,IAMLtB,KAAAA,YAYHkB,KAAAA,YAAc,SAASiE,EAAGmB,GAE1BC,IAAAA,EAAQpB,EAAGqB,QAAQ,UAAU,IAEjClH,MAAM,6BAA8B,WAI5BiH,OAFFE,KAAAA,QAAO,GAELF,GAED,IAAA,aAECG,KAAAA,WAAWJ,GAAItG,SAErB,MAEK,IAAA,WAEC2G,KAAAA,SAASL,GAAItG,SAEnB,MAEK,IAAA,WAEC4G,KAAAA,WAAWN,GAAItG,SAErB,MAEK,IAAA,WAEC2G,KAAAA,SAASL,GAAItG,SAEnB,MAEK,IAAA,WAEC6G,KAAAA,SAASP,GAAItG,SAEnB,MAEK,IAAA,OAMA,IAAA,OAEC8G,KAAAA,KAAKR,GAAItG,SAEf,MAEK,IAAA,MAEC+G,KAAAA,IAAIT,GAAItG,SAEd,MAEK,IAAA,QAECgH,KAAAA,MAAMV,GAAItG,SAEhB,MAEK,IAAA,QAECiH,KAAAA,MAAMX,GAAItG,SAEhB,MAEK,IAAA,UAECkH,KAAAA,QAAQZ,GAAItG,SAElB,MAEK,IAAA,YAECmH,KAAAA,UAAUb,GAAItG,aAcfmB,KAAAA,YAAc,SAASgE,GAE9B7F,MAAM,6BAA8B,WAI5B6F,OAFFsB,KAAAA,QAAO,GAELtB,GAED,IAAA,UAEC+B,KAAAA,UAAUlH,SAEhB,MAEK,IAAA,OAECoH,KAAAA,OAAOpH,SAEb,MAEK,IAAA,UAECqH,KAAAA,UAAUrH,SAEhB,MAEK,IAAA,UAECsH,KAAAA,UAAUtH,SAEhB,MAEK,IAAA,UAECuH,KAAAA,UAAUvH,SAEhB,MAEK,IAAA,eAECwH,KAAAA,eAAexH,SAErB,MAEK,IAAA,aAECyH,KAAAA,aAAazH,SAEnB,MAEK,IAAA,OAEC0H,KAAAA,OAAO1H,SAEb,MAEK,IAAA,SAEC2H,KAAAA,SAAS3H,SAEf,MAEK,IAAA,UAEC4H,KAAAA,UAAU5H,SAEhB,MAEK,IAAA,UAEC6H,KAAAA,UAAU7H,SAEhB,MAEK,IAAA,UAEC8H,KAAAA,UAAU9H,SAEhB,MAEK,IAAA,aAEC+H,KAAAA,aAAa/H,SAEnB,MAEK,IAAA,WAECgI,KAAAA,WAAWhI,SAEjB,MAEK,IAAA,aAECiI,KAAAA,aAAajI,SAEnB,MAEK,IAAA,YAECkI,KAAAA,YAAYlI,SAElB,MAEK,IAAA,YAMA,IAAA,YAECmI,KAAAA,YAAYnI,SAKnBzG,SAAS8D,iBAAiB,gBAAgBK,QAAQ,SAASpE,GAC1DA,EAAG0D,MAAMQ,QAAU,YAWd4D,KAAAA,YAAc,SAAS+D,GAE3B7F,MAAM,6BAA8B,WAE5B6F,OAAAA,GAED,IAAA,KAECiD,KAAAA,OAAO,IAAIpI,SAEjB,MAEK,IAAA,MAECoI,KAAAA,QAAQ,IAAIpI,SAMnBzG,SAAS8D,iBAAiB,gBAAgBK,QAAQ,SAASpE,GAC7DA,EAAG0D,MAAMQ,QAAU,SAGjB/C,EAAQ4N,oBAAoB,KAAKC,eAU9BD,KAAAA,oBAAsB,SAASE,GAC8C,MAA7EhP,SAASC,cAAc,oDAC7BD,SAASC,cAAc,mDAAmDmE,SAIvE2G,IAAAA,EAAU/K,SAAS0G,cAAc,UAErCqE,EAAQ1H,aAAa,KAAK,gBAE1BrD,SAASC,cAAc,2DAA2D0G,YAAYoE,GAI9F7J,EAAQ2K,SAASmD,GAAE,GAGfhE,IAAAA,EAAOhL,SAASC,cAAc,mDAAmDmH,WAAW,MAE5F6D,EAAO,IAAIC,MAEfD,EAAKE,YAAc,YAEnBF,EAAKG,OAASlK,EAAQ4K,gBAAgBC,KAAK,KAAMd,EAAMD,GACvDC,EAAKQ,IAAMuD,GAMPC,KAAAA,SAAW,SAASlP,GAGjB0D,IAAAA,EAAQhE,OAAOgL,iBAAiB1K,GAE3B0D,MAAkB,SAAlBA,EAAMQ,SAA6C,WAArBR,EAAMyL,YAM1C,KAAK3L,KAAK5D,GAzoDbgD,QAAQC,IAAI","file":"src.64c64972.js","sourceRoot":"..","sourcesContent":["import './style.scss';\r\nwindow.cnimage_editor = function($options){\r\n\r\n\r\n\tconst $storage = window.localStorage;\r\n\r\n\tconst $editor = ( typeof $options != 'undefined' && typeof $options.el != 'undefined' ) ? document.querySelector($options.el) : false;\r\n\r\n\tconst $image_editor = ( typeof $options != 'undefined' && typeof $options.image_editor != 'undefined' ) ? $options.image_editor : true;\r\n\r\n\tconst $browseFunct = ( typeof $options != 'undefined' && typeof $options.browseFunct != 'undefined' ) ? $options.browseFunct : false;\r\n\r\n\tconst $displayImageFunct = ( typeof $options != 'undefined' && typeof $options.displayImageFunct != 'undefined' ) ? $options.displayImageFunct : false;\r\n\r\n\tconst $editFunct = ( typeof $options != 'undefined' && typeof $options.editFunct != 'undefined' ) ? $options.editFunct : false;\r\n\r\n\tconst $deleteFunct = ( typeof $options != 'undefined' && typeof $options.deleteFunct != 'undefined' ) ? $options.deleteFunct : false;\r\n\r\n\tconst $saveFunct = ( typeof $options != 'undefined' && typeof $options.saveFunct != 'undefined' ) ? $options.saveFunct : false;\r\n\r\n\tconst $resetFunct = ( typeof $options != 'undefined' && typeof $options.resetFunct != 'undefined' ) ? $options.resetFunct : false;\r\n\r\n\tconst $closeFunct = ( typeof $options != 'undefined' && typeof $options.closeFunct != 'undefined' ) ? $options.closeFunct : false;\r\n\r\n\tconst $global = this;\r\n\r\n\tconst $editor_width = ( typeof $options != 'undefined' && typeof $options.width != 'undefined' ) ? $options.width : 300;\r\n\r\n\tconst $editor_height = ( typeof $options != 'undefined' && typeof $options.height != 'undefined' ) ? $options.height : 300;\r\n\r\n\tconst $cropbox_width = ( typeof $options != 'undefined' && typeof $options.cropbox_width != 'undefined' ) ? $options.cropbox_width : 150;\r\n\tconst $cropbox_height = ( typeof $options != 'undefined' && typeof $options.cropbox_height != 'undefined' ) ? $options.cropbox_height : 150;\r\n\r\n\tconst $cropbox_resize = ( typeof $options != 'undefined' && typeof $options.cropbox_resize != 'undefined' ) ? $options.cropbox_resize : true;\r\n\t\r\n\tconst $cropbox_resize_minwidth = ( typeof $options != 'undefined' && $cropbox_resize && typeof $options.cropbox_resize == 'object' && typeof $options.cropbox_resize.minwidth != 'undefined' ) ? $options.cropbox_resize.minwidth : 50;\r\n\tconst $cropbox_resize_minheight = ( typeof $options != 'undefined' && $cropbox_resize && typeof $options.cropbox_resize == 'object' && typeof $options.cropbox_resize.minheight != 'undefined' ) ? $options.cropbox_resize.minheight : 50;\r\n\tconst $cropbox_resize_maxwidth = ( typeof $options != 'undefined' && $cropbox_resize && typeof $options.cropbox_resize == 'object' && typeof $options.cropbox_resize.maxwidth != 'undefined' ) ? $options.cropbox_resize.maxwidth : 800;\r\n\tconst $cropbox_resize_maxheight = ( typeof $options != 'undefined' && $cropbox_resize && typeof $options.cropbox_resize == 'object' && typeof $options.cropbox_resize.maxheight != 'undefined' ) ? $options.cropbox_resize.maxheight : 800;\r\n\r\n\tconst $autocrop = ( typeof $options != 'undefined' && typeof $options.autocrop == 'object' ) ? $options.autocrop : false;\r\n\r\n\tconst $cropboxsave_width = ( $autocrop && typeof $options.autocrop == 'object' && typeof $options.autocrop.width != 'undefined' ) ? $options.autocrop.width : 50;\r\n\tconst $cropboxsave_height = ( $autocrop && typeof $options.autocrop == 'object' && typeof $options.autocrop.height != 'undefined' ) ? $options.autocrop.height : 50;\r\n\r\n\tconst $imgcache = ( typeof $options != 'undefined' && typeof $options.imgcache != 'undefined' ) ? $options.imgcache : false;\r\n\r\n\tif( $imgcache && $storage == 'undefined' ){\r\n\t\tconsole.log('Web Storage is not supported! image caching mechanism disabled');\r\n\t\t$imgcache = false;\r\n\t}\r\n\r\n\tif( !$imgcache && $storage ){\r\n\t\t$storage.setItem('imgeditorcachedb',[]);\r\n\t}\r\n\r\n    let rotation = 0;\r\n\r\n    if( !$editor ){\r\n    \tconsole.log('Bind an element e.g. new cnimage_editor( {  el : <element> } )');\r\n    \treturn;\r\n    }\r\n\r\n    let _editordata = document.querySelector('body').getAttribute('data-imgeditor'),\r\n\t\t_editor = {};\r\n\r\n\tif( _editordata ){\r\n\t\t_editor = JSON.parse(_editordata);\r\n\t\t_editor.push({\r\n\t\t\t$el : $options.el,\r\n\t\t\t$image_editor : $image_editor,\r\n\t\t\t$browseFunct : $browseFunct,\r\n\t\t\t$displayImageFunct : $displayImageFunct,\r\n\t\t\t$editFunct : $editFunct,\r\n\t\t\t$deleteFunct : $deleteFunct,\r\n\t\t\t$saveFunct : $saveFunct,\r\n\t\t\t$resetFunct : $resetFunct,\r\n\t\t\t$closeFunct : $closeFunct,\r\n\t\t\t$editor_width : $editor_width,\r\n\t\t\t$editor_height : $editor_height,\r\n\t\t\t$cropbox_width : $cropbox_width,\r\n\t\t\t$cropbox_height : $cropbox_height,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$cropbox_resize : $cropbox_resize,\r\n\t\t\t$cropbox_resize_minwidth : $cropbox_resize_minwidth,\r\n\t\t\t$cropbox_resize_minheight : $cropbox_resize_minheight,\r\n\t\t\t$cropbox_resize_maxwidth : $cropbox_resize_maxwidth,\r\n\t\t\t$cropbox_resize_maxheight : $cropbox_resize_maxheight,\r\n\t\t\t$autocrop : $autocrop,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$imgcache : $imgcache,\r\n\t\t\trawoptions : $options\r\n\t\t});\r\n\t}else{\r\n\t\t_editor = [{\r\n\t\t\t$el : $options.el,\r\n\t\t\t$editor : $editor,\r\n\t\t\t$image_editor : $image_editor,\r\n\t\t\t$browseFunct : $browseFunct,\r\n\t\t\t$displayImageFunct : $displayImageFunct,\r\n\t\t\t$editFunct : $editFunct,\r\n\t\t\t$deleteFunct : $deleteFunct,\r\n\t\t\t$saveFunct : $saveFunct,\r\n\t\t\t$resetFunct : $resetFunct,\r\n\t\t\t$closeFunct : $closeFunct,\r\n\t\t\t$editor_width : $editor_width,\r\n\t\t\t$editor_height : $editor_height,\r\n\t\t\t$cropbox_width : $cropbox_width,\r\n\t\t\t$cropbox_height : $cropbox_height,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$cropbox_resize : $cropbox_resize,\r\n\t\t\t$cropbox_resize_minwidth : $cropbox_resize_minwidth,\r\n\t\t\t$cropbox_resize_minheight : $cropbox_resize_minheight,\r\n\t\t\t$cropbox_resize_maxwidth : $cropbox_resize_maxwidth,\r\n\t\t\t$cropbox_resize_maxheight : $cropbox_resize_maxheight,\r\n\t\t\t$autocrop : $autocrop,\r\n\t\t\t$cropboxsave_width : $cropboxsave_width,\r\n\t\t\t$cropboxsave_height : $cropboxsave_height,\r\n\t\t\t$imgcache : $imgcache,\r\n\t\t\trawoptions : $options\r\n\t\t}];\r\n\t}\r\n\r\n\tdocument.querySelector('body').setAttribute('data-imgeditor',JSON.stringify(_editor) );\r\n\r\n\r\n\tthis.init = function(){\t\t\r\n\r\n\t\tif( document.querySelector('#image-editor-modal') == null && $image_editor ){\r\n\t\t\tthis.initModalEditor();\r\n\t\t}\r\n\r\n\t\t// add height and width to editor\t\t\r\n\t\t$editor.style.width = $editor_width+'px';\r\n\t\t$editor.style.height = $editor_height+'px';\r\n\r\n\t\t// -- end height and width editor\r\n\r\n\t\t$editor.classList.add('image-editor'); // classes for the editor\r\n\r\n\r\n\t\tlet $default_canvas = '';\r\n\r\n\t\tvar $id =  document.querySelectorAll('.image-editor').length -1;\r\n\r\n\t\t$editor.setAttribute('data-index',$id);\r\n\r\n\t\tif( $editor.querySelector('input.filetype') == null && $editor.querySelector('input.filename') == null && $editor.querySelector('input.image-src') == null ){\t\t\t\r\n\t\t\t// build editor structure\r\n\t\t\t$editor.innerHTML = '<input type=\"hidden\" name=\"image['+$id+'][filetype]\" class=\"filetype\"><input type=\"hidden\" name=\"image['+$id+'][filename]\" class=\"filename\"><input type=\"hidden\" name=\"image['+$id+'][contents]\" class=\"image_src\"><input class=\"file-browse\" type=\"file\" accept=\"image/x-png,image/jpeg,image/png\" style=\"display:none;\"><div class=\"image-editor-tools\"><a href=\"javascript:void(0);\" class=\"image-editor-browse flex-center radius-5\"><i class=\"fas fa-plus\"></i></a><a href=\"javascript:void(0);\" class=\"image-editor-edit flex-center radius-5\"><i class=\"fas fa-magic\"></i></a><a href=\"javascript:void(0);\" class=\"image-editor-delete flex-center radius-5\"><i class=\"far fa-trash-alt\"></i></a></div><div class=\"image-editor-preview\"></div>';\r\n\t\t\t// -- end editor structure\r\n\t\t}\r\n\r\n\t\t$editor.querySelector('.image-editor-browse').style.display = 'flex'; // show the browse button\r\n\r\n\t\tif( $editor.querySelector('input.filetype') != '' && $editor.querySelector('input.filename').value != '' && $editor.querySelector('input.image_src').value != '' ){\r\n\r\n\t\t\t$editor.querySelector('.image-editor-edit').style.display = 'flex';\r\n\t\t\t$editor.querySelector('.image-editor-delete').style.display = 'flex';\r\n\r\n\t\t\tdocument.querySelectorAll('.image-editor').forEach(function(el){\r\n\t\t\t\tel.classList.remove('active');\r\n\t\t\t});\r\n\t\t\t$editor.classList.add('active');\r\n\r\n\t\t\tthis.displayImage(false, $editor.querySelector('input.image_src').value );\r\n\r\n\t\t}else{\r\n\t\t\t$editor.querySelector('.image-editor-edit').style.display = 'none';\r\n\t\t\t$editor.querySelector('.image-editor-delete').style.display = 'none';\r\n\t\t}\r\n\r\n\t\t// browse button click event\r\n\r\n\t\t$editor.querySelector('.image-editor-browse').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\r\n\r\n\t\t\tif( $active_editor != null ){\r\n\t\t\t\t$active_editor.classList.remove('active');\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\tthis.closest('.image-editor').classList.add('active');\r\n\r\n\t\t\t$editor.querySelector('input.file-browse').click();\r\n\r\n\r\n\t\t\t// run a custom delete function if theres one\r\n\t\t\tif( $browseFunct ){\r\n\t\t\t\twindow[$browseFunct]();\r\n\t\t\t}\r\n\r\n\r\n\t\t});\r\n\r\n\t\t// -- end browse button click event\r\n\r\n\r\n\r\n\t\t// editor edit button click event\r\n\r\n\t\t$editor.querySelector('.image-editor-edit').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\t\t\tif( document.querySelector('#image-editor-modal') != null && $image_editor ){\r\n\r\n\t\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\r\n\r\n\t\t\t\tif( $active_editor != null ){\r\n\r\n\t\t\t\t\t$active_editor.classList.remove('active');\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tthis.closest('.image-editor').classList.add('active');\r\n\r\n\t\t\t\tdocument.querySelector('#image-editor-modal').style.display = 'block'; // show modal\r\n\r\n\t\t\t\tif( $image_editor ){\r\n\r\n\t\t\t\t\t$global.displayImageModal(document.querySelector('.image-editor.active input.image_src').value,true);\r\n\r\n\t\t\t\t}else{\r\n\r\n\t\t\t\t\talert('Editor not found!');\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}else {\r\n\r\n\t\t\t\talert('Editor not found!');\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\t// run a custom delete function if theres one\r\n\r\n\t\t\tif( $editFunct ){\r\n\r\n\t\t\t\twindow[$editFunct](document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t});\r\n\r\n\t\t// -- end edit button click event\r\n\r\n\r\n\r\n\t\t// when click image editor delete\r\n\r\n\t\t$editor.querySelector('.image-editor-delete').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\t\t\tlet $active_editor = document.querySelector('.image-editor.active');\r\n\r\n\r\n\t\t\tif( $active_editor != null ){\r\n\t\t\t\t$active_editor.classList.remove('active');\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis.closest('.image-editor').classList.add('active');\r\n\r\n\r\n\r\n\t\t\tif( this.closest('.image-editor').querySelector('canvas') != null ){\r\n\r\n\t\t\t\tthis.closest('.image-editor').querySelector('canvas').remove();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif( this.closest('.image-editor').querySelector('img') != null ){\r\n\r\n\t\t\t\tthis.closest('.image-editor').querySelector('img').remove();\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t\tthis.style.display = 'none';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('.image-editor-edit').style.display = 'none';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.file-browse').value = '';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.image_src').value = '';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.filename').value = '';\r\n\r\n\t\t\tthis.closest('.image-editor').querySelector('input.filetype').value = '';\r\n\r\n\r\n\r\n\t\t\tif( $imgcache ){ // delete from web storage if option enabled\r\n\r\n\t\t\t\tvar _storage = $storage.getItem('imgeditorcachedb');\r\n\r\n\t\t\t\tif( _storage ){\r\n\t\t\t\t\t_storage = JSON.parse(_storage);\r\n\r\n\t\t\t\t\tvar _img = _storage.findIndex(function(i){\r\n\t\t\t\t\t\treturn i.index == $editor.getAttribute('data-index')\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif( _img != -1 ){\r\n\t\t\t\t\t\t_storage.splice(_img,1);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// run a custom delete function if theres one\r\n\r\n\t\t\tif( $deleteFunct ){\r\n\r\n\t\t\t\twindow[$deleteFunct](document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t});\r\n\r\n\t\t// -- end image editor delete\r\n\r\n\r\n\r\n\t\t// editor file input change event\r\n\r\n\t\t$editor.querySelector('input.file-browse').addEventListener('change',function(){\r\n\r\n\r\n\t\t\tvar idxDot = this.value.lastIndexOf(\".\") + 1;\r\n\r\n\t        var extFile = this.value.substr(idxDot, this.value.length).toLowerCase();\r\n\r\n\t        if (extFile==\"jpg\" || extFile==\"jpeg\" || extFile==\"png\"){\r\n\r\n\t        \tif( $global.ValidateSize(this) ){\r\n\r\n\t        \t\t$global.displayImage(this);\r\n\r\n\t        \t}\r\n\r\n\r\n\t        }else{\r\n\r\n\t            alert(\"Only jpg/jpeg and png files are allowed!\");\r\n\r\n\t        }   \r\n\r\n\t\t});\r\n\t\t// -- end editor input on change event\r\n\r\n\t\t// check if theres an img cache\r\n\t\tif( $imgcache && $storage.getItem('imgeditorcachedb') ){\r\n\r\n\t\t\tvar _storage = JSON.parse( $storage.getItem('imgeditorcachedb') );\r\n\r\n\t\t\t// find the item\r\n\t\t\tvar _img = _storage.findIndex(function(i){\r\n\t\t\t\treturn i.index == $editor.getAttribute('data-index');\r\n\t\t\t});\r\n\r\n\t\t\tdocument.querySelectorAll('.image-editor').forEach(function(el){\r\n\t\t\t\tel.classList.remove('active');\r\n\t\t\t});\r\n\r\n\t\t\t$editor.classList.add('active');\r\n\r\n\t\t\tif( _img != -1 ){\r\n\t\t\t\t$global.displayImage(false,_storage[_img].dataurl);\r\n\t\t\t\t$editor.querySelector('input.filetype').value = _storage[_img].filetype;\r\n\t\t\t\t$editor.querySelector('input.filename').value = _storage[_img].filename;\r\n\t\t\t\t$editor.querySelector('input.image_src').value = _storage[_img].dataurl;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.cropCanvas = function(){\r\n\t\tif( document.querySelector('#image-editor-modal #crop-box') != null ){\r\n\r\n\r\n\t\t\tCaman('#modal-canvas',function () {\r\n\r\n\t\t\t    // width, height, x, y\r\n\r\n\t\t\t    let el_width = document.querySelector('#image-editor-modal #crop-box').offsetWidth;\r\n\r\n\t\t\t    let el_height = document.querySelector('#image-editor-modal #crop-box').offsetHeight;\r\n\r\n\t\t\t    let el_top = document.querySelector('#image-editor-modal #crop-box').offsetTop;\r\n\r\n\t\t\t    let el_left = document.querySelector('#image-editor-modal #crop-box').offsetLeft;\r\n\r\n\t\t\t    this.crop(el_width,el_height,el_left,el_top);\r\n\r\n\t\t\t    this.render(function(){\r\n\r\n\t\t\t    \tdocument.querySelector('#image-editor-modal canvas').setAttribute('id','modal-canvas');\r\n\r\n\t\t\t\t    document.querySelector('#image-editor-modal #crop-box').remove();\r\n\r\n\t\t\t    });\r\n\r\n\r\n\r\n\t\t\t    \r\n\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.initModalEditor = function(){\r\n\r\n\t\tlet $el = document.createElement('div');\r\n\r\n\t\tlet $filters = '<div class=\"text-center\"></div>';\r\n\r\n\t\t$el.setAttribute('id','image-editor-modal');\r\n\r\n\t\t$el.innerHTML = '<div id=\"image-editor-body\"><div id=\"image-editor-toolbox\"> <ul class=\"p00 m00 list-style-none\"> <li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" id=\"image-editor-modal-save\" class=\"display-block toolbox m5\"> <i class=\"fas fa-check mr5\"></i>Save </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" id=\"image-editor-modal-close\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-times mr5\"></i>Cancel </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" id=\"image-editor-modal-reset\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-sync mr5\"></i>Reset </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-magic mr5\"></i>Adjust </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\"> <li class=\"filter-slider\"> <label class=\"full-width display-block\">Brightness <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"brightness\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Contrast <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"contrast\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Saturation <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"saturation\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Vibrance <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"vibrance\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Exposure <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"exposure\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Clip <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"clip\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Hue <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"hue\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Sepia <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"sepia\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Noise <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"noise\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">Sharpen <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"sharpen\"> </li><li class=\"filter-slider\"> <label class=\"full-width display-block\">StackBlur <span class=\"filter-range\">0</span></label> <input type=\"range\" min=\"-100\" max=\"100\" value=\"0\" class=\"slider filter-range-input mb5\" data-filter=\"stackBlur\"> </li></ul> </div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" class=\"display-block toolbox m5 toolbox-dp-trigger\"> <i class=\"fas fa-magic mr5\"></i>Presets </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\" id=\"image-editor-presets\"> <li> <a href=\"javascript:void(0);\" data-preset=\"vintage\">Vintage</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"lomo\">Lomo</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"clarity\">Clarity</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"sinCity\">Sin City</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"sunrise\">Sunrise</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"crossProcess\">Cross Process</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"orangePeel\">Orange Peel</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"love\">Love</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"grungy\">Grungy</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"jarques\">Jarques</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"pinhole\">Pinhole</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"oldBoot\">Old Boot</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"glowingSun\">Glowing Sun</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"hazyDays\">Hazy Days</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"herMajesty\">Her Majesty</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"nostalgia\">Nostalgia</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"hemingway\">Hemingway</a></li><li> <a href=\"javascript:void(0);\" data-preset=\"concentrate\">concentrate</a></li></ul> </div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" class=\"display-block toolbox m5\"> <i class=\"fas fa-expand-arrows-alt mr5\"></i>Resize </a> <div class=\"toolbox-sub bg-white box-shadow\"><div class=\"col-xs-6 mb5 pl3 pr3\"><label class=\"full-width display-block\">Width:</label><input type=\"number\" class=\"mb00\" id=\"resize-width\" name=\"resize_width\"></div><div class=\"col-xs-6 mb5 pl3 pr3\"><label class=\"full-width display-block\">Height:</label><input type=\"number\" class=\"mb00\" id=\"resize-height\" name=\"resize_height\"></div><div class=\"col-xs-12 col-sm-12 mt8 pl3 pr3\"><a href=\"javascript:void(0);\" class=\"btn btn-block btn-sm btn-filled mb8\" id=\"resize-save\">Resize</a></div></div></li><li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" id=\"image-editor-crop\" class=\"display-block toolbox m5\"> <i class=\"fas fa-crop-alt mr5\"></i>Crop </a> </li><li class=\"list-style-none align-left display-table toolbox-li\" style=\"display:none\"> <a href=\"javascript:void(0);\" id=\"image-editor-crop-now\" class=\"bg-success display-block toolbox m5\"> <i class=\"fas fa-check mr5\"></i>Crop </a> </li><li class=\"list-style-none align-left display-table toolbox-li\"> <a href=\"javascript:void(0);\" id=\"image-editor-rotate\" class=\"display-block toolbox m5\"> <i class=\"fas fa-undo mr5\"></i>Rotate </a> <div class=\"toolbox-sub bg-white box-shadow\"> <ul class=\"p00 m00\" id=\"image-editor-rotate\"> <li> <a href=\"javascript:void(0);\" data-rotate=\"cw\">Clock wise</a></li><li> <a href=\"javascript:void(0);\" data-rotate=\"ccw\">Counter clock wise</a></li></ul></div></li></ul></div><div id=\"image-editor-canvas\"><div id=\"canvas-holder\" width=\"\"></div></div></div>';\r\n\r\n\r\n\r\n\t\tdocument.querySelector('body').appendChild($el);\r\n\r\n\r\n\r\n\t\t// bind a close modal editor event\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-close').addEventListener('click',function(e){\r\n\r\n\t\t\t\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal').style.display = 'none';\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal canvas').style.display = 'none';\r\n\r\n\t\t\tdocument.querySelector('body').style.overflowY = 'auto';\r\n\r\n\t\t\t$global.reset();\r\n\r\n\t\t\tif( $closeFunct ){\r\n\r\n\t\t\t\twindow[$closeFunct]();\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\t// -- end close modal editor\r\n\r\n\t\t// when click save button\r\n\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-save').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\r\n\t\t\tlet $ref = document.querySelector('#image-editor-modal #canvas-holder canvas');\r\n\r\n\r\n\r\n\t\t\tlet $x = ( $ref.width- $global.getActiveEditorOptions().$cropboxsave_width ) / 2;\r\n\r\n\t\t\tlet $y = ( $ref.height - $global.getActiveEditorOptions().$cropboxsave_height ) / 2;\r\n\r\n\r\n\r\n\t\t\tCaman('#modal-canvas',function () {\r\n\r\n\t\t\t    // width, height, x, y\r\n\r\n\t\t\t    this.render(function(){\r\n\r\n\t\t\t    \t\r\n\r\n\t\t\t    \tvar c_w = document.querySelector('#image-editor-modal canvas').offsetWidth;\r\n\r\n\t\t\t    \tvar c_h = document.querySelector('#image-editor-modal canvas').offsetHeight;\r\n\r\n\r\n\r\n\t\t\t    \tdocument.querySelector('#image-editor-modal').style.display = 'none';\r\n\r\n\t\t\t    \tif( document.querySelector('.image-editor.active canvas') != null ){\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active canvas').remove();\r\n\r\n\t\t\t    \t}\r\n\r\n\t\t\t    \tif( document.querySelector('.image-editor.active img') != null ){\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active img').remove();\r\n\r\n\t\t\t    \t}\r\n\r\n\t\t\t    \tvar el = document.createElement('canvas');\r\n\r\n\t\t\t    \tdocument.querySelector('.image-editor.active').appendChild(el);\r\n\r\n\t\t\t    \tif( document.querySelector('.image-editor.active img') != null ){\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild(el);\r\n\r\n\t\t\t    \t}\r\n\r\n\t\t\t    \tvar destinationCanvas = document.querySelector('.image-editor.active canvas');\r\n\r\n\t\t\t    \tvar destCtx = destinationCanvas.getContext('2d');\r\n\r\n\t\t\t    \tdestCtx.canvas.width = c_w;\r\n\r\n\t\t\t    \tdestCtx.canvas.height = c_h;\r\n\r\n\t\t\t    \tdestCtx.drawImage(document.querySelector('#image-editor-modal canvas'), 0, 0);\r\n\r\n\t\t\t    \t// get the data base url\r\n\r\n\t\t\t    \tdocument.querySelector('.image-editor.active input.image_src').value = document.querySelector('.image-editor.active canvas').toDataURL();\r\n\r\n\t\t\t    \tif( $imgcache ){ // delete from web storage if option enabled\r\n\r\n\t\t\t\t\t\tvar _storage = $storage.getItem('imgeditorcachedb');\r\n\r\n\t\t\t\t\t\tif( _storage ){\r\n\t\t\t\t\t\t\t_storage = JSON.parse(_storage);\r\n\r\n\t\t\t\t\t\t\tvar _img = _storage.findIndex(function(i){\r\n\t\t\t\t\t\t\t\treturn i.index == $editor.getAttribute('data-index')\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\tif( _img != -1 ){\r\n\t\t\t\t\t\t\t\t_storage[_img].dataurl = document.querySelector('.image-editor.active input.image_src').value;\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t_storage.push({\r\n\t\t\t\t\t\t\t\t\tindex : document.querySelector('.image-editor.active').getAttribute('data-index'),\r\n\t\t\t\t\t\t\t\t\tdataurl : document.querySelector('.image-editor.active input.image_src').value,\r\n\t\t\t\t\t\t\t\t\tfiletype : document.querySelector('.image-editor.active input.filetype').value,\r\n\t\t\t\t\t\t\t\t\tfilename : document.querySelector('.image-editor.active input.filename').value\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\r\n\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\tvar _storage = [];\r\n\r\n\t\t\t\t\t\t\t_storage.push({\r\n\t\t\t\t\t\t\t\tindex : document.querySelector('.image-editor.active').getAttribute('data-index'),\r\n\t\t\t\t\t\t\t\tdataurl : document.querySelector('.image-editor.active input.image_src').value,\r\n\t\t\t\t\t\t\t\tfiletype : document.querySelector('.image-editor.active input.filetype').value,\r\n\t\t\t\t\t\t\t\tfilename : document.querySelector('.image-editor.active input.filename').value\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t$storage.setItem('imgeditorcachedb',JSON.stringify(_storage));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t    });\r\n\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// set body to overflow auto\r\n\t\t\tdocument.querySelector('body').style.overflowY = 'auto';\r\n\r\n\t\t\tif( $saveFunct ){\r\n\r\n\t\t\t\twindow[$saveFunct](document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t}\r\n\r\n\r\n\r\n\t\t});\r\n\r\n\t\t// -- end click save button\r\n\r\n\t\t// on crop\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').addEventListener('click',function(e){\r\n\r\n\r\n\t\t\tlet $el = document.createElement('div');\r\n\r\n\t\t\t$el.setAttribute('id','crop-box');\r\n\r\n\r\n\r\n\t\t\t$el.style.width = $cropbox_width+'px';\r\n\r\n\t\t\t$el.style.height = $cropbox_height+'px';\r\n\r\n\r\n\r\n\t\t\t$el.innerHTML = '<div class=\"resizer\" style=\"position:absolute;top:-2px;left:-2px;border-top: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;top:-2px;right:-2px;border-top: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;bottom:-2px;left:-2px;border-bottom: 3px solid #FFF;border-left: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div><div class=\"resizer\" style=\"position:absolute;bottom:-2px;right:-2px;border-bottom: 3px solid #FFF;border-right: 3px solid #FFF;display: block;width: 15px;height: 15px;\"></div>';\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($el);\r\n\r\n\r\n\r\n\t\t\t$global.dragCropBox();\r\n\r\n\t\t\t$global.resizeCropBox();\r\n\r\n\r\n\r\n\t\t\tthis.closest('li').style.display = 'none';\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').closest('li').style.display = 'block';\r\n\r\n\t\t\t\r\n\r\n\t\t});\r\n\r\n\t\t// -- end on crop\r\n\r\n\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').addEventListener('click',function(e){\r\n\r\n\t\t\t$global.cropCanvas();\r\n\r\n\r\n\r\n\t\t\tthis.closest('li').style.display = 'none';\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').closest('li').style.display = 'block';\r\n\r\n\t\t});\r\n\r\n\t\t// Update the current slider value (each time you drag the slider handle)\r\n\r\n\t\tdocument.querySelectorAll('.filter-slider').forEach(function($el){\r\n\r\n\t\t\t$el.querySelector('.filter-range').textContent = $el.querySelector('.filter-range-input').value;\r\n\r\n\r\n\r\n\t\t\t$el.querySelector('.filter-range-input').addEventListener('input',function(){\r\n\r\n\t\t\t\tthis.closest('.filter-slider').querySelector('.filter-range').textContent = this.value;\r\n\r\n\t\t\t\t$global.applyFilter(this.getAttribute('data-filter'),this.value);\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t// -- end update slider values\r\n\r\n\r\n\r\n\t\t// apply preset\r\n\r\n\t\tdocument.querySelectorAll('#image-editor-modal #image-editor-presets li a').forEach(function($el){\r\n\r\n\t\t\t$el.addEventListener('click',function(e){\r\n\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$global.applyPreset( $el.getAttribute('data-preset'));\r\n\r\n\t\t\t});\r\n\r\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t// -- end apply preset\r\n\r\n\r\n\r\n\t\t// when rotate\r\n\r\n\t\tdocument.querySelectorAll('#image-editor-modal #image-editor-rotate li a').forEach(function($el){\r\n\r\n\t\t\t$el.addEventListener('click',function(e){\r\n\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$global.applyRotate( $el.getAttribute('data-rotate'));\r\n\r\n\t\t\t});\r\n\r\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t\t\t\r\n\r\n\t\t});\r\n\r\n\t\t// -- end rotate\r\n\r\n\t\t// reset\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-modal-reset').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\r\n\t\t\t$global.reset();\r\n\r\n\t\t\tif( $resetFunct ){\r\n\r\n\t\t\t\twindow[$resetFunct](document.querySelector('.image-editor.active'));\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\t// -- end reset\r\n\r\n\r\n\r\n\t\t// resize\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #resize-save').addEventListener('click',function(e){\r\n\r\n\t\t\te.preventDefault();\r\n\r\n\r\n\r\n\t\t\tlet $w = this.closest('.toolbox-sub').querySelector('#resize-width').value;\r\n\r\n\t\t\tlet $h = this.closest('.toolbox-sub').querySelector('#resize-height').value;\r\n\r\n\t\t\t\r\n\r\n\t\t\t$global.applyResize($w,$h);\r\n\r\n\t\t});\r\n\r\n\t\t// -- end resize\r\n\r\n\t}\r\n\r\n\tthis.dragCropBox = function(){\r\n\r\n\t    let dragItem = document.querySelector(\"#image-editor-modal #crop-box\");\r\n\r\n\t    let container = document.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder');\r\n\r\n\r\n\r\n\t    let active = false;\r\n\r\n\t    let currentX;\r\n\r\n\t    let currentY;\r\n\r\n\t    let initialX;\r\n\r\n\t    let initialY;\r\n\r\n\t    let xOffset = 0;\r\n\r\n\t    let yOffset = 0;\r\n\r\n\r\n\r\n\t    container.addEventListener(\"touchstart\", dragStart, false);\r\n\r\n\t    container.addEventListener(\"touchend\", dragEnd, false);\r\n\r\n\t    container.addEventListener(\"touchmove\", drag, false);\r\n\r\n\r\n\r\n\t    container.addEventListener(\"mousedown\", dragStart, false);\r\n\r\n\t    container.addEventListener(\"mouseup\", dragEnd, false);\r\n\r\n\t    container.addEventListener(\"mousemove\", drag, false);\r\n\r\n\r\n\r\n\r\n\r\n\t    function dragStart(e) {\r\n\r\n\t      if (e.type === \"touchstart\") {\r\n\r\n\t        initialX = e.touches[0].clientX - xOffset;\r\n\r\n\t        initialY = e.touches[0].clientY - yOffset;\r\n\r\n\t      } else {\r\n\r\n\t        initialX = e.clientX - xOffset;\r\n\r\n\t        initialY = e.clientY - yOffset;\r\n\r\n\t      }\r\n\r\n\r\n\r\n\t      if (e.target === dragItem) {\r\n\r\n\t        active = true;\r\n\r\n\t      }\r\n\r\n\r\n\r\n\t    }\r\n\r\n\r\n\r\n\t    function dragEnd(e) {\r\n\r\n\t      initialX = currentX;\r\n\r\n\t      initialY = currentY;\r\n\r\n\r\n\r\n\t      active = false;\r\n\r\n\t    }\r\n\r\n\r\n\r\n\t    function drag(e) {\r\n\r\n\t      if (active) {\r\n\r\n\t      \r\n\r\n\t        e.preventDefault();\r\n\r\n\t      \r\n\r\n\t        if (e.type === \"touchmove\") {\r\n\r\n\t          currentX = e.touches[0].clientX - initialX;\r\n\r\n\t          currentY = e.touches[0].clientY - initialY;\r\n\r\n\t        } else {\r\n\r\n\t          currentX = e.clientX - initialX;\r\n\r\n\t          currentY = e.clientY - initialY;\r\n\r\n\t        }\r\n\r\n\r\n\r\n\t        xOffset = currentX;\r\n\r\n\t        yOffset = currentY;\r\n\r\n\r\n\r\n\t        setTranslate(currentX, currentY, dragItem);\r\n\r\n\t      }\r\n\r\n\t    }\r\n\r\n\r\n\r\n\t    function setTranslate(xPos, yPos, el) {\r\n\r\n\t      // el.style.transform = \"translate3d(\" + xPos + \"px, \" + yPos + \"px, 0)\";\r\n\r\n\t      el.style.top = yPos+'px';\r\n\r\n\t      el.style.left = xPos+'px';\r\n\r\n\t    }\r\n\r\n\t}\r\n\r\n\t// check if mobile, return false otherwise\r\n\r\n\tthis.checkIfMobile = function(){\r\n\r\n\t\t// device detection\r\n\r\n\t\tif(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) \r\n\r\n\t\t    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(navigator.userAgent.substr(0,4))) { \r\n\r\n\t\t    return true;\r\n\r\n\t\t}else{\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// -- end check if mobile\r\n\r\n\r\n\r\n\t// validate filesize\r\n\r\n\tthis.ValidateSize = function(file) {\r\n\r\n        var FileSize = file.files[0].size / 1024 / 1024; // in MB\r\n\r\n        if (FileSize > 2) {\r\n\r\n            alert('File size exceeds 2 MB');\r\n\r\n        } else {\r\n\r\n        \treturn true;\r\n\r\n        }\r\n\r\n    }\r\n\r\n\t// -- end validate filesize\r\n\r\n\t// resize crop box event\r\n\tthis.getActiveEditorOptions = function(){\r\n\r\n\t\tlet _data = JSON.parse(document.querySelector('body').getAttribute('data-imgeditor') );\r\n\r\n\t\treturn _data[_data.findIndex(function(i){\r\n\t\t\treturn i.$el == '#'+document.querySelector('.image-editor.active').getAttribute('id');\r\n\t\t})];\r\n\t};\r\n\r\n\tthis.resizeCropBox = function() {\r\n\r\n\t\t\r\n\t \tlet resizeHandle = document.querySelectorAll('#image-editor-modal #image-editor-canvas #crop-box .resizer');\r\n\r\n\t\tlet p = document.querySelector('#image-editor-modal #image-editor-canvas #crop-box');\r\n\r\n\t\tresizeHandle.forEach(function(el){\r\n\r\n\t\t\tif( $global.checkIfMobile() ){\r\n\r\n\t\t\t\tel.addEventListener(\"touchstart\", initDrag, false);\r\n\r\n\t\t\t}else{\r\n\r\n\t\t\t\tel.addEventListener('mousedown', initDrag, false);\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\r\n\r\n\t\tvar startX, startY, startWidth, startHeight;\r\n\r\n\r\n\r\n\t\tfunction initDrag(e) {\r\n\t\t\t\r\n\t\t\tif( !$global.getActiveEditorOptions().$cropbox_resize ){\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t   \tif( $global.checkIfMobile() ){\r\n\r\n\t\t   \t\tstartX = e.touches[0].clientX;\r\n\r\n\t\t   \t\tstartY = e.touches[0].clientY;\r\n\r\n\t\t   \t}else{\r\n\r\n\t\t   \t\tstartX = e.clientX;\r\n\r\n\t\t   \t\tstartY = e.clientY;\r\n\r\n\t\t   \t}\r\n\r\n\t\t   startWidth = parseInt(document.defaultView.getComputedStyle(p).width, 10);\r\n\r\n\t\t   startHeight = parseInt(document.defaultView.getComputedStyle(p).height, 10);\r\n\r\n\r\n\r\n\t\t   if( $global.checkIfMobile() ){\r\n\r\n\t\t   \tdocument.documentElement.addEventListener(\"touchmove\",doDrag, false);\r\n\r\n\t   \t   document.documentElement.addEventListener(\"touchend\", stopDrag, false);\r\n\r\n\t\t   }else{\r\n\r\n\t\t   \tdocument.documentElement.addEventListener('mousemove', doDrag, false);\r\n\r\n\t\t   document.documentElement.addEventListener('mouseup', stopDrag, false);\r\n\r\n\t\t   }\r\n\r\n\t\t   \r\n\r\n\t\t   document.documentElement.addEventListener(\"touchmove\",doDrag, false);\r\n\r\n\t   \t   document.documentElement.addEventListener(\"touchend\", stopDrag, false);\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tfunction doDrag(e) {\r\n\r\n\t\t\tif( $global.checkIfMobile() ){\r\n\r\n\r\n\t\t\t\tif( ( (startWidth + e.touches[0].clientX - startX) < $global.getActiveEditorOptions().$cropbox_resize_maxwidth ) && ( (startWidth + e.touches[0].clientX - startX) > $global.getActiveEditorOptions().$cropbox_resize_minwidth) ){\r\n\r\n\t\t\t\t\tp.style.width = (startWidth + e.touches[0].clientX - startX) + 'px';\r\n\r\n\t\t\t   \t}\r\n\r\n\t\t\t   \tif( ( (startHeight + e.touches[0].clientY - startY) < $global.getActiveEditorOptions().$cropbox_resize_maxheight ) && ( (startHeight + e.touches[0].clientY - startY) > $global.getActiveEditorOptions().$cropbox_resize_minheight) ){\r\n\r\n\t\t\t\t   \tp.style.height = (startHeight + e.touches[0].clientY - startY) + 'px';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}else{\t\t\t\t\r\n\r\n\t\t\t\tif( ( (startWidth + e.clientX - startX) < $global.getActiveEditorOptions().$cropbox_resize_maxwidth ) && ( (startWidth + e.clientX - startX) > $global.getActiveEditorOptions().$cropbox_resize_minwidth) ){\r\n\r\n\t\t\t\t\tp.style.width = (startWidth + e.clientX - startX) + 'px';\r\n\r\n\t\t\t   \t}\r\n\r\n\t\t\t   \tif( ( (startHeight + e.clientY - startY) < $global.getActiveEditorOptions().$cropbox_resize_maxheight ) && ( (startHeight + e.clientY - startY) > $global.getActiveEditorOptions().$cropbox_resize_minheight) ){\r\n\r\n\t\t\t\t   \tp.style.height = (startHeight + e.clientY - startY) + 'px';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tfunction stopDrag(e) {\r\n\r\n\t\t\tif( $global.checkIfMobile() ){\r\n\r\n\t\t\t\tdocument.documentElement.removeEventListener(\"touchmove\", doDrag, false);\r\n\r\n\t\t   \t   \tdocument.documentElement.removeEventListener(\"touchend\", stopDrag, false);\r\n\r\n\t\t\t}else{\r\n\r\n\t\t\t\tdocument.documentElement.removeEventListener('mousemove', doDrag, false);\r\n\r\n\t\t\t   \tdocument.documentElement.removeEventListener('mouseup', stopDrag, false);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// when click browse, display image\r\n\r\n\tthis.displayImage = function($el,$base64){\r\n\r\n\t\tvar $base64 = ( $base64 != 'undefined' ) ? $base64 : false;\r\n\t\tif( !$base64){\r\n\t\t\tif ( $el.files == 'undefined' && !$el.files[0] == 'undefined' ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// always remove existing canvas\r\n\r\n\t\tif( document.querySelector('.image-editor.active canvas') != null ){\r\n\r\n\t\t\tdocument.querySelector('.image-editor.active canvas').remove();\r\n\r\n\t\t}\r\n\r\n\t\tif( document.querySelector('.image-editor.active img') != null ){\r\n\r\n\t\t\tdocument.querySelector('.image-editor.active img').remove();\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// append a default canvas\r\n\r\n\t\tlet $canvas = document.createElement('canvas');\r\n\r\n\t\t$canvas.style.display = 'none';\r\n\r\n\t\tdocument.querySelector('.image-editor.active .image-editor-preview').appendChild($canvas);\r\n\r\n\t\t// -- end append default canvas\r\n\r\n\r\n\r\n    \tlet $ctx = document.querySelector('.image-editor.active canvas').getContext('2d');\r\n\r\n\t\tlet $img = new Image;\r\n\r\n\t\t$img.crossOrigin = 'anonymous';\r\n\r\n\r\n\r\n\r\n\t\t$img.onload = function() {\r\n\r\n\r\n\t\t\t$ctx.canvas.width = this.width;\r\n\r\n\t\t    $ctx.canvas.height = this.height;\r\n\r\n\t\t    $ctx.drawImage($img,0,0);\r\n\r\n\t\t    $editor.setAttribute('data-imgw',$img.width);\r\n\t\t    $editor.setAttribute('data-imgh',$img.height); \r\n\r\n\t\t\tif( !$base64){\r\n\r\n\t\t\t    let $x = ( this.width- $global.getActiveEditorOptions().$cropboxsave_width ) / 2;\r\n\t\t\t\tlet $y = ( this.height - $global.getActiveEditorOptions().$cropboxsave_height ) / 2;\r\n\r\n\t\t\t\tCaman(\".image-editor.active canvas\", function () {\r\n\r\n\t\t\t\t\t// width, height, x, y\r\n\t\t\t\t\tif( !$autocrop ){\r\n\t\t\t\t\t\tthis.crop($img.width, $img.height,0,0);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.crop($global.getActiveEditorOptions().$cropboxsave_width, $global.getActiveEditorOptions().$cropboxsave_height,$x,$y);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t    this.render(function(){\r\n\r\n\t\t\t\t    \t// get the data base url\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.image_src').value = document.querySelector('.image-editor.active canvas').toDataURL();\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.filename').value = $el.files[0].name;\r\n\r\n\t\t\t    \t\tdocument.querySelector('.image-editor.active input.filetype').value = document.querySelector('.image-editor.active input.filename').value.split('.')[1];\r\n\r\n\t\t\t\t    });\r\n\r\n\t\t\t\t    if( $displayImageFunct ){\r\n\t\t\t\t\t\twindow[$displayImageFunct](document.querySelector('.image-editor.active'));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif( document.querySelector('#image-editor-modal') != null && $image_editor ){\r\n\r\n\t\t\t\tdocument.querySelector('.image-editor.active .image-editor-edit').style.display = 'flex';\r\n\r\n\t\t\t}else{\r\n\r\n\t\t\t\tdocument.querySelector('.image-editor.active .image-editor-edit').style.display = 'none';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdocument.querySelector('.image-editor.active .image-editor-delete').style.display = 'flex';\r\n\r\n\t\t\t$canvas.style.display = 'block';\r\n\r\n\r\n\t\t  }\r\n\r\n\t\t  \tif( !$base64){\r\n\t\t\t\t$img.src = URL.createObjectURL($el.files[0]);\r\n\t\t\t}else{\r\n\t\t\t\t$img.src = $base64;\r\n\t\t\t}\r\n\r\n\t}\r\n\r\n\t// -- end display image on modal editor\r\n\r\n\tthis.displayImageModal = function($el,$t){\t\t\r\n\r\n\t\t// always remove existing canvas\r\n\r\n\t\tif( document.querySelector('#image-editor-modal #image-editor-canvas canvas') != null ){\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas canvas').remove();\r\n\r\n\t\t}\r\n\r\n\t\t// append a default canvas\r\n\r\n\t\tlet $canvas = document.createElement('canvas');\r\n\r\n\t\t$canvas.setAttribute('id','modal-canvas');\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($canvas);\r\n\r\n\t\t// -- end append default canvas\r\n\r\n\r\n\r\n\t\t$global.cloneImg($el,$t);\r\n\r\n\r\n\r\n\t\tlet $ctx = document.querySelector('#image-editor-modal #image-editor-canvas canvas').getContext('2d');\r\n\r\n\t\tlet $img = new Image;\r\n\r\n\t\t$img.crossOrigin = 'anonymous';\r\n\r\n\r\n\r\n\t\tif( $t ){\r\n\r\n\t\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\r\n\r\n\t\t\t$img.src = document.querySelector('.image-editor.active input.image_src').value;\r\n\r\n\t\t}else{\r\n\r\n\t\t\tif ($el.files && $el.files[0]) {\r\n\r\n\r\n\r\n\t\t\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\r\n\r\n\t\t\t\t$img.src = URL.createObjectURL($el.files[0]);\r\n\r\n\r\n\r\n\t\t  \t}\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\r\n\r\n\t}\r\n\r\n\r\n\r\n\tthis.cloneImg = function($el,$t){\r\n\r\n\t\tif( document.querySelector('#clone-img') != null ){\r\n\r\n\t\t\tdocument.querySelector('#clone-img').remove();\r\n\r\n\t\t}\r\n\r\n\t\tif( $t ){\r\n\r\n\t\t\tvar el = document.createElement('div');\r\n\r\n\t\t\tel.setAttribute('id','clone-img');\r\n\r\n\t\t\tel.innerHTML = '<img src=\"'+$el+'\">';\r\n\r\n\t\t\tdocument.querySelector('body').style.overflowY = 'hidden';\r\n\r\n\t\t\tdocument.querySelector('body').appendChild(el);\r\n\r\n\r\n\r\n\t\t}else{\r\n\r\n\t\t\tvar $reader = new FileReader();\r\n\r\n\r\n\t\t\t$reader.onload = function(e){\r\n\r\n\t\t\t\tvar el = document.createElement('div');\r\n\r\n\t\t\t\tel.setAttribute('id','clone-img');\r\n\r\n\t\t\t\tel.innerHTML = '<img src=\"'+e.target.result+'\">';\r\n\r\n\t\t\t\tdocument.querySelector('body').style.overflowY = 'hidden';\r\n\r\n\t\t\t\tdocument.querySelector('body').appendChild(el);\r\n\r\n\t\t\t}\r\n\r\n\t\t\t$reader.readAsDataURL($el.files[0]);\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\r\n\tthis.drawImageScaled = function(img, ctx) {\r\n\r\n\r\n\r\n\t\t   ctx.canvas.width = document.querySelector('#clone-img img').offsetWidth;\r\n\r\n\t\t   ctx.canvas.height = document.querySelector('#clone-img img').offsetHeight;\r\n\r\n\t\t   var canvas = ctx.canvas ;\r\n\r\n\t\t   var hRatio = canvas.width  / img.width;\r\n\r\n\t\t   var vRatio =  canvas.height / img.height;\r\n\r\n\t\t   var ratio  = Math.min ( hRatio, vRatio );\r\n\r\n\t\t   var centerShift_x = ( canvas.width - img.width*ratio ) / 2;\r\n\r\n\t\t   var centerShift_y = ( canvas.height - img.height*ratio ) / 2;  \r\n\r\n\t\t   ctx.clearRect(0,0,canvas.width, canvas.height);\r\n\r\n\t\t   ctx.drawImage(img, 0,0, img.width, img.height,centerShift_x,centerShift_y,img.width*ratio, img.height*ratio);\r\n\r\n\r\n\r\n\t\t   document.querySelector('#image-editor-modal canvas').style.display = 'block';\r\n\r\n\t}\r\n\r\n\r\n\r\n\t// reset editor\r\n\r\n\tthis.reset = function(){\r\n\r\n\r\n\r\n\t\tif( document.querySelector('#clone-img') != null ){\r\n\r\n\t\t\tdocument.querySelector('#clone-img').remove();\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tif( document.querySelector('#image-editor-modal #crop-box') != null ){\r\n\r\n\t\t\tdocument.querySelector('#image-editor-modal #crop-box').remove();\r\n\r\n\t\t}\r\n\r\n\r\n\r\n\t\tdocument.querySelectorAll('.filter-range-input').forEach(function($el){\r\n\r\n\t\t\t$el.value = 0;\r\n\r\n\t\t});\r\n\r\n\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop-now').closest('li').style.display = 'none';\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-crop').closest('li').style.display = 'block';\r\n\r\n\t\t$global.displayImageModal(document.querySelector('.image-editor.active input.file-browse'),false);\r\n\r\n\r\n\t}\r\n\r\n\t// -- end reset editor\r\n\r\n\r\n\r\n\t// resize\r\n\r\n\tthis.applyResize = function($w,$h){\r\n\r\n\t\tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t\t  this.resize({\r\n\r\n\t\t    width: $w,\r\n\r\n\t\t    height: $h\r\n\r\n\t\t  });\r\n\r\n\r\n\r\n\t\t  this.render();\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t// -- end resize\r\n\r\n\r\n\r\n\t// filters\r\n\r\n\tthis.applyFilter = function($t,$v) {\r\n\r\n\t\tlet $type = $t.replace('filter-','');\r\n\r\n\t\tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t\t\tthis.revert(false);\r\n\r\n\t\t\tswitch($type){\r\n\r\n\t\t\t\tcase 'brightness':\r\n\r\n\t\t\t\t\tthis.brightness($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'contrast':\r\n\r\n\t\t\t\t\tthis.contrast($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'contrast':\r\n\r\n\t\t\t\t\tthis.saturation($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'vibrance':\r\n\r\n\t\t\t\t\tthis.contrast($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'exposure':\r\n\r\n\t\t\t\t\tthis.exposure($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'clip':\r\n\r\n\t\t\t\t\tthis.clip($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'clip':\r\n\r\n\t\t\t\t\tthis.clip($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hue':\r\n\r\n\t\t\t\t\tthis.hue($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sepia':\r\n\r\n\t\t\t\t\tthis.sepia($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'noise':\r\n\r\n\t\t\t\t\tthis.noise($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sharpen':\r\n\r\n\t\t\t\t\tthis.vintage($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'stackBlur':\r\n\r\n\t\t\t\t\tthis.stackBlur($v).render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n    }\r\n\r\n    // -- end filters\r\n\r\n    // presets\r\n\r\n    this.applyPreset = function($t) {\t\r\n\r\n\t\tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t\t\tthis.revert(false);\r\n\r\n\t\t\tswitch($t){\r\n\r\n\t\t\t\tcase 'vintage':\r\n\r\n\t\t\t\t\tthis.vintage().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'lomo':\r\n\r\n\t\t\t\t\tthis.lomo().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'clarity':\r\n\r\n\t\t\t\t\tthis.clarity().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sinCity':\r\n\r\n\t\t\t\t\tthis.sinCity().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'sunrise':\r\n\r\n\t\t\t\t\tthis.sunrise().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'crossProcess':\r\n\r\n\t\t\t\t\tthis.crossProcess().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'orangePeel':\r\n\r\n\t\t\t\t\tthis.orangePeel().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'love':\r\n\r\n\t\t\t\t\tthis.love().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'grungy':\r\n\r\n\t\t\t\t\tthis.grungy().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'jarques':\r\n\r\n\t\t\t\t\tthis.jarques().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'pinhole':\r\n\r\n\t\t\t\t\tthis.pinhole().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'oldBoot':\r\n\r\n\t\t\t\t\tthis.oldBoot().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'glowingSun':\r\n\r\n\t\t\t\t\tthis.glowingSun().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hazyDays':\r\n\r\n\t\t\t\t\tthis.hazyDays().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'herMajesty':\r\n\r\n\t\t\t\t\tthis.herMajesty().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'nostalgia':\r\n\r\n\t\t\t\t\tthis.nostalgia().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hemingway':\r\n\r\n\t\t\t\t\tthis.hemingway().render();\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'hemingway':\r\n\r\n\t\t\t\t\tthis.hemingway().render();\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n    }\r\n\r\n\r\n\r\n    // rotate func\r\n\r\n    this.applyRotate = function($t) {\r\n\r\n    \tCaman(\"#image-editor-modal canvas\", function () {\r\n\r\n\t    \tswitch($t){\r\n\r\n\t    \t\tcase 'cw':\r\n\r\n\t    \t\t\tthis.rotate(90).render();\r\n\r\n\t    \t\tbreak;\r\n\r\n\t    \t\tcase 'ccw':\r\n\r\n\t    \t\t\tthis.rotate(-90).render();\r\n\r\n\t    \t\tbreak;\r\n\r\n\t    \t}\r\n\r\n\t    \tdocument.querySelectorAll('.toolbox-sub').forEach(function(el){\r\n\t\t\t\tel.style.display = 'none';\r\n\t\t\t});\r\n\r\n\t    \t$global.redisplayImageModal(this.toBase64());\r\n\r\n\t    });\r\n\r\n\r\n    }\r\n\r\n    // -- end rotate func\r\n\r\n    // re render modal image\r\n    this.redisplayImageModal = function(t){\r\n    \tif( document.querySelector('#image-editor-modal #image-editor-canvas canvas') != null ){\r\n\t\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas canvas').remove();\r\n\t\t}\r\n\t\t// append a default canvas\r\n\r\n\t\tlet $canvas = document.createElement('canvas');\r\n\r\n\t\t$canvas.setAttribute('id','modal-canvas');\r\n\r\n\t\tdocument.querySelector('#image-editor-modal #image-editor-canvas #canvas-holder').appendChild($canvas);\r\n\r\n\t\t// -- end append default canvas\r\n\r\n\t\t$global.cloneImg(t,true);\r\n\r\n\r\n\t\tlet $ctx = document.querySelector('#image-editor-modal #image-editor-canvas canvas').getContext('2d');\r\n\r\n\t\tlet $img = new Image;\r\n\r\n\t\t$img.crossOrigin = 'anonymous';\r\n\r\n\t\t$img.onload = $global.drawImageScaled.bind(null, $img, $ctx);\r\n\t\t$img.src = t;\r\n    }\r\n\r\n\r\n\t// -- check if element is hidden, return true otherwise\r\n\r\n\tthis.isHidden = function(el) {\r\n\r\n\r\n\t    let style = window.getComputedStyle(el);\r\n\r\n\t    return ((style.display === 'none') || (style.visibility === 'hidden'));\r\n\r\n\t}\r\n\r\n\r\n\r\n\treturn this.init($options);\r\n}\r\n\r\n"]}